---
title: "학생맞춤통합지원 체계 운영실태 조사 분석보고서"
author: "학생맞춤지원담당관"
date: "`r format(Sys.Date(), '%Y년 %m월 %d일')`" 
format: 
  html:
    theme: flatly               # bookdown과 비슷한 테마
    toc: true
    toc-location: left          # 왼쪽 사이드바
    toc-title: "목차"
    toc-depth: 3
    number-sections: true
    number-depth: 3
    code-fold: true
    code-summary: "코드 보기"
    smooth-scroll: true         # 부드러운 스크롤
    css: |
      .quarto-title-block {
        text-align: center;
        margin-bottom: 2em;
      }
      .sidebar-navigation {
        background-color: #f8f9fa;
      }
editor: visual
---

## 

# 실태조사 개요

## 목적: 학생맞춤통합지원 체계안착을 위한 운영실태 조사

## 조사대상자: 초ㆍ중ㆍ고 학교장, 교감, 교사

## 응답자: 초ㆍ중ㆍ고 학교장, 교감, 교사

## 조사방법: 교육연구정보원 통계분석(유레카) 활용

```{r}
#| echo: false
#| warning: false
#| message: false
library(readxl)
library(scales)
library(RColorBrewer)
library(rmarkdown)
library(dplyr)
library(tidyverse)
library(gridExtra)
library(knitr)        # 기술통계표 보기 좋게 출력
library(kableExtra)   # 테이블 꾸미기 (선택사항)
library(readxl)
library(forcats)  
library(showtext)

font_add_google("Noto Sans KR", "noto")  # 구글 폰트 사용
showtext_auto()  # ggplot, plot에 자동 

raw_data <- read_excel("dat.xlsx")
dat <-raw_data 
dat <- dat %>% mutate(across(starts_with("ques_"), as.character))

```

# 실태조사 문항별 응답결과

## 문항1. 귀하의 소속 학교급은 무엇입니까?

```{r}
#| echo: false
#| warning: false
#| message: false
dat_q1 <- dat %>%
  mutate(ques_1 = as.character(ques_1))

# 2. 응답 항목 라벨 정의
ques1_labels <- c(
  "1" = "초등학교",
  "2" = "중학교",
  "3" = "고등학교",
  "4" = "특수학교",
  "5" = "각종학교"
)

ques1_freq <- dat_q1 %>%
  filter(!is.na(ques_1), ques_1 != "해당없음") %>%
  mutate(응답기관 = recode(ques_1, !!!ques1_labels)) %>%
  group_by(응답기관) %>%
  summarise(n = n(), .groups = "drop") %>%
  mutate(
    pct_raw = n / sum(n) * 100,
    pct = round(pct_raw, 2),
    pct_label = sprintf("%.2f", pct),  # ✅ 소숫점 2자리 고정
    label = paste0(응답기관, " ", n, "명 (", pct, "%)")
  ) %>%
  arrange(desc(n)) %>%
  mutate(label = fct_inorder(label))  # 순서를 유지한 범주형

# 4. 기술통계 출력
ques1_freq %>%
  transmute(응답기관, n, pct_label) %>%
  bind_rows(
    tibble(
      응답기관 = "합계",
      n = sum(ques1_freq$n),
      pct_label = sprintf("%.2f", sum(ques1_freq$pct)) # 백분율 합계
    )
  ) %>%
  print(n = Inf)
```

#### 설문응답자는 총 3,178명으로 초등학교 소속이 1,282명(40.34%), 중학교 소속이 1,109명(34.9%), 고등학교 소속이 718명(22.59%), 특수학교 소속이 46명(1.45%), 각종학교 소속은 23명(0.72%)이 설문에 응답하였음

```{r}
#| echo: false
#| warning: false
#| message: false
ggplot(ques1_freq, aes(x = fct_reorder(응답기관, -n), y = n, fill = 응답기관)) +
  geom_bar(stat = "identity", width = 0.7) +
  geom_text(aes(label = paste0(n, "명\n(", pct, "%)")),
            vjust = -0.5, size = 4) +
  labs(
    title = "문항 1. 응답자 소속기관",
    x = "응답자 소속기관",
    y = "응답자 수",
    fill = "응답기관"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold", size = 20, hjust = 0.5),
    axis.title.y = element_text(angle = 0, vjust = 0.5, hjust = 1),
    legend.position = "right"
  ) +
  ylim(0, max(ques1_freq$n) * 1.2)
```

```{r}
```


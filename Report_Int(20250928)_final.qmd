---
title: ""
title-block: false
author: "í•™ìƒë§ì¶¤ì§€ì›ë‹´ë‹¹ê´€ ì§€ì—­í˜‘ë ¥ë³µì§€íŒ€(a.k.a. Donny)"
format: 
  html:
    theme: flatly               # bookdownê³¼ ë¹„ìŠ·í•œ í…Œë§ˆ
    toc: true
    toc-location: left          # ì™¼ìª½ ì‚¬ì´ë“œë°”
    toc-title: "ëª©ì°¨"
    toc-depth: 3
    number-sections: false
    number-depth: 3
    code-fold: true
    code-summary: "ì½”ë“œ ë³´ê¸°"
    smooth-scroll: true
    css: styles.css
editor: visual
---

# 1. ì‹¤íƒœì¡°ì‚¬ ê°œìš”

-   ëª©ì : í•™ìƒë§ì¶¤í†µí•©ì§€ì› ì²´ê³„ì•ˆì°©ì„ ìœ„í•œ ìš´ì˜ì‹¤íƒœ ì¡°ì‚¬ë¥¼ í†µí•´ ì •ì±… ì¸ì‹ë„, ìš´ì˜í˜„í™©, êµìœ¡êµ¬ì„±ì› ê°„ í˜‘ë ¥ì˜ ì¤‘ìš”ì„±ê³¼ í•„ìš”ì„± ì¸ì‹ ë° í˜‘ë ¥ì‹¤íƒœë¥¼ íŒŒì•…í•¨ìœ¼ë¡œì¨ í–¥í›„ ì²´ê³„ì•ˆì°©ì„ ìœ„í•œ ê°œì„ ë°©ì•ˆ ë§ˆë ¨

-   ì¡°ì‚¬ëŒ€ìƒì: ì´ˆã†ì¤‘ã†ê³  í•™êµì¥, êµê°, êµì‚¬ ë“± ì´ 3,178ëª…ì´ ì‹¤íƒœì¡°ì‚¬ì— ì°¸ì—¬í•˜ì˜€ìŒ (ë¬¸í•­ì— ë”°ë¼ì„œ ì‘ë‹µ ëŒ€ìƒììˆ˜ê°€ ìƒì´í•¨)

-   ì¡°ì‚¬ë°©ë²•: êµìœ¡ì—°êµ¬ì •ë³´ì› í†µê³„ë¶„ì„(ìœ ë ˆì¹´) ì‹œìŠ¤í…œì„ í™œìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ì§‘ê³„í•˜ì˜€ìœ¼ë©°, R Stutioë¡œ ë°ì´í„° ë¶„ì„ì„ ì‹¤ì‹œ

```{r}
#| label: setup
#| echo: false
#| warning: false
#| message: false

library(rmarkdown)
library(knitr)
library(tibble)
library(dplyr)
library(ggplot2)
library(readxl)
library(janitor)
library(stringr)
library(scales)
library(RColorBrewer)
library(tidyr)
library(tidytext)
library(cluster)
library(factoextra)
library(gridExtra)    
library(kableExtra)   
library(DT)
library(gt)
library(showtext)
library(forcats)  
library(purrr)


font_add_google("Noto Sans KR", "noto")  # êµ¬ê¸€ í°íŠ¸ 
showtext_auto()  # ggplot, plotì— ìë™ 

raw_data <- read_excel("raw_data.xlsx")
dat <-raw_data 
dat <- dat %>% mutate(across(starts_with("ques_"), as.character))
```

# 2. ì‹¤íƒœì¡°ì‚¬ (ì¼ë°˜í˜„í™©)

-   ì°¸ê³ ì‚¬í•­: ê¸°ìˆ í†µê³„ í˜„í™©ì—ì„œ â€˜nâ€™ì€ ì‘ë‹µììˆ˜ë¥¼ ì˜ë¯¸í•˜ë©°, pctëŠ” í¼ì„¼íŠ¸ë¥¼ ì˜ë¯¸í•¨

### ë¬¸í•­1. ê·€í•˜ì˜ ì†Œì† í•™êµê¸‰ì€ ë¬´ì—‡ì…ë‹ˆê¹Œ?

â‘  ì´ˆë“±í•™êµ â‘¡ ì¤‘í•™êµ â‘¢ ê³ ë“±í•™êµ â‘£ íŠ¹ìˆ˜í•™êµ â‘¤ ê°ì¢…í•™êµ

ì„¤ë¬¸ì‘ë‹µìëŠ” ì´ 3,178ëª…ìœ¼ë¡œ ì´ˆë“±í•™êµ ì†Œì†ì´ 1,282ëª…(40.34%), ì¤‘í•™êµ ì†Œì†ì´ 1,109ëª…(34.9%), ê³ ë“±í•™êµ ì†Œì†ì´ 718ëª…(22.59%), íŠ¹ìˆ˜í•™êµ ì†Œì†ì´ 46ëª…(1.45%), ê°ì¢…í•™êµ ì†Œì†ì€ 23ëª…(0.72%)ì´ ì„¤ë¬¸ì— ì‘ë‹µí•˜ì˜€ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
dat <- dat %>%
  filter(ques_1 %in% c(1,2,3,4,5),
         ques_2 %in% c(1,2,3),
         !is.na(ques_7),
         !is.na(ques_9)) %>%
  mutate(
    í•™êµê¸‰ = recode(ques_1,
                 `1` = "ì´ˆë“±í•™êµ",
                 `2` = "ì¤‘í•™êµ",
                 `3` = "ê³ ë“±í•™êµ",
                 `4` = "íŠ¹ìˆ˜í•™êµ",
                 `5` = "ê°ì¢…í•™êµ") ,
    ì„¤ë¦½ = recode(ques_2,
                `1` = "ê³µë¦½",
                `2` = "ì‚¬ë¦½",
                `3` = "êµ­ë¦½")
    )

dat_q1 <- dat %>%
  mutate(ques_1 = as.character(ques_1))

# 2. ì‘ë‹µ í•­ëª© ë¼ë²¨ ì •ì˜
ques1_labels <- c(
  "1" = "ì´ˆë“±í•™êµ",
  "2" = "ì¤‘í•™êµ",
  "3" = "ê³ ë“±í•™êµ",
  "4" = "íŠ¹ìˆ˜í•™êµ",
  "5" = "ê°ì¢…í•™êµ"
)

ques1_freq <- dat_q1 %>%
  filter(!is.na(ques_1), ques_1 != "í•´ë‹¹ì—†ìŒ") %>%
  mutate(ì‘ë‹µê¸°ê´€ = recode(ques_1, !!!ques1_labels)) %>%
  group_by(ì‘ë‹µê¸°ê´€) %>%
  summarise(ì‘ë‹µììˆ˜ = n(), .groups = "drop") %>%
  mutate(
    pct_raw = ì‘ë‹µììˆ˜ / sum(ì‘ë‹µììˆ˜) * 100,
    pct = round(pct_raw, 2),
    ë¹„ìœ¨ = sprintf("%.2f", pct),  # âœ… ì†Œìˆ«ì  2ìë¦¬ ê³ ì •
    label = paste0(ì‘ë‹µê¸°ê´€, " ", ì‘ë‹µììˆ˜, "ëª… (", pct, "%)")
  ) %>%
  arrange(desc(ì‘ë‹µììˆ˜)) %>%
  mutate(label = fct_inorder(label))  # ìˆœì„œë¥¼ ìœ ì§€í•œ ë²”ì£¼í˜•

# 4. ê¸°ìˆ í†µê³„ ì¶œë ¥
ques1_freq %>%
  transmute(ì‘ë‹µê¸°ê´€, ì‘ë‹µììˆ˜, ë¹„ìœ¨) %>%
  bind_rows(
    tibble(
      ì‘ë‹µê¸°ê´€ = "í•©ê³„",
      ì‘ë‹µììˆ˜ = sum(ques1_freq$ì‘ë‹µììˆ˜),
      ë¹„ìœ¨ = sprintf("%.2f", sum(ques1_freq$pct)) # ë°±ë¶„ìœ¨ í•©ê³„
    )
  ) %>%
  print(n = Inf)
```

```{r}
#| echo: false
#| warning: false
#| message: false
ggplot(ques1_freq, aes(x = fct_reorder(ì‘ë‹µê¸°ê´€, -ì‘ë‹µììˆ˜), y = ì‘ë‹µììˆ˜, fill = ì‘ë‹µê¸°ê´€)) +
  geom_bar(stat = "identity", width = 0.7) +
  geom_text(aes(label = paste0(ì‘ë‹µììˆ˜, "ëª…\n(", pct, "%)")),
            vjust = -0.5, size = 7) +
  labs(
    title = "ì‘ë‹µì ì†Œì†ê¸°ê´€",
    x = "ì‘ë‹µì ì†Œì†ê¸°ê´€",
    y = "ì‘ë‹µìˆ˜",
    fill = "ì‘ë‹µê¸°ê´€"
  ) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(size = 32, face = "bold", hjust = 0.5),
    axis.text.x = element_text(size = 18, face = "bold", 
                               margin = margin(t = 15)),              # Xì¶• í•­ëª©ê³¼ ì œëª© ì‚¬ì´ ê°„ê²©
    axis.text.y = element_text(size = 18),                           # Yì¶• ìˆ«ì í¬ê²Œ (ë¹ˆ ê°’ â†’ 18)
    axis.title.x = element_text(size = 20, 
                                margin = margin(t = 20)),             # Xì¶• ì œëª©ê³¼ í•­ëª© ì‚¬ì´ ê°„ê²©
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5, hjust = 1,
                                margin = margin(r = 20)),             # Yì¶• ì œëª©ê³¼ ìˆ«ì ì‚¬ì´ ê°„ê²©
    legend.position = "none",
    plot.margin = margin(20, 20, 20, 40)                            # ì „ì²´ ì—¬ë°± (ìœ„, ì˜¤ë¥¸ìª½, ì•„ë˜, ì™¼ìª½)
  ) +
  ylim(0, max(ques1_freq$ì‘ë‹µììˆ˜) * 1.5)
```

### ë¬¸í•­2. ê·€í•˜ ì†Œì†ê¸°ê´€ì˜ ìœ í˜•ì€?

â‘  ê³µë¦½ â‘¡ ì‚¬ë¦½ â‘¢ êµ­ë¦½

ì„¤ë¬¸ì‘ë‹µì 3,178ëª… ì¤‘ì—ì„œ ê³µë¦½í•™êµ ì†Œì†ì€ 2,348ëª…(73.9%), ì‚¬ë¦½í•™êµ ì†Œì†ì€ 810ëª…(25.5%), êµ­ë¦½í•™êµ ì†Œì†ì€ 20ëª…(0.6%)ì´ ì‘ë‹µí•˜ì˜€ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false

ques2_freq <- dat %>%
  filter(!is.na(ques_2), ques_2 != "í•´ë‹¹ì—†ìŒ") %>%
  mutate(ì‘ë‹µê¸°ê´€ = recode(as.character(ques_2),
                       `1` = "ê³µë¦½",
                       `2` = "ì‚¬ë¦½",
                       `3` = "êµ­ë¦½")) %>%
  group_by(ì‘ë‹µê¸°ê´€) %>%
  summarise(ì‘ë‹µììˆ˜ = n(), .groups = "drop") %>%
  mutate(
    pct_raw = ì‘ë‹µììˆ˜ / sum(ì‘ë‹µììˆ˜) * 100,
    ë¹„ìœ¨ = round(pct_raw,1),
    label = paste0(ì‘ë‹µê¸°ê´€, " ", ì‘ë‹µììˆ˜, "ëª… (", ë¹„ìœ¨, "%)")
  ) %>%
  arrange(desc(ì‘ë‹µììˆ˜))  # ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬

# ê¸°ìˆ í†µê³„í‘œ ì¶œë ¥ (ì°¸ê³ ìš©)
ques2_freq %>%
  select(ì‘ë‹µê¸°ê´€, ì‘ë‹µììˆ˜, ë¹„ìœ¨) %>%
  bind_rows(
    tibble(
      ì‘ë‹µê¸°ê´€ = "í•©ê³„",
      ì‘ë‹µììˆ˜ = sum(ques2_freq$ì‘ë‹µììˆ˜),
      ë¹„ìœ¨ = sum(ques2_freq$ë¹„ìœ¨)  
    )
  ) %>%
  print(n = Inf)

```

```{r}
#| echo: false
#| message: false
#| warning: false
ggplot(ques2_freq, aes(x = reorder(ì‘ë‹µê¸°ê´€, -ì‘ë‹µììˆ˜), y = ì‘ë‹µììˆ˜, fill = ì‘ë‹µê¸°ê´€)) +  # fillì„ ì‘ë‹µê¸°ê´€ìœ¼ë¡œ ë³€ê²½
  geom_bar(stat = "identity", width = 0.6) +
  geom_text(aes(label = paste0(ì‘ë‹µììˆ˜, "ëª…\n(", ë¹„ìœ¨, "%)")),
            vjust = -0.5, size = 7) +                                 # size 4 â†’ 7
  labs(
    title = "ì‘ë‹µì ì†Œì†ê¸°ê´€ ìœ í˜•",
    x = "ì‘ë‹µê¸°ê´€",
    y = "ì‘ë‹µìˆ˜",
    fill = "ê¸°ê´€ë³„ ë¶„í¬"
  ) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(size = 32, face = "bold", hjust = 0.5),    # ì œëª© í¬ê²Œ
    axis.text.x = element_text(size = 18, face = "bold", 
                               margin = margin(t = 15)),                 # Xì¶• í•­ëª© í¬ê³  êµµê²Œ
    axis.text.y = element_text(size = 18),                              # Yì¶• ìˆ«ì í¬ê²Œ
    axis.title.x = element_text(size = 20, 
                                margin = margin(t = 20)),                # Xì¶• ì œëª© í¬ê²Œ
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5, hjust = 1,
                                margin = margin(r = 20)),                # Yì¶• ì œëª© ê°€ë¡œë¡œ
    legend.position = "none",
    plot.margin = margin(20, 20, 20, 40)                               # ì „ì²´ ì—¬ë°±
  ) +
  ylim(0, max(ques2_freq$ì‘ë‹µììˆ˜) * 1.5)
```

### ë¬¸í•­3. ê·€í•˜ ì†Œì†ê¸°ê´€ì˜ ì†Œì¬ ìì¹˜êµ¬ëŠ”?

â‘  ê°•ë‚¨êµ¬ â‘¡ ê°•ë™êµ¬ â‘¢ ê°•ë¶êµ¬ â‘£ ê°•ì„œêµ¬ â‘¤ ê´€ì•…êµ¬ â‘¥ ê´‘ì§„êµ¬ â‘¦ êµ¬ë¡œêµ¬ â‘§ ê¸ˆì²œêµ¬ â‘¨ ë…¸ì›êµ¬ â‘© ë„ë´‰êµ¬ â‘ª ë™ëŒ€ë¬¸êµ¬ â‘« ë™ì‘êµ¬ â‘¬ ë§ˆí¬êµ¬ â‘­ ì„œëŒ€ë¬¸êµ¬ â‘® ì„œì´ˆêµ¬ â‘¯ ì„±ë™êµ¬ â‘° ì„±ë¶êµ¬ â‘± ì†¡íŒŒêµ¬ â‘² ì–‘ì²œêµ¬ â‘³ ì˜ë“±í¬êµ¬ ã‰‘ ìš©ì‚°êµ¬ ã‰’ ì€í‰êµ¬ ã‰“ ì¢…ë¡œêµ¬ ã‰” ì¤‘êµ¬ ã‰• ì¤‘ë‘êµ¬

ì„¤ë¬¸ ì‘ë‹µì 3,178ëª… ì¤‘ì—ì„œ ì†Œì†ê¸°ê´€ ì†Œì¬ì§€ê°€ ë…¸ì›êµ¬ì¸ ì‘ë‹µìê°€ 236ëª…(7.426%)ìœ¼ë¡œ ê°€ì¥ ë§ì•˜ìœ¼ë©°, ë‹¤ìŒìœ¼ë¡œ ê°•ë‚¨êµ¬ê°€ ì†Œì¬ì§€ì¸ ì‘ë‹µìëŠ” 212ëª…(6.671%)ì´ë©° ì¤‘êµ¬ê°€ 73ëª…(2.297%ë¡œ)ìœ¼ë¡œ 25ê°œ ìì¹˜êµ¬ ì¤‘ì—ì„œ ì‘ë‹µì ìˆ˜ê°€ ê°€ì¥ ì ì—ˆìŒ

```{r}
#| echo: false
#| message: false
#| warning: false
# 1. ìì¹˜êµ¬ ë ˆì´ë¸” ì •ì˜
ques3_labels <- c(
  "1" = "ê°•ë‚¨êµ¬", "2" = "ê°•ë™êµ¬", "3" = "ê°•ë¶êµ¬", "4" = "ê°•ì„œêµ¬", "5" = "ê´€ì•…êµ¬",
  "6" = "ê´‘ì§„êµ¬", "7" = "êµ¬ë¡œêµ¬", "8" = "ê¸ˆì²œêµ¬", "9" = "ë…¸ì›êµ¬", "10" = "ë„ë´‰êµ¬",
  "11" = "ë™ëŒ€ë¬¸êµ¬", "12" = "ë™ì‘êµ¬", "13" = "ë§ˆí¬êµ¬", "14" = "ì„œëŒ€ë¬¸êµ¬", "15" = "ì„œì´ˆêµ¬",
  "16" = "ì„±ë™êµ¬", "17" = "ì„±ë¶êµ¬", "18" = "ì†¡íŒŒêµ¬", "19" = "ì–‘ì²œêµ¬", "20" = "ì˜ë“±í¬êµ¬",
  "21" = "ìš©ì‚°êµ¬", "22" = "ì€í‰êµ¬", "23" = "ì¢…ë¡œêµ¬", "24" = "ì¤‘êµ¬", "25" = "ì¤‘ë‘êµ¬"
)

# 2. ê¸°ìˆ í†µê³„ ìƒì„±
ques3_freq <- dat %>%
  filter(!is.na(ques_3), ques_3 %in% names(ques3_labels)) %>%
  group_by(ques_3) %>%
  summarise(n = n(), .groups = "drop") %>%
  mutate(
    label = ques3_labels[ques_3],
    pct_raw = n / sum(n) * 100,
    pct = round(pct_raw, 3),  # ì¼ë°˜ì ì¸ ë°˜ì˜¬ë¦¼
    label_full = paste0(label, " (", n, "ëª… / ", pct, "%)")
  )

# 3. ê¸°ìˆ í†µê³„ ìš”ì•½ ì¶œë ¥

ques3_freq <- ques3_freq %>%
  mutate(
    pct_str = sprintf("%.3f", pct)
  )

# ì¶œë ¥
print(
  ques3_freq %>%
    arrange(desc(n)) %>%
    select(label, n, pct_str) %>%
    bind_rows(
      tibble(
        label = "í•©ê³„",
        n = sum(ques3_freq$n),
        pct_str = sprintf("%.2f", sum(ques3_freq$pct)) # í•©ê³„ëŠ” 100.00%
      )
    ),
  n = Inf
)
```

```{r}
#| echo: false
#| message: false
#| warning: false
ggplot(ques3_freq, aes(x = n, y = reorder(label, n), fill = label)) +
  geom_bar(stat = "identity", width = 0.6) +
  geom_text(aes(label = paste0(n, "ëª… (", pct, "%)")), hjust = -0.1, size = 7) +  # size 3.8 â†’ 7
  labs(
    title = "ì‘ë‹µì ì†Œì†ê¸°ê´€ ì†Œì¬ì§€ í˜„í™©",
    x = "ì‘ë‹µìˆ˜",
    y = "ìì¹˜êµ¬",
    fill = "ìì¹˜êµ¬"
  ) +
  theme_minimal(base_size = 15) +  # base_size 13 â†’ 15
  theme(
    plot.title = element_text(size = 32, face = "bold", hjust = 0.5),  # size 16 â†’ 32
axis.text.x = element_text(size = 18, margin = margin(t = 10)),  # t = 10 ì¶”ê°€ (xì¶• í…ìŠ¤íŠ¸ì™€ ì œëª© ê°„ê²©)
axis.text.y = element_text(size = 18),
axis.title.x = element_text(size = 20, angle = 0, margin = margin(t = 15)),  # t = 15 ì¶”ê°€ (xì¶• ì œëª© ìœ„ìª½ ì—¬ë°±)
axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),  # size 20 ì¶”ê°€
    legend.position = "none"
  ) +
  xlim(0, max(ques3_freq$n) * 1.30)
```

### ë¬¸í•­4. ê·€í•˜ì˜ ì†Œì†ê¸°ê´€ì€ êµìœ¡ë¶€ í•™ìƒë§ì¶¤í†µí•©ì§€ì› ì„ ë„í•™êµì…ë‹ˆê¹Œ?

â‘  ê·¸ë ‡ë‹¤ â‘¡ ì•„ë‹ˆë‹¤

ì„¤ë¬¸ ì‘ë‹µì 3,178ëª… ì¤‘ì—ì„œ ì„ ë„í•™êµ ì†Œì†ì¸ ì‘ë‹µìëŠ” 212ëª…(6.7%), ì„ ë„í•™êµ ì†Œì†ì´ ì•„ë‹Œ ì‘ë‹µìëŠ” 2,966ëª…(93.3%)ì´ ì„¤ë¬¸ì— ì‘ë‹µí•˜ì˜€ìŒ

```{r}
#| echo: false
#| message: false
#| warning: false
# 1. ë¼ë²¨ ì •ì˜
ques4_labels <- c(
  "1" = "ê·¸ë ‡ë‹¤",
  "2" = "ì•„ë‹ˆë‹¤"
)

# 2. ê¸°ìˆ í†µê³„ ìƒì„±
ques4_freq <- dat %>%
  filter(!is.na(ques_4), ques_4 %in% names(ques4_labels)) %>%
  group_by(ques_4) %>%
  summarise(n = n(), .groups = "drop") %>%
  mutate(
    ì‘ë‹µ = ques4_labels[ques_4],
    pct_raw = n / sum(n) * 100,
    pct = round(pct_raw, 1),
    label = paste0(ì‘ë‹µ, " ", n, "ëª… (", pct, "%)")
  ) %>%
  arrange(desc(n))  # ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬

# 3. ê¸°ìˆ í†µê³„ ì¶œë ¥
ques4_freq %>%
  select(ì‘ë‹µ, n, pct) %>%
  bind_rows(
    tibble(
      ì‘ë‹µ = "í•©ê³„",
      n = sum(ques4_freq$n),
      pct = sum(ques4_freq$pct)  # âœ… í•©ê³„ëŠ” 100% ì˜ˆìƒ
    )
  ) %>%
  print(n = Inf)
```

```{r}
#| echo: false
#| message: false
#| warning: false
ggplot(ques4_freq, aes(x = reorder(ì‘ë‹µ, -n), y = n, fill = ì‘ë‹µ)) +  # fillì„ ì‘ë‹µìœ¼ë¡œ ë³€ê²½
  geom_bar(stat = "identity", width = 0.6) +
  geom_text(aes(label = paste0(n, "ëª…\n(", pct, "%)")), 
            vjust = -0.3,           # ë§‰ëŒ€ ìœ„ë¡œ ë” ë„ìš°ê¸°
            size = 7,               # size 4.5 â†’ 7
            fontface = "bold") +    # ê¸€ì”¨ êµµê²Œ
  labs(
    title = "ì„ ë„í•™êµ ì—¬ë¶€",
    x = "ì‘ë‹µí•­ëª©",
    y = "ì‘ë‹µìˆ˜",
    fill = "ì‘ë‹µ"
  ) +
  theme_minimal(base_size = 15) +  # base_size 13 â†’ 15
  theme(
    plot.title = element_text(size = 32, face = "bold", hjust = 0.5),  # size 16 â†’ 32
axis.text.x = element_text(size = 18, margin = margin(t = 10)),  # t = 10 ì¶”ê°€ (xì¶• í…ìŠ¤íŠ¸ì™€ ì œëª© ê°„ê²©)
axis.text.y = element_text(size = 18),
axis.title.x = element_text(size = 20, angle = 0, margin = margin(t = 15)),  # t = 15 ì¶”ê°€ (xì¶• ì œëª© ìœ„ìª½ ì—¬ë°±)
axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),  # size 20 ì¶”ê°€
    legend.position = "none"     # ë²”ë¡€ ì™„ì „íˆ ì œê±°
  ) +
  ylim(0, max(ques4_freq$n) * 1.6)
```

### ë¬¸í•­5. ê·€í•˜ì˜ ì†Œì†ê¸°ê´€ì€ êµìœ¡ë³µì§€ì‚¬ì—…í•™êµ ê±°ì í•™êµ(ì§€ì—­ì‚¬íšŒêµìœ¡ì „ë¬¸ê°€ ë°°ì¹˜í•™êµ) ì…ë‹ˆê¹Œ?

â‘  ê·¸ë ‡ë‹¤ â‘¡ ì•„ë‹ˆë‹¤

ì„¤ë¬¸ ì‘ë‹µì 3,178ëª… ì¤‘ì—ì„œ ê±°ì í•™êµ ì†Œì† ì‘ë‹µìëŠ” 811ëª…(25.5%), ê±°ì í•™êµ ì†Œì†ì´ ì•„ë‹Œ ì‘ë‹µìëŠ” 2,367ëª…(74.5%)ê°€ ì„¤ë¬¸ì— ì‘ë‹µí•˜ì˜€ìŒ

```{r}
#| echo: false
#| message: false
#| warning: false
ques5_labels <- c(
  "1" = "ê·¸ë ‡ë‹¤",
  "2" = "ì•„ë‹ˆë‹¤"
)

# 2. ê¸°ìˆ í†µê³„ ìƒì„±
ques5_freq <- dat %>%
  filter(!is.na(ques_5), ques_5 %in% names(ques5_labels)) %>%
  group_by(ques_5) %>%
  summarise(n = n(), .groups = "drop") %>%
  mutate(
    ì‘ë‹µ = ques5_labels[ques_5],
    pct_raw = n / sum(n) * 100,
    pct = round(pct_raw, 1),
    label = paste0(ì‘ë‹µ, " ", n, "ëª… (", pct, "%)")
  ) %>%
  arrange(desc(n))  # ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬

# 3. ê¸°ìˆ í†µê³„ ì¶œë ¥
ques5_freq %>%
  select(ì‘ë‹µ, n, pct) %>%
  bind_rows(
    tibble(
      ì‘ë‹µ = "í•©ê³„",
      n = sum(ques5_freq$n),
      pct = sum(ques5_freq$pct)  # âœ… í•©ê³„ëŠ” 100% ì˜ˆìƒ
    )
  ) %>%
  print(n = Inf)

```

```{r}
#| echo: false
#| message: false
#| warning: false
ggplot(ques5_freq, aes(x = reorder(ì‘ë‹µ, -n), y = n, fill = ì‘ë‹µ)) +
 geom_bar(stat = "identity", width = 0.6) +
 # âœ… ë§‰ëŒ€ ìœ„ ëª…ìˆ˜+í¼ì„¼íŠ¸ í‘œì‹œ
 geom_text(aes(label = paste0(n, "ëª…\n(", pct, "%)")), 
           vjust = -0.3, size = 7) +  # size 4 â†’ 7
 labs(
   title = "êµìœ¡ë³µì§€ ê±°ì í•™êµ ì—¬ë¶€",
   x = "ì‘ë‹µí•­ëª©",
   y = "ì‘ë‹µìˆ˜",
   fill = "ì‘ë‹µ"
 ) +
 ylim(0, max(ques5_freq$n) * 1.2) +        # âœ… ë§‰ëŒ€ ìœ„ 20% ì—¬ìœ  ê³µê°„
 theme_minimal(base_size = 15) +  # base_size 13 â†’ 15
 theme(
   plot.title = element_text(size = 32, face = "bold", hjust = 0.5),  # size 16 â†’ 32
axis.text.x = element_text(size = 18, margin = margin(t = 10)),  # t = 10 ì¶”ê°€ (xì¶• í…ìŠ¤íŠ¸ì™€ ì œëª© ê°„ê²©)
axis.text.y = element_text(size = 18),
axis.title.x = element_text(size = 20, angle = 0, margin = margin(t = 15)),  # t = 15 ì¶”ê°€ (xì¶• ì œëª© ìœ„ìª½ ì—¬ë°±)
axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),  # size 20 ì¶”ê°€
   legend.position = "none"
 )
```

### ë¬¸í•­6. ê·€í•˜ì˜ ì†Œì†ê¸°ê´€ì€ â€˜ì§€ì—­ì—°ê³„ì¤‘ì í•™êµâ€™ì…ë‹ˆê¹Œ?

â‘  ê·¸ë ‡ë‹¤ â‘¡ ì•„ë‹ˆë‹¤

ì„¤ë¬¸ ì‘ë‹µì 3,178ëª… ì¤‘ì—ì„œ 1ìœ í˜• ì¤‘ì í•™êµ ì†Œì† ì‘ë‹µìëŠ” 194ëª…(6.1%), 2ìœ í˜• ì¤‘ì í•™êµ ì†Œì† ì‘ë‹µìëŠ” 221ëª…(7%), ì¤‘ì í•™êµ ì†Œì†ì´ ì•„ë‹Œ ì‘ë‹µìëŠ” 2,763ëª…(86.9%)ì´ ì„¤ë¬¸ì— ì‘ë‹µí•˜ì˜€ìŒ

```{r}
#| echo: false
#| message: false
#| warning: false
# 1. ë¼ë²¨ ì •ì˜
ques6_labels <- c(
  "1" = "1ìœ í˜• ì¤‘ì í•™êµ",
  "2" = "2ìœ í˜• ì¤‘ì í•™êµ",
  "3" = "ì•„ë‹ˆë‹¤"
)

# 2. ê¸°ìˆ í†µê³„ ìƒì„±
ques6_freq <- dat %>%
  filter(!is.na(ques_6), ques_6 %in% names(ques6_labels)) %>%
  group_by(ques_6) %>%
  summarise(n = n(), .groups = "drop") %>%
  mutate(
    ì‘ë‹µ = ques6_labels[ques_6],
    pct_raw = n / sum(n) * 100,
    pct = round(pct_raw, 1),
    pct_label = sprintf("%.1f", pct),    # âœ… ì†Œìˆ«ì  1ìë¦¬ ê³ ì •
    label = paste0(ì‘ë‹µ, " ", n, "ëª… (", sprintf("%.1f", pct), "%)")
  ) %>%
  arrange(desc(n))

# 3. ê¸°ìˆ í†µê³„ ì¶œë ¥
ques6_freq %>%
  transmute(ì‘ë‹µ, n, pct_label) %>%
  bind_rows(
    tibble(
      ì‘ë‹µ = "í•©ê³„",
      n = sum(ques6_freq$n),
      pct_label = sprintf("%.1f", sum(ques6_freq$pct))
    )
  ) %>%
  print(n = Inf)
```

```{r}
#| echo: false
#| message: false
#| warning: false
ggplot(ques6_freq, aes(x = reorder(ì‘ë‹µ, -n), y = n, fill = ì‘ë‹µ)) +
 geom_bar(stat = "identity", width = 0.6) +
 geom_text(aes(label = paste0(n, "ëª…\n(", pct, "%)")), 
           vjust = -0.5, size = 7) +  # size 4 â†’ 7
 labs(
   title = "ì§€ì—­ì—°ê³„ì¤‘ì í•™êµ ì—¬ë¶€",
   x = "ì‘ë‹µí•­ëª©",
   y = "ì‘ë‹µìˆ˜",
   fill = "ì‘ë‹µ"
 ) +
 ylim(0, max(ques6_freq$n) * 1.4) +  # ì´ ì¤„ ì¶”ê°€
 theme_minimal(base_size = 15) +  # base_size 13 â†’ 15
 theme(
   plot.title = element_text(size = 32, face = "bold", hjust = 0.5),  # size 16 â†’ 32
axis.text.x = element_text(size = 18, margin = margin(t = 10)),  # t = 10 ì¶”ê°€ (xì¶• í…ìŠ¤íŠ¸ì™€ ì œëª© ê°„ê²©)
axis.text.y = element_text(size = 18),
axis.title.x = element_text(size = 20, angle = 0, margin = margin(t = 15)),  # t = 15 ì¶”ê°€ (xì¶• ì œëª© ìœ„ìª½ ì—¬ë°±)
axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),  # size 20 ì¶”ê°€
   legend.position = "none"
 )
```

### ë¬¸í•­7. ê·€í•˜ì˜ ì§ìœ„(ì§ê¸‰)ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”.

â‘  êµì¥ â‘¡ êµê° â‘¢ êµì‚¬ â‘£ ìƒë‹´êµì‚¬ â‘¤ ë³´ê±´êµì‚¬ â‘¥ ì˜ì–‘êµì‚¬ â‘¦ í–‰ì •ì‹¤ì¥ â‘§ ì§€ì—­ì‚¬íšŒêµìœ¡ì „ë¬¸ê°€ â‘¨ ìƒë‹´ì‚¬ â‘© ì¼ë°˜ êµì§ì›

ì„¤ë¬¸ ì‘ë‹µì 3,178ëª… ì¤‘ì—ì„œ êµì‚¬ëŠ” 1,469ëª…(46.2%), êµê°ì€ 780ëª…(24.5%), í•™êµì¥ì€ 487ëª…(15.3%), ìƒë‹´êµì‚¬ëŠ” 156ëª…(4.9%), ì§€ì—­ì‚¬íšŒêµìœ¡ì „ë¬¸ê°€ëŠ” 125ëª…(3.9%), ì¼ë°˜ êµì§ì›ì€ 65ëª…(2.0%), ìƒë‹´ì‚¬ëŠ” 51ëª…(1.6%), ë³´ê±´êµì‚¬ëŠ” 41ëª…(1.3%), ì˜ì–‘êµì‚¬ëŠ” 2ëª…(0.1%), í–‰ì •ì‹¤ì¥ì€ 2ëª…(0.1%)ì´ ì„¤ë¬¸ì— ì‘ë‹µí•˜ì˜€ìŒ

```{r}
#| echo: false
#| message: false
#| warning: false
ques7_labels <- c(
  "1" = "í•™êµì¥",
  "2" = "êµê°",
  "3" = "êµì‚¬",
  "4" = "ìƒë‹´êµì‚¬",
  "5" = "ë³´ê±´êµì‚¬",
  "6" = "ì˜ì–‘êµì‚¬",
  "7" = "í–‰ì •ì‹¤ì¥",
  "8" = "ì§€ì—­ì‚¬íšŒêµìœ¡ì „ë¬¸ê°€",
  "9" = "ìƒë‹´ì‚¬",
  "10" = "ì¼ë°˜ êµì§ì›")

# 2. ê¸°ìˆ í†µê³„ ìƒì„±
ques7_freq <- dat %>%
  filter(!is.na(ques_7), ques_7 %in% names(ques7_labels)) %>%
  group_by(ques_7) %>%
  summarise(n = n(), .groups = "drop") %>%
  mutate(
    ì‘ë‹µ = ques7_labels[ques_7],
    pct_raw = n / sum(n) * 100,
    pct = round(pct_raw, 2),
    pct_label = sprintf("%.1f", pct),           # âœ… ì¶”ê°€
    label = paste0(ì‘ë‹µ, " ", n, "ëª… (", pct_label, "%)")
  ) %>%
  arrange(desc(n)) # ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬

# 3. ê¸°ìˆ í†µê³„ ì¶œë ¥
ques7_freq %>%
  transmute(ì‘ë‹µ, n, pct_label) %>%
  bind_rows(
    tibble(
      ì‘ë‹µ = "í•©ê³„",
      n = sum(ques7_freq$n),
      pct_label = sprintf("%.1f", sum(ques7_freq$pct))
    )
  ) %>%
  print(n = Inf)
```

```{r}
#| echo: false
#| message: false
#| warning: false
ggplot(ques7_freq, aes(x = n, y = reorder(ì‘ë‹µ, n), fill = ì‘ë‹µ)) +
  geom_bar(stat = "identity", width = 0.6) +
  geom_text(aes(label = paste0(n, "ëª… (", pct_label, "%)")), hjust = -0.1, size = 7) +
  labs(
    title = "ì‘ë‹µì ì§ìœ„(ì§ê¸‰) í˜„í™©",
    x = "ì‘ë‹µìˆ˜",
    y = "ì§ìœ„(ì§ê¸‰)",
    fill = "ì§ìœ„(ì§ê¸‰)"
  ) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(size = 32, face = "bold", hjust = 0.5),
    axis.text.x = element_text(size = 18, margin = margin(t = 10)),
    axis.text.y = element_text(size = 18),
    axis.title.x = element_text(size = 20, angle = 0, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),
    legend.position = "none"
  ) +
  xlim(0, max(ques7_freq$n) * 1.30)
```

### ë¬¸í•­8. ê·€í•˜ê°€ ë³´ì§êµì‚¬ì¼ ê²½ìš° ë³´ì§ì˜ ëª…ì¹­ì„ ì ì–´ì£¼ì„¸ìš”. (ì˜ˆ: ìˆ˜ì—…ì—°êµ¬ë¶€ì¥ ë“±)

ì„¤ë¬¸ ì‘ë‹µì 1,105ëª… ì¤‘ì—ì„œ êµìœ¡ë³µì§€ë¶€ì¥ì€ 345ëª…(31.2%), êµë¬´ë¶€ì¥ì€ 188ëª…(17%), ìƒí™œë¶€ì¥ì€ 161ëª…(14.6%), í•™ë…„ë¶€ì¥ì€ 86ëª…(7.8%), ì—°êµ¬ë¶€ì¥ì€ 77ëª…(7%), ìƒë‹´ë¶€ì¥ì€ 64ëª…(5.8%), ì§„ë¡œêµìœ¡ë¶€ì¥ì€ 38ëª…(3.4%), êµìœ¡ê³¼ì •ë¶€ì¥ì€ 26ëª…(2.4%), ê¸°ì´ˆí•™ë ¥ë¶€ì¥ì€ 17ëª…(1.5%)ì´ê³  ì´ì™¸ ê¸°íƒ€ ë³´ì§ì˜ ë¶€ì¥ì´ 103ëª…(9.3%)ì´ì—ˆìŒ

```{r}
#| echo: false
#| message: false
#| warning: false
# 1. NA ì œê±°í•œ ë°ì´í„°ë§Œ ì‚¬ìš©
dat_clean <- dat %>%
  filter(!is.na(ques_8))

# 2. ìƒìœ„ 10ê°œ í•­ëª© ì¶”ì¶œ
top9 <- dat_clean %>%
  filter(!is.na(ques_8)) %>%           # NA ì œê±°
  count(ques_8, sort = TRUE) %>%
  slice_head(n = 9) %>%
  pull(ques_8)

# 3. ëŒ€ë¶„ë¥˜ ì—´ ìƒì„± (ìƒìœ„ 9ê°œ ê·¸ëŒ€ë¡œ, ë‚˜ë¨¸ì§€ëŠ” ê¸°íƒ€)
dat_clean <- dat_clean %>%
  mutate(
    ì§ì±… = if_else(ques_8 %in% top9, ques_8, "ê¸°íƒ€")
  )

# 4. ê¸°ìˆ í†µê³„ ê³„ì‚°
ques8_summary <- dat_clean %>%
  filter(!is.na(ì§ì±…)) %>%
  count(ì§ì±…, sort = TRUE) %>%
  mutate(
    pct_raw = n / sum(n) * 100,
    pct = round(pct_raw, 1),
    label = paste0(n, "ëª… (", pct, "%)")
  )

ques8_summary %>%
  transmute(ì§ì±…, n, pct) %>%
  bind_rows(
    tibble(
      ì§ì±… = "í•©ê³„",
      n = sum(ques8_summary$n),
      pct = sum(ques8_summary$pct)
    )
  ) %>%
  print(n = Inf)
```

```{r}
#| echo: false
#| message: false
#| warning: false
# 1. ë§‰ëŒ€ê·¸ë˜í”„ (ìˆ˜í‰)
ggplot(ques8_summary, aes(x = reorder(ì§ì±…, n), y = n, fill = ì§ì±…)) +
  geom_bar(stat = "identity", width = 0.6) +
  geom_text(aes(label = label), hjust = -0.05, size = 7) +
  coord_flip() +  # ìˆ˜í‰ ë§‰ëŒ€
  labs(
    title = "ì‘ë‹µì ë³´ì§(ë¶€ì¥êµì‚¬)",
    x = "ì‘ë‹µì ì§ì±…",
    y = "ì‘ë‹µìˆ˜"
  ) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(size = 32, face = "bold", hjust = 0.5),
    legend.position = "none",
    axis.text.x = element_text(size = 18, margin = margin(t = 10)),
    axis.text.y = element_text(size = 18),
    axis.title.x = element_text(size = 20, angle = 0, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5)
  ) +  # ì—¬ê¸°ì— ) ì¶”ê°€
  scale_y_continuous(limits = c(0, max(ques8_summary$n) * 1.25))  # ylim ëŒ€ì‹  scale_y_continuous ì‚¬ìš©
```

# 3. ì‹¤íƒœì¡°ì‚¬ (í•™ìƒë§ì¶¤í†µí•©ì§€ì› ì •ì±…ì— ëŒ€í•œ ì¸ì‹ ì¡°ì‚¬)

### ë¬¸í•­9. í•™ìƒë§ì¶¤í†µí•©ì§€ì› ì •ì±…ì— ëŒ€í•´ ì–´ëŠì •ë„ ì•Œê³  ê³„ì‹­ë‹ˆê¹Œ?

â‘  ì˜ ì•Œê³  ìˆë‹¤ â‘¡ ì¡°ê¸ˆ ì•Œê³  ìˆë‹¤ â‘¢ ë³´í†µì´ë‹¤ â‘£ ì˜ ëª¨ë¥¸ë‹¤ â‘¤ ì „í˜€ ëª¨ë¥¸ë‹¤

í•™ìƒë§ì¶¤í†µí•©ì§€ì› ì •ì±… ì¸ì‹ë„ ë¬¸í•­ì— ì´ ì‘ë‹µìëŠ” 3,178ëª…ì´ë©°, í•™ìƒë§ì¶¤í†µí•©ì§€ì› ì •ì±…ì„ ì˜ ì•Œê³  ìˆë‹¤ëŠ” ë‹µë³€í•œ ì‘ë‹µìëŠ” 1,268ëª…(39.9%), ì¡°ê¸ˆ ì•Œê³  ìˆë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 1,351ëª…(42.5%), ë³´í†µì´ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 391ëª…(12.3%), ì˜ ëª¨ë¥¸ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µëŠ” 153ëª…(4.8%), ì „í˜€ ëª¨ë¥¸ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µëŠ” 15ëª…(0.5%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

```{r}
#| echo: false
#| message: false
#| warning: false
ques9_freq <- dat %>%
 filter(!is.na(ques_9), ques_9 %in% as.character(1:5)) %>%
 count(ques_9) %>%
 mutate(
   ì‘ë‹µ = recode(ques_9,
                "1" = "ì˜ ì•Œê³  ìˆë‹¤",
                "2" = "ì¡°ê¸ˆ ì•Œê³  ìˆë‹¤", 
                "3" = "ë³´í†µì´ë‹¤",
                "4" = "ì˜ ëª¨ë¥¸ë‹¤",
                "5" = "ì „í˜€ ëª¨ë¥¸ë‹¤"),
   pct = round(n / sum(n) * 100, 1)
 ) %>%
 arrange(desc(n)) %>%
 bind_rows(summarise(., ì‘ë‹µ = "í•©ê³„", n = sum(n), pct = sum(pct)))
print(ques9_freq %>% select(ì‘ë‹µ, n, pct), n = Inf)
```

```{r}
#| echo: false
#| message: false
#| warning: false
ggplot(ques9_freq %>% filter(ì‘ë‹µ != "í•©ê³„"), aes(x = reorder(ì‘ë‹µ, -n), y = n, fill = ì‘ë‹µ)) +
  geom_bar(stat = "identity", width = 0.5) +
  geom_text(aes(label = paste0(n, "ëª… (", pct, "%)")), 
            vjust = -0.5, size = 7) +
  labs(
    title = "í•™ìƒë§ì¶¤í†µí•©ì§€ì› ì •ì±…ì¸ì‹ë„",
    x = "ì •ì±…ì¸ì‹ë„",
    y = "ì‘ë‹µìˆ˜"
  ) +
  theme_minimal(base_size = 12) +
  theme(
  plot.title = element_text(face = "bold", size = 32, hjust = 0.5),  # size 16 â†’ 32
  strip.text = element_text(size = 20, face = "bold"),  # ê·¸ë£¹ë³„ ì œëª© í¬ê¸° ì¶”ê°€
  axis.text.x = element_text(size = 23, margin = margin(t = 10)),  # ì¶”ê°€
  axis.text.y = element_text(size = 25),  # ì¶”ê°€
  axis.title.x = element_text(size = 25, angle = 0, margin = margin(t = 15)),  # ì¶”ê°€
  axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),  # size 20 ì¶”ê°€
  legend.position = "none"
) +
  ylim(0, max(ques9_freq$n[ques9_freq$ì‘ë‹µ != "í•©ê³„"]) * 1.15)  # ylimì—ì„œë„ í•©ê³„ ì œì™¸ 
```

ë¶„ì„ê³¼ì •

1\) ì‘ë‹µì ìœ í˜• ë¶„ë¥˜: ì§ì±…ë³„(í•™êµì¥, êµê°, êµì‚¬ ë“±), í•™êµê¸‰ë³„(ì´ˆë“±í•™êµ, ì¤‘í•™êµ, ê³ ë“±í•™êµ), ì„¤ë¦½ë³„(ê³µë¦½, ì‚¬ë¦½)ìœ¼ë¡œ êµ¬ë¶„í•˜ì˜€ìŒ. ìœ í˜•ë³„ ë¹„êµë¥¼ ìœ„í•´ ì‘ë‹µì ìˆ˜ê°€ ì ì€ íŠ¹ìˆ˜í•™êµ, ê°ì¢…í•™êµ ë° ê³µë¦½í•™êµëŠ” ì¡°ì‚¬ëŒ€ìƒìì—ì„œ ì œì™¸í•˜ì˜€ìŒ. ì´ì™€ ê°™ì´ ì‘ë‹µì ìœ í˜•ì„ ë¶„ë¥˜í•˜ê³  ì‘ë‹µì ì§‘ë‹¨ ê°„ì˜ ë‹µë³€ ë¶„í¬ë¥¼ ë¹„êµí•˜ì˜€ìŒ.

2\) ì¸ì‹ë„ ì ìˆ˜ ì‚°ì¶œë°©ë²•: â€˜ì˜ ì•Œê³  ìˆë‹¤â€™ëŠ” 5ì ì„ ë¶€ì—¬í•˜ê³  â€˜ì¡°ê¸ˆ ì•Œê³  ìˆë‹¤â€™ëŠ” 4ì , â€˜ë³´í†µì´ë‹¤â€™ëŠ” 3ì , â€˜ì˜ ëª¨ë¥¸ë‹¤â€™ëŠ” 2ì , â€˜ì „í˜€ ëª¨ë¥¸ë‹¤â€™ëŠ” 1ì ì„ ë¶€ì—¬í•˜ì—¬ ì¸ì‹ë„ ì ìˆ˜ë¥¼ ì‚°ì¶œí•˜ì˜€ìŒ.

ì´ì™€ ê°™ì´ ì‚°ì¶œí•œ ì ìˆ˜ë¥¼ ì§ì±…ë³„(í•™êµì¥, êµê°, êµì‚¬ ë“±), í•™êµê¸‰ë³„(ì´ˆë“±í•™êµ, ì¤‘í•™êµ, ê³ ë“±í•™êµ), ì„¤ë¦½ë³„(ê³µë¦½, ì‚¬ë¦½)ìœ¼ë¡œ êµ¬ë¶„í•˜ì—¬ ì§‘ë‹¨ ê°„ í‰ê·  ì ìˆ˜ì°¨ì´ê°€ ìœ ì˜ë¯¸í•œì§€ ë¶„ì„í•˜ì˜€ìŒ

### ë¬¸í•­ 9-1. ì§ì±…ë³„ ì •ì±…ì¸ì‹ë„ ë¶„ì„

ì§ì±…ë³„ ì‘ë‹µìëŠ” ì´ 3,090ëª…ì´ë©° ì´ ì¤‘ì—ì„œ í•™êµì¥ì€ 474ëª…(15.34%), êµê°ì€ 761ëª…(24.63%), êµì‚¬ ë“±ì€ 1,855ëª…(60.03%)ì´ ì‘ë‹µí•˜ì˜€ìŒ.

í•™êµì¥ ì‘ë‹µ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 222ëª…(46.8%), ê·¸ë ‡ë‹¤ëŠ” 198ëª…(41.8%), ë³´í†µì´ë‹¤ëŠ” 51ëª…(10.8%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 3ëª…(0.6%)ì´ì—ˆìŒ.

êµê° ì‘ë‹µ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 295ëª…(38.8%), ê·¸ë ‡ë‹¤ëŠ” 359ëª…(47.2%), ë³´í†µì´ë‹¤ëŠ” 87ëª…(11.4%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 18ëª…(2.4%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 2ëª…(0.3%)ì´ì—ˆìŒ

êµì‚¬ ë“± ì‘ë‹µ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 698ëª…(37.63%), ê·¸ë ‡ë‹¤ëŠ” 783ëª…(42.21%), ë³´í†µì´ë‹¤ëŠ” 312ëª…(16.82%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 47ëª…(2.53%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 15ëª…(0.81%)ì´ì—ˆìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
dat_filtered <- dat %>%
  filter(ques_1 %in% c(1,2,3),
         ques_2 %in% c(1,2),
         !is.na(ques_7),
         !is.na(ques_9)) %>%
  mutate(
    í•™êµê¸‰ = factor(recode(ques_1,
                         `1` = "ì´ˆë“±í•™êµ",
                         `2` = "ì¤‘í•™êµ",
                         `3` = "ê³ ë“±í•™êµ"),
                   levels = c("ì´ˆë“±í•™êµ", "ì¤‘í•™êµ", "ê³ ë“±í•™êµ")),
    ì„¤ë¦½ = factor(recode(ques_2,
                       `1` = "ê³µë¦½",
                       `2` = "ì‚¬ë¦½"),
                 levels = c("ê³µë¦½", "ì‚¬ë¦½")),
    ì§ì±… = factor(case_when(
      ques_7 == 1 ~ "í•™êµì¥",
      ques_7 == 2 ~ "êµê°",
      ques_7 %in% 3:10 ~ "êµì‚¬ ë“±",
      TRUE ~ NA_character_
    ), levels = c("í•™êµì¥", "êµê°", "êµì‚¬ ë“±")),
    ì •ì±…ì¸ì‹ë„ = factor(as.character(ques_9),
                   levels = c("1","2","3","4","5"),
                   labels = c("ì˜ ì•Œê³  ìˆë‹¤","ì¡°ê¸ˆ ì•Œê³  ìˆë‹¤","ë³´í†µì´ë‹¤","ì˜ ëª¨ë¥¸ë‹¤","ì „í˜€ ëª¨ë¥¸ë‹¤")),
    ì •ì±…ì¸ì‹ë„ì ìˆ˜ = case_when(
      ques_9 == 1 ~ 5,   # ì˜ ì•Œê³  ìˆë‹¤
      ques_9 == 2 ~ 4,   # ì¡°ê¸ˆ ì•Œê³  ìˆë‹¤
      ques_9 == 3 ~ 3,   # ë³´í†µì´ë‹¤
      ques_9 == 4 ~ 2,   # ì˜ ëª¨ë¥¸ë‹¤
      ques_9 == 5 ~ 1,   # ì „í˜€ ëª¨ë¥¸ë‹¤
      TRUE ~ NA_real_
    )
  )
# 1. êµì°¨í‘œ ìƒì„±
summary_table <- dat_filtered %>%
  group_by(ì§ì±…, ì •ì±…ì¸ì‹ë„) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%  # ì§ì±…ë³„ ë¹„ìœ¨(%)
  ungroup()

# 2. ì§ì±…ë³„ í•©ê³„ í–‰ ì¶”ê°€
summary_with_total <- summary_table %>%
  group_by(ì§ì±…) %>%
  summarise(
    n = sum(n),
    pct = sum(pct),
    ì •ì±…ì¸ì‹ë„ = "í•©ê³„"
  ) %>%
  bind_rows(summary_table) %>%
  arrange(
    factor(ì§ì±…, levels = c("í•™êµì¥","êµê°","êµì‚¬ ë“±")),
    ì •ì±…ì¸ì‹ë„ == "í•©ê³„",  # í•©ê³„ê°€ ë§ˆì§€ë§‰ì—
    if_else(ì •ì±…ì¸ì‹ë„ != "í•©ê³„", -n, 0)  # í•©ê³„ê°€ ì•„ë‹Œ ê²½ìš°ë§Œ ë¹ˆë„ ì—­ìˆœ
  )

# 3. ì „ì²´ í•©ê³„ í–‰ ì¶”ê°€
summary_final <- summary_with_total %>%
  bind_rows(
    summary_with_total %>%
      summarise(
        ì§ì±… = "ì „ì²´ í•©ê³„",
        n = sum(n[ì •ì±…ì¸ì‹ë„ == "í•©ê³„"]),
        pct = 100,
        ì •ì±…ì¸ì‹ë„ = "í•©ê³„"
      )
  )
print(summary_final, n = Inf)

tab1 <- table(dat_filtered$ì§ì±…, dat_filtered$ì •ì±…ì¸ì‹ë„)
chisq_test1 <- chisq.test(tab1)
print(chisq_test1)
```

```{r}
#| echo: false
#| warning: false
#| message: false
summary_job <- dat_filtered %>%
 group_by(ì§ì±…, ì •ì±…ì¸ì‹ë„) %>%
 summarise(n = n(), .groups = "drop_last") %>%
 mutate(pct = round(n / sum(n) * 100, 1)) %>%
 ungroup() %>%
 # ì •ì±…ì¸ì‹ë„ ìˆœì„œ ì§€ì • (ê¸ì •ì ì¸ ìˆœì„œëŒ€ë¡œ)
 mutate(ì •ì±…ì¸ì‹ë„ = factor(ì •ì±…ì¸ì‹ë„, 
                       levels = c("ì˜ ì•Œê³  ìˆë‹¤", "ì¡°ê¸ˆ ì•Œê³  ìˆë‹¤", "ë³´í†µì´ë‹¤", 
                                "ì˜ ëª¨ë¥¸ë‹¤", "ì „í˜€ ëª¨ë¥¸ë‹¤")))

p0 <- ggplot(summary_job, aes(x = factor(ì§ì±…, levels = c("í•™êµì¥", "êµê°", "êµì‚¬ ë“±")), 
                             y = pct, fill = ì •ì±…ì¸ì‹ë„)) +
 geom_bar(stat = "identity", width = 0.7) +
 labs(
   title = "ì§ì±…ë³„ ì •ì±…ì¸ì‹ë„",
   x = "ì§ì±…",
   y = "ë¹„ìœ¨",
   fill = "ì •ì±…ì¸ì‹ë„"
 ) +
 scale_y_continuous(limits = c(0, 100), expand = expansion(mult = c(0, 0.02))) +
 theme_minimal(base_size = 15) +
 theme(
   plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
   axis.text.x = element_text(size = 20, face = "bold"),
   axis.text.y = element_text(size = 18),
   axis.title.x = element_text(size = 25, angle = 0, margin = margin(t = 15)),
   axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),
   legend.position = "right",
   legend.text = element_text(size = 14),
   legend.title = element_text(size = 16, face = "bold")
 )

print(p0)
```

í•™êµì¥(4.6), êµê°(4.51), êµì‚¬ ë“±(3.94) ì§ì±…ë³„ë¡œ ì •ì±…ì¸ì‹ë„ í‰ê· ì ìˆ˜ë¥¼ ë¹„êµí•œ ê²°ê³¼, í•™êµì¥ê³¼ êµê° ê°„ì—ëŠ” ìœ ì˜ë¯¸í•œ ì°¨ì´ëŠ” ì—†ì—ˆì§€ë§Œ, í•™êµì¥-êµì‚¬ ë“±, êµê°-êµì‚¬ ë“± ê°„ì—ëŠ” ìœ ì˜ë¯¸í•œ ì¸ì‹ë„ ì°¨ì´ê°€ ìˆëŠ” ê²ƒìœ¼ë¡œ ë‚˜íƒ€ë‚¨

(ì •ì±…ì¸ì‹ë„ í‰ê· ì ìˆ˜ëŠ” í•™êµì¥ \>êµì‚¬ ë“±, êµê° \> êµì‚¬ ë“± ìˆœìœ¼ë¡œ ë‚˜íƒ€ë‚¨)

```{r}
#| echo: false
#| warning: false
#| message: false
# ì§ì±…ë³„ ê¸°ìˆ í†µê³„ (ìˆœì„œ ì§€ì •)
job_summary <- dat_filtered %>%
  mutate(ì§ì±… = factor(ì§ì±…, levels = c("í•™êµì¥", "êµê°", "êµì‚¬ ë“±"))) %>%  # ìˆœì„œ ì§€ì •
  group_by(ì§ì±…) %>%
  summarise(
    í‰ê·  = round(mean(ì •ì±…ì¸ì‹ë„ì ìˆ˜, na.rm = TRUE), 2),
    í‘œì¤€í¸ì°¨ = round(sd(ì •ì±…ì¸ì‹ë„ì ìˆ˜, na.rm = TRUE), 2),
    n = n(),
    .groups = "drop"
  ) %>%
  arrange(ì§ì±…)  # factor ë ˆë²¨ ìˆœì„œëŒ€ë¡œ ì •ë ¬

print(job_summary)

# ANOVA (dat_filteredì—ì„œë„ ì§ì±… ìˆœì„œ ì§€ì •)
dat_filtered <- dat_filtered %>%
  mutate(ì§ì±… = factor(ì§ì±…, levels = c("í•™êµì¥", "êµê°", "êµì‚¬ ë“±")))

anova_job <- aov(ì •ì±…ì¸ì‹ë„ì ìˆ˜ ~ ì§ì±…, data = dat_filtered)
summary(anova_job)

# Tukey ì‚¬í›„ê²€ì •
tukey_job <- TukeyHSD(anova_job)
print(tukey_job)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# Tukey ê·¸ë£¹ ë ˆí„° ìƒì„±
tukey_letters_job <- multcompView::multcompLetters4(anova_job, tukey_job)
letters_df_job <- data.frame(
  ì§ì±… = names(tukey_letters_job$`ì§ì±…`$Letters),
  group = tukey_letters_job$`ì§ì±…`$Letters
)

job_summary_with_groups <- job_summary %>%
  left_join(letters_df_job, by = "ì§ì±…")


# ì§ì±…ë³„ ë°•ìŠ¤í”Œë¡¯
ggplot(dat_filtered, aes(x = ì§ì±…, y = ì •ì±…ì¸ì‹ë„ì ìˆ˜, fill = ì§ì±…)) +
  geom_boxplot(alpha = 0.7, width = 0.6, outlier.shape = 21) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 4, fill = "yellow", stroke = 1) +
  geom_text(data = job_summary_with_groups, 
            aes(x = ì§ì±…, y = 6, label = paste0(group, "\n(M=", í‰ê· , ")")),
            inherit.aes = FALSE, fontface = "bold", size = 9, vjust = 0, lineheight =0.5) +
  labs(
    title = "ì§ì±…ë³„ ì •ì±…ì¸ì‹ë„",
    x = "ì§ì±…", 
    y = "ì •ì±…ì¸ì‹ë„"
  ) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
    plot.subtitle = element_text(size = 18, hjust = 0.5, color = "gray40"),
    axis.text.x = element_text(size = 20),
    axis.text.y = element_text(size = 20),
    axis.title.x = element_text(size = 20, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),
    legend.position = "none"
  ) +
  scale_y_continuous(expand = expansion(mult = c(0.05, 0.30)))
```

### ë¬¸í•­ 9-2. í•™êµê¸‰ë³„ ì •ì±…ì¸ì‹ë„ ë¶„ì„

í•™êµê¸‰ë³„ ì‘ë‹µìëŠ” ì´ 3,090ëª…ì´ë©°, ì´ˆë“±í•™êµ ì‘ë‹µìëŠ” 1,277ëª…(41.33%), ì¤‘í•™êµ ì‘ë‹µìëŠ” 1,100ëª…(35.60%), ê³ ë“±í•™êµ ì‘ë‹µìëŠ” 713ëª…(23.07%)ì´ ì‘ë‹µí•˜ì˜€ìŒ

ì´ˆë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ì˜ ì•Œê³  ìˆë‹¤ëŠ” 597ëª…(46.8%), ì¡°ê¸ˆ ì•Œê³  ìˆë‹¤ëŠ” 507ëª…(39.7%), ë³´í†µì´ë‹¤ëŠ” 126ëª…(9.87%), ì˜ ëª¨ë¥¸ë‹¤ëŠ” 44ëª…(3.45%), ì „í˜€ ëª¨ë¥¸ë‹¤ëŠ” 3ëª…(0.23%)ì´ì—ˆìŒ

ì¤‘í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ì˜ ì•Œê³  ìˆë‹¤ëŠ” 499ëª…(45.4%), ì¡°ê¸ˆ ì•Œê³  ìˆë‹¤ëŠ” 427ëª…(38.8%), ë³´í†µì´ë‹¤ëŠ” 122ëª…(11.1%), ì˜ ëª¨ë¥¸ë‹¤ëŠ” 48ëª…(4.36%), ì „í˜€ ëª¨ë¥¸ë‹¤ëŠ” 4ëª…(0.36%)ì´ì—ˆìŒ

ê³ ë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ì˜ ì•Œê³  ìˆë‹¤ëŠ” 306ëª…(42.9%), ì¡°ê¸ˆ ì•Œê³  ìˆë‹¤ëŠ” 227ëª…(31.8%), ë³´í†µì´ë‹¤ëŠ” 132ëª…(18.5%), ì˜ ëª¨ë¥¸ë‹¤ëŠ” 42ëª…(5.89%), ì „í˜€ ëª¨ë¥¸ë‹¤ëŠ” 6ëª…(0.84%)ì´ì—ˆìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
# í•™êµê¸‰ë³„ ì •ì±… ì¸ì‹ë„ ë¶„í¬
summary_school <- dat_filtered %>%
  group_by(í•™êµê¸‰, ì •ì±…ì¸ì‹ë„) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100,2)) %>%
  ungroup() %>%
  mutate(ì •ì±…ì¸ì‹ë„ = factor(ì •ì±…ì¸ì‹ë„, 
                        levels = c("ì˜ ì•Œê³  ìˆë‹¤", "ì¡°ê¸ˆ ì•Œê³  ìˆë‹¤", "ë³´í†µì´ë‹¤", 
                                 "ì˜ ëª¨ë¥¸ë‹¤", "ì „í˜€ ëª¨ë¥¸ë‹¤")))


# í•™êµê¸‰ë³„ í•©ê³„ ì¶”ê°€
summary_school_with_total <- summary_school %>%
  group_by(í•™êµê¸‰) %>%
  summarise(n = sum(n), pct = sum(pct), ì •ì±…ì¸ì‹ë„ = "í•©ê³„") %>%
  bind_rows(summary_school) %>%
  arrange(
    factor(í•™êµê¸‰, levels = c("ì´ˆë“±í•™êµ", "ì¤‘í•™êµ", "ê³ ë“±í•™êµ", "íŠ¹ìˆ˜í•™êµ", "ê°ì¢…í•™êµ")),
    ì •ì±…ì¸ì‹ë„ == "í•©ê³„",
    if_else(ì •ì±…ì¸ì‹ë„ != "í•©ê³„", -n, 0)
  )

print(summary_school_with_total, n = Inf)
tab_school <- table(dat_filtered$í•™êµê¸‰, dat_filtered$ì •ì±…ì¸ì‹ë„)

chisq_test_school <- chisq.test(tab_school)
print(chisq_test_school)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# í•™êµê¸‰ë³„ ì •ì±… ì¸ì‹ë„ ë¶„í¬
summary_school <- dat_filtered %>%
  group_by(í•™êµê¸‰, ì •ì±…ì¸ì‹ë„) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = n / sum(n) * 100) %>%
  ungroup() %>%
  mutate(ì •ì±…ì¸ì‹ë„ = factor(ì •ì±…ì¸ì‹ë„, 
                        levels = c("ì˜ ì•Œê³  ìˆë‹¤", "ì¡°ê¸ˆ ì•Œê³  ìˆë‹¤", "ë³´í†µì´ë‹¤", 
                                 "ì˜ ëª¨ë¥¸ë‹¤", "ì „í˜€ ëª¨ë¥¸ë‹¤")))

# 100% ëˆ„ì  ë¹„ìœ¨ ë§‰ëŒ€ê·¸ë˜í”„
ggplot(summary_school, aes(x = í•™êµê¸‰, y = pct, fill = ì •ì±…ì¸ì‹ë„)) +
  geom_bar(stat = "identity", width = 0.7) +
  labs(
    title = "í•™êµê¸‰ë³„ í•™ìƒë§ì¶¤í†µí•©ì§€ì› ì •ì±… ì¸ì‹ë„",
    x = "í•™êµê¸‰",
    y = "ë¹„ìœ¨",
    fill = "ì •ì±…ì¸ì‹ë„"
  ) +
  scale_y_continuous(limits = c(0, 100), expand = expansion(mult = c(0, 0.02))) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(size = 32, face = "bold", hjust = 0.5),
    axis.text.x = element_text(size = 18, margin = margin(t = 10)),
    axis.text.y = element_text(size = 18),
    axis.title.x = element_text(size = 20, angle = 0, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),
    legend.position = "right",
    legend.text = element_text(size = 15)
  )
```

ì´ˆë“±í•™êµ(4.29), ì¤‘í•™êµ(4.18), ê³ ë“±í•™êµ(3.99) í•™êµê¸‰ë³„ ì •ì±…ì¸ì‹ë„ í‰ê· ì ìˆ˜ë¥¼ ë¹„êµí•œ ê²°ê³¼, ì´ˆë“±í•™êµ, ì¤‘í•™êµ, ê³ ë“±í•™êµ ì •ì±…ì¸ì‹ë„ í‰ê·  ì ìˆ˜ì—ëŠ” ìœ ì˜ë¯¸í•œ ì°¨ì´ê°€ ìˆëŠ” ê²ƒìœ¼ë¡œ ë‚˜íƒ€ë‚¨ (ì´ˆë“±í•™êµ \> ì¤‘í•™êµ \> ê³ ë“±í•™êµ)

```{r}
#| echo: false
#| warning: false
#| message: false
# 1) ë¶„ì„ìš© ë°ì´í„° ë§Œë“¤ê¸° (ì´ˆ/ì¤‘/ê³ ë§Œ, likert 1~5 â†’ ì ìˆ˜í™” 5~1)
dat_score <- dat_filtered %>%
  filter(ques_1 %in% 1:3, !is.na(ques_9)) %>%       # â† ë‹¤ë¥¸ ë¬¸í•­ì´ë©´ ques_9ë¥¼ ë°”ê¾¸ì„¸ìš”
  mutate(
    í•™êµê¸‰ = factor(recode(as.character(ques_1),
                           "1"="ì´ˆë“±í•™êµ","2"="ì¤‘í•™êµ","3"="ê³ ë“±í•™êµ"),
                    levels = c("ì´ˆë“±í•™êµ","ì¤‘í•™êµ","ê³ ë“±í•™êµ")),
    ì •ì±…ì¸ì‹ë„ì ìˆ˜ = recode(as.character(ques_9),  # 1=ë§¤ìš° ê¸ì • â†’ 5ì 
                       "1"=5,"2"=4,"3"=3,"4"=2,"5"=1) |> as.numeric()
  ) %>%
  select(í•™êµê¸‰, ì •ì±…ì¸ì‹ë„ì ìˆ˜)

# ì•ˆì „ì¥ì¹˜
stopifnot(nrow(dat_score) > 0, all(!is.na(dat_score$ì •ì±…ì¸ì‹ë„ì ìˆ˜)))

# 2) í•™êµê¸‰ë³„ ê¸°ìˆ í†µê³„ (factor ìˆœì„œëŒ€ë¡œ)
school_summary <- dat_score %>%
  group_by(í•™êµê¸‰) %>%
  summarise(
    í‰ê·  = round(mean(ì •ì±…ì¸ì‹ë„ì ìˆ˜), 2),
    í‘œì¤€í¸ì°¨ = round(sd(ì •ì±…ì¸ì‹ë„ì ìˆ˜), 2),
    n = n(),
    .groups = "drop"
  )
print(school_summary, n = Inf)

# ANOVA
anova_school <- aov(ì •ì±…ì¸ì‹ë„ì ìˆ˜ ~ í•™êµê¸‰, data = dat_score)
summary(anova_school)

# Tukey ì‚¬í›„ê²€ì •
tukey_school <- TukeyHSD(anova_school)
print(tukey_school)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# Tukey ê·¸ë£¹ ë ˆí„° ìƒì„± ë° ê¸°ìˆ í†µê³„ì™€ ê²°í•©
tukey_letters_school <- multcompView::multcompLetters4(anova_school, tukey_school)
school_summary_final <- school_summary %>%
  left_join(
    data.frame(
      í•™êµê¸‰ = names(tukey_letters_school$`í•™êµê¸‰`$Letters),
      group = tukey_letters_school$`í•™êµê¸‰`$Letters
    ), 
    by = "í•™êµê¸‰"
  )

print(school_summary_final)
# í•™êµê¸‰ë³„ ë°•ìŠ¤í”Œë¡¯

ggplot(dat_filtered, aes(x = í•™êµê¸‰, y = ì •ì±…ì¸ì‹ë„ì ìˆ˜, fill = í•™êµê¸‰)) +
  geom_boxplot(alpha = 0.7, width = 0.6, outlier.shape = 21) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 4, fill = "yellow", stroke = 1) +
  geom_text(data = school_summary_final, 
            aes(x = í•™êµê¸‰, y = 6, label = paste0(group, "\n(M=", í‰ê· , ")")),
            inherit.aes = FALSE, fontface = "bold", size = 9, vjust = 0, lineheight=0.5) +
  labs(
    title = "í•™êµê¸‰ë³„ ì •ì±…ì¸ì‹ë„",
    x = "í•™êµê¸‰", 
    y = "ì •ì±…ì¸ì‹ë„"
  ) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
    plot.subtitle = element_text(size = 18, hjust = 0.5, color = "gray40"),
    axis.text.x = element_text(size = 18),
    axis.text.y = element_text(size = 18),
    axis.title.x = element_text(size = 20, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),
    legend.position = "none"
  ) +
  scale_y_continuous(expand = expansion(mult = c(0.05, 0.30)))
```

### ë¬¸í•­ 9-3. ì„¤ë¦½ë³„ ì •ì±…ì¸ì‹ë„ ë¶„ì„

ì„¤ë¦½ë³„ ì‘ë‹µìëŠ” ì´ 3,090ëª…ì´ë©° ì´ ì¤‘ì—ì„œ ê³µë¦½í•™êµ ì‘ë‹µìëŠ” 2,317ëª…(74.5%), ì‚¬ë¦½í•™êµ ì‘ë‹µìëŠ” 761ëª…(25.5%)ì´ ì‘ë‹µí•˜ì˜€ìŒ.

ê³µë¦½í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 1,660ëª…(71.6%), ê·¸ë ‡ë‹¤ëŠ” 582ëª…(25.1%), ë³´í†µì´ë‹¤ëŠ” 63ëª…(2.72%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 8ëª…(0.35%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 4ëª…(0.17%)ì´ì—ˆìŒ

ì‚¬ë¦½í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 532ëª…(68.8%), ê·¸ë ‡ë‹¤ëŠ” 215ëª…(27.8%), ë³´í†µì´ë‹¤ëŠ” 19ëª…(2.46%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 4ëª…(0.52%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 3ëª…(0.39%)ì´ì—ˆìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
# 1. ì„¤ë¦½ë³„ ë°ì´í„° ì¤€ë¹„
dat_found <- dat_filtered %>%
  filter(ì„¤ë¦½ %in% c("ê³µë¦½", "ì‚¬ë¦½")) %>%  # êµ­ë¦½ ì œì™¸
  mutate(ì„¤ë¦½ = factor(ì„¤ë¦½, levels = c("ê³µë¦½", "ì‚¬ë¦½")))

# 2. ì„¤ë¦½ë³„ êµì°¨í‘œ
summary_found <- dat_found %>%
  group_by(ì„¤ë¦½, ì •ì±…ì¸ì‹ë„) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

summary_found_total <- summary_found %>%
  group_by(ì„¤ë¦½) %>%
  summarise(n = sum(n), pct = 100, ì •ì±…ì¸ì‹ë„ = "í•©ê³„", .groups = "drop") %>%
  bind_rows(summary_found) %>%
  arrange(ì„¤ë¦½, ì •ì±…ì¸ì‹ë„ == "í•©ê³„", desc(n))

print(summary_found_total, n = Inf)

# 3. ì¹´ì´ì œê³± ê²€ì •
tab_found <- table(dat_found$ì„¤ë¦½, dat_found$ì •ì±…ì¸ì‹ë„)
chisq_test_found <- chisq.test(tab_found)
print(chisq_test_found)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# 4. ì„¤ë¦½ë³„ ëˆ„ì ë§‰ëŒ€ê·¸ë˜í”„
# ì •ì±…ì¸ì‹ë„ ìˆœì„œ ì§€ì •
summary_found_plot <- summary_found %>%
  mutate(ì •ì±…ì¸ì‹ë„ = factor(ì •ì±…ì¸ì‹ë„, 
                        levels = c("ì˜ ì•Œê³  ìˆë‹¤", "ì¡°ê¸ˆ ì•Œê³  ìˆë‹¤", "ë³´í†µì´ë‹¤", 
                                 "ì˜ ëª¨ë¥¸ë‹¤", "ì „í˜€ ëª¨ë¥¸ë‹¤")))

ggplot(summary_found_plot, aes(x = ì„¤ë¦½, y = pct, fill = ì •ì±…ì¸ì‹ë„)) +
  geom_bar(stat = "identity", width = 0.7) +
  labs(
    title = "ì„¤ë¦½ë³„ ì •ì±…ì¸ì‹ë„",
    x = "ì„¤ë¦½",
    y = "ë¹„ìœ¨",
    fill = "ì •ì±…ì¸ì‹ë„"
  ) +
  scale_y_continuous(limits = c(0, 100), expand = expansion(mult = c(0, 0.02))) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(size = 32, face = "bold", hjust = 0.5),
    axis.text.x = element_text(size = 18, margin = margin(t = 10)),
    axis.text.y = element_text(size = 18),
    axis.title.x = element_text(size = 20, angle = 0, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),
    legend.position = "right",
    legend.text = element_text(size = 18),
    legend.title = element_text(size = 16, face = "bold")
  )
```

ê³µë¦½í•™êµ(4.68), ì‚¬ë¦½í•™êµ(4.64) í‰ê· ì ìˆ˜ë¥¼ ë¹„êµí•œ ê²°ê³¼, ê³µë¦½í•™êµì™€ ì‚¬ë¦½í•™êµ ê°„ì—ëŠ” ì •ì±…ì¸ì‹ë„ í‰ê·  ì ìˆ˜ì—ëŠ” ìœ ì˜ë¯¸í•œ ì°¨ì´ê°€ ìˆëŠ” ê²ƒìœ¼ë¡œ ë‚˜íƒ€ë‚¨

```{r}
#| echo: false
#| warning: false
#| message: false
# ì„¤ë¦½ë³„ ê¸°ìˆ í†µê³„
summary_found_stats <- dat_found %>%
  group_by(ì„¤ë¦½) %>%
  summarise(
    í‰ê·  = round(mean(ì •ì±…ì¸ì‹ë„ì ìˆ˜, na.rm = TRUE), 2),
    í‘œì¤€í¸ì°¨ = round(sd(ì •ì±…ì¸ì‹ë„ì ìˆ˜, na.rm = TRUE), 2),
    n = n(),
    .groups = "drop"
  )

print(summary_found_stats)

# ì •ê·œì„± ê²€ì • (Shapiro-Wilk test)
normality_test <- dat_found %>%
  group_by(ì„¤ë¦½) %>%
  summarise(
    shapiro_p = shapiro.test(ì •ì±…ì¸ì‹ë„ì ìˆ˜)$p.value,
    .groups = "drop"
  )

print(normality_test)

# T-test (Welch's t-test - ë“±ë¶„ì‚° ê°€ì •í•˜ì§€ ì•ŠìŒ)
t_test_result <- t.test(ì •ì±…ì¸ì‹ë„ì ìˆ˜ ~ ì„¤ë¦½, data = dat_found, var.equal = FALSE)
print(t_test_result)
```

```{r}
#| echo: false
#| warning: false
#| message: false
tukey_letters_school <- list(
  `ì„¤ë¦½` = list(
    Letters = setNames(
      if (t_test_result$p.value < 0.05) c("a","b") else c("a","a"),
      c("ê³µë¦½","ì‚¬ë¦½")
    )
  )
)

school_summary_final <- summary_found_stats %>%
  dplyr::left_join(
    data.frame(
      ì„¤ë¦½ = names(tukey_letters_school$`ì„¤ë¦½`$Letters),
      group = unname(tukey_letters_school$`ì„¤ë¦½`$Letters)
    ),
    by = "ì„¤ë¦½"
  )


## ë ˆí„°/í‰ê·  í‘œì‹ì„ ì˜¬ë¦´ yì¢Œí‘œ(ìœ„ ì—¬ë°±) â€” ë°ì´í„° ë²”ìœ„ì— ë§ê²Œ ìë™
y_top_estab <- max(dat_found$ì •ì±…ì¸ì‹ë„ì ìˆ˜, na.rm = TRUE) + 0.25

ggplot(dat_found, aes(x = ì„¤ë¦½, y = ì •ì±…ì¸ì‹ë„ì ìˆ˜, fill = ì„¤ë¦½)) +
  geom_boxplot(alpha = 0.7, width = 0.6, outlier.shape = 21) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 4,
               fill = "yellow", stroke = 1) +
  ## â–¼ ë ˆí„° + í‰ê· (M=) í‘œì‹œ (school_summary_final ì‚¬ìš©)
  geom_text(data = school_summary_final,
            aes(x = ì„¤ë¦½, y = y_top_estab,
                label = paste0(group, "\n(M=", í‰ê· , ")")),
            inherit.aes = FALSE, fontface = "bold", size = 9, vjust = 0, lineheight=0.5) +
  labs(title = "ì„¤ë¦½ë³„ ì •ì±…ì¸ì‹ë„ ë¹„êµ",
       x = "ì„¤ë¦½", y = "ì •ì±…ì¸ì‹ë„") +
  theme_minimal(base_size = 15) +
  theme(plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
        axis.text.x = element_text(size = 20),
        axis.text.y = element_text(size = 20),
        axis.title.x = element_text(size = 23, margin = margin(t = 15)),
        axis.title.y = element_text(size = 23, angle = 0, vjust = 0.5),
        legend.position = "none") +
  ## ë ˆí„°ê°€ ì˜ ë³´ì´ë„ë¡ ìƒë‹¨ ì—¬ë°±/ë¦¬ë°‹
  scale_y_continuous(limits = c(min(dat_found$ì •ì±…ì¸ì‹ë„ì ìˆ˜, na.rm=TRUE),
                                y_top_estab + 0.1),
                     expand = expansion(mult = c(0.05, 0.15)))
```

### ë¬¸í•­10. \[9ë²ˆ ë¬¸í•­ì—ì„œ â‘ ë²ˆ í˜¹ì€ â‘¡ë²ˆì„ ì„ íƒí•œ ë¶„ë“¤ë§Œ ë‹µë³€í•´ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.\] í•™ìƒë§ì¶¤í†µí•©ì§€ì› ì œë„ë¥¼ ì¸ì§€í•˜ê²Œ ëœ ê²½ë¡œëŠ” ë¬´ì—‡ì…ë‹ˆê¹Œ?

â‘  êµìœ¡ë¶€ë˜ëŠ” êµìœ¡(ì§€ì›)ì²­ ê³µë¬¸(ê¸°ë³¸ê³„íš ì•ˆë‚´ ê³µë¬¸ ë“±) â‘¡ ì—°ìˆ˜ ë˜ëŠ” íšŒì˜ â‘¢ ë‰´ìŠ¤ ë“± ë¯¸ë””ì–´ ë³´ë„ ë° í™ë³´ìë£Œ â‘£ ì£¼ë³€ ë‹¤ë¥¸ êµì§ì›ë“¤ì„ í†µí•´ì„œ â‘¤ ê¸°íƒ€

í•™ìƒë§ì¶¤í†µí•©ì§€ì›ì— ëŒ€í•´ ì¸ì§€í•˜ê²Œ ëœ ê²½ë¡œì— ëŒ€í•œ ë¬¸í•­ì— 2,619ëª…ì´ ì‘ë‹µí•˜ì˜€ê³ , ì—°ìˆ˜ ë˜ëŠ” íšŒì˜ë¥¼ í†µí•´ì„œ ì•Œê²Œë˜ì—ˆë‹¤ëŠ” ì‘ë‹µìê°€ 1,379ëª…(52.7%)ì´ê³  êµìœ¡ë¶€ ë˜ëŠ” êµìœ¡ì²­ ê³µë¬¸ì„ í†µí•´ì„œë¼ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 1,135ëª…(43.3%)ì´ê³  ë‹¤ìŒìœ¼ë¡œ ì£¼ë³€ êµì§ì›ì„ í†µí•´ ì¸ì§€í•˜ê²Œ ë˜ì—ˆë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 60ëª…(2.2%) ë“± ìˆœìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
dat_q10 <- dat %>%
  filter(ques_9 %in% c(1,2), !is.na(ques_10)) %>% 
  mutate(
    í•™êµê¸‰ = recode(as.character(ques_1),
                 "1" = "ì´ˆë“±í•™êµ",
                 "2" = "ì¤‘í•™êµ",
                 "3" = "ê³ ë“±í•™êµ",
                 "4" = "íŠ¹ìˆ˜í•™êµ",
                 "5" = "ê°ì¢…í•™êµ"),
    í•™êµê¸‰ = factor(í•™êµê¸‰, levels = c("ì´ˆë“±í•™êµ","ì¤‘í•™êµ","ê³ ë“±í•™êµ","íŠ¹ìˆ˜í•™êµ", "ê°ì¢…í•™êµ")),
    ì‘ë‹µ10 = factor(ques_10,
                  levels = 1:5,
                  labels = c(
                    " êµìœ¡ë¶€/êµìœ¡ì²­ ê³µë¬¸",
                    " ì—°ìˆ˜ ë˜ëŠ” íšŒì˜",
                    " ë‰´ìŠ¤ ë“± ë¯¸ë””ì–´",
                    " ì£¼ë³€ êµì§ì›",
                    " ê¸°íƒ€"
                  )
    )
  )
    
summary_q10 <- dat_q10 %>%
  group_by(ì‘ë‹µ10) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  arrange(ì‘ë‹µ10, desc(n)) %>% 
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

# í•©ê³„ í–‰ ì¶”ê°€
summary_q10_total <- summary_q10 %>%
  summarise(
    ì‘ë‹µ10 = "í•©ê³„",
    n = sum(n),
    pct = 100,
    .groups = "drop"
  ) %>%
  bind_rows(summary_q10) %>%
  arrange(if_else(ì‘ë‹µ10 == "í•©ê³„", 2, 1),
          desc(n)
)  # ğŸ”¹ í•©ê³„ëŠ” ë§ˆì§€ë§‰ì—

print(summary_q10_total, n = Inf)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# 3) ì‹œê°í™”
ggplot(summary_q10, aes(x = reorder(ì‘ë‹µ10, -n), y = n, fill = ì‘ë‹µ10)) +
  geom_bar(stat="identity", width=0.7) +
  geom_text(aes(label = paste0(n,"ëª…\n(",pct,"%)")), 
            vjust=-0.25, size= 8, lineheight=0.5)  +
  labs(
    title = "í•™ìƒë§ì¶¤í†µí•©ì§€ì› ì¸ì§€ ê²½ë¡œ",
    x = "ì‘ë‹µí•­ëª©",
    y = "ì‘ë‹µìˆ˜"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face="bold", size=32, hjust=0.5),
    legend.position = "none",
    axis.title.x = element_text(margin = margin(t = 15), size = 18),
    axis.text.x = element_text(angle=0, vjust=0.8, size = 18),
    strip.text = element_text(face="bold", size=18),
    axis.title.y = element_text(angle = 0, vjust = 0.5, size =18)  # yì¶• ì œëª© ê°€ë¡œ í‘œì‹œ
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.6)))
```

### ë¬¸í•­11. í•™ìƒë§ì¶¤í†µí•©ì§€ì› ì œë„ê°€ ì¶©ë¶„íˆ ì•ˆë‚´ ë° í™ë³´ë˜ê³  ìˆë‹¤ê³  ë³´ì‹­ë‹ˆê¹Œ?

â‘  ë§¤ìš° ê·¸ë ‡ë‹¤ â‘¡ ê·¸ë ‡ë‹¤ â‘¢ ë³´í†µì´ë‹¤ â‘£ ê·¸ë ‡ì§€ ì•Šë‹¤ â‘¤ ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤

í•™ìƒë§ì¶¤í†µí•©ì§€ì› í™ë³´ì˜ ì¶©ë¶„ì„± ë¬¸í•­ì— ì´ ì‘ë‹µìëŠ” 3,178ëª…ì´ë©° ë§¤ìš° ê·¸ë ‡ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 401ëª…(12.6%), ê·¸ë ‡ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 1,247ëª…(39.2%), ë³´í†µì´ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 1,117ëª…(35.1%), ê·¸ë ‡ì§€ ì•Šë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 351ëª…(11%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 62ëª…(2%)ë¡œ ë‚˜íƒ€ë‚¬ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
# 11ë²ˆ ë¬¸í•­ ì „ì²˜ë¦¬
dat_q11 <- dat %>%
  filter(ques_1 %in% 1:5, !is.na(ques_11)) %>%    # ì´ˆÂ·ì¤‘Â·ê³ , ì‘ë‹µ NA ì œì™¸
  mutate(
    ì‘ë‹µ11 = factor(
      ques_11,
      levels = 1:5,
      labels = c("ë§¤ìš° ê·¸ë ‡ë‹¤","ê·¸ë ‡ë‹¤","ë³´í†µì´ë‹¤","ê·¸ë ‡ì§€ ì•Šë‹¤","ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤")
    ))
    
# ê¸°ìˆ í†µê³„ (ë¹ˆë„, ë¹„ìœ¨)
summary_q11 <- dat_q11 %>%
  group_by(ì‘ë‹µ11) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup() %>%
  arrange(desc(n)) %>%  # ë¹ˆë„ìˆ˜ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
  bind_rows(summarise(., ì‘ë‹µ11 = "í•©ê³„", n = sum(n), pct = sum(pct)))

# âœ… ê¸°ìˆ í†µê³„ ì¶œë ¥
print(summary_q11, n = Inf)
```

```{r}
#| echo: false
#| warning: false
#| message: false
ggplot(summary_q11 %>% filter(ì‘ë‹µ11 != "í•©ê³„") , aes(x = reorder(ì‘ë‹µ11, -n), y = n, fill = ì‘ë‹µ11)) +
  geom_bar(stat="identity", width=0.7) +
  geom_text(aes(label = paste0(n,"ëª…\n(",pct,"%)")), 
            vjust=-0.5, size=4.5, fontface="bold") +
  labs(
    title = "í•™ìƒë§ì¶¤í†µí•©ì§€ì› í™ë³´ì˜ ì¶©ë¶„ì„±",
    x = "ì‘ë‹µí•­ëª©",
    y = "ì‘ë‹µìˆ˜"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face="bold", size=24, hjust=0.5, margin = margin(b = 18)),
    legend.position = "none",
    axis.text.x = element_text(angle=0, hjust=0.5, size=18, lineheight=0.8),
    axis.text.y = element_text(size=18),
    axis.title.x = element_text(size=18, margin = margin(t = 12)),
    axis.title.y = element_text(angle = 0, vjust = 0.5, size=18),
    strip.text = element_text(face="bold", size=15, margin = margin(t = 6, b = 6)),
    panel.spacing = unit(1.2, "lines"),  # íŒ¨ë„ ê°„ê²© ì¡°ê¸ˆ ì¦ê°€
    plot.margin = margin(18, 18, 18, 18)
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.5))) +
  coord_cartesian(clip = "off")
```

ë¶„ì„ê³¼ì •

1\) ì‘ë‹µì ìœ í˜• ë¶„ë¥˜: ì§ì±…ë³„(í•™êµì¥, êµê°, êµì‚¬ ë“±), í•™êµê¸‰ë³„(ì´ˆë“±í•™êµ, ì¤‘í•™êµ, ê³ ë“±í•™êµ), ì„¤ë¦½ë³„(ê³µë¦½, ì‚¬ë¦½)ìœ¼ë¡œ êµ¬ë¶„í•˜ì˜€ìŒ. ìœ í˜•ë³„ ë¹„êµë¥¼ ìœ„í•´ ì‘ë‹µì ìˆ˜ê°€ ì ì€ íŠ¹ìˆ˜í•™êµ, ê°ì¢…í•™êµ ë° ê³µë¦½í•™êµëŠ” ì¡°ì‚¬ëŒ€ìƒìì—ì„œ ì œì™¸í•˜ì˜€ìŒ. ì´ì™€ ê°™ì´ ì‘ë‹µì ìœ í˜•ì„ ë¶„ë¥˜í•˜ê³  ì‘ë‹µì ì§‘ë‹¨ ê°„ì˜ ë‹µë³€ ë¶„í¬ë¥¼ ë¹„êµí•˜ì˜€ìŒ

2\) ì‘ë‹µì ìˆ˜ ì‚°ì¶œë°©ë²•: â€˜ë§¤ìš° ê·¸ë ‡ë‹¤â€™ëŠ” 5ì ì„ ë¶€ì—¬í•˜ê³  â€˜ê·¸ë ‡ë‹¤â€™ëŠ” 4ì , â€˜ë³´í†µì´ë‹¤â€™ëŠ” 3ì , â€˜ê·¸ë ‡ì§€ ì•Šë‹¤â€™ëŠ” 2ì , â€˜ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤â€™ëŠ” 1ì ì„ ë¶€ì—¬í•˜ì—¬ ì¸ì‹ë„ ì ìˆ˜ë¥¼ ì‚°ì¶œí•˜ì˜€ìŒ

### ë¬¸í•­ 11-1. ì§ì±…ë³„ í™ë³´ì¶©ë¶„ì„± ë¶„ì„

ì§ì±…ë³„ ì‘ë‹µìëŠ” ì´ 3,090ëª…ì´ë©° ì´ ì¤‘ì—ì„œ í•™êµì¥ì€ 474ëª…(15.34%), êµê°ì€ 761ëª…(24.63%), êµì‚¬ ë“±ì€ 1,855ëª…(60.03%)ì´ ì‘ë‹µí•˜ì˜€ìŒ.

í•™êµì¥ ì‘ë‹µ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 90ëª…(19%), ê·¸ë ‡ë‹¤ëŠ” 228ëª…(48.1%), ë³´í†µì´ë‹¤ëŠ” 128ëª…(27%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 26ëª…(5.5%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 2ëª…(0.4%)ì´ì—ˆìŒ.

êµê° ì‘ë‹µ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 113ëª…(14.8%), ê·¸ë ‡ë‹¤ëŠ” 369ëª…(48.5%), ë³´í†µì´ë‹¤ëŠ” 236ëª…(31%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 37ëª…(4.9%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 6ëª…(0.8%)ì´ì—ˆìŒ.

êµì‚¬ ë“± ì‘ë‹µ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 194ëª…(10.5%), ê·¸ë ‡ë‹¤ëŠ” 627ëª…(33.8%), ë³´í†µì´ë‹¤ëŠ” 718ëª…(38.7%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 268ëª…(14.4%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 48ëª…(2.6%)ì´ì—ˆìŒ.

```{r}
#| echo: false
#| warning: false
#| message: false
# =============================================================================
# ë¬¸í•­ 11: í•™ìƒë§ì¶¤í†µí•©ì§€ì› ì œë„ í™ë³´ì˜ ì¶©ë¶„ì„± ë¶„ì„
# =============================================================================

# 1. ê¸°ë³¸ ë¹ˆë„ë¶„ì„
ques11_freq <- dat_filtered %>%
  filter(!is.na(ques_11), as.character(ques_11) %in% c("1","2","3","4","5")) %>%
  count(ques_11) %>%
  mutate(
    ì‘ë‹µ = recode(as.character(ques_11),
                 "1" = "ë§¤ìš° ê·¸ë ‡ë‹¤",
                 "2" = "ê·¸ë ‡ë‹¤",
                 "3" = "ë³´í†µì´ë‹¤",
                 "4" = "ê·¸ë ‡ì§€ ì•Šë‹¤",
                 "5" = "ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤"),
    pct = round(n / sum(n) * 100, 1)
  ) %>%
  arrange(desc(n)) %>%
  bind_rows(summarise(., ì‘ë‹µ = "í•©ê³„", n = sum(n), pct = sum(pct)))


# =============================================================================
# 3. ë¶„ì„ì„ ìœ„í•œ ë°ì´í„° ì¤€ë¹„
# =============================================================================

dat_filtered <- dat_filtered %>%
  mutate(
    í™ë³´ì¶©ë¶„ì„± = factor(as.character(ques_11),
                     levels = c("1","2","3","4","5"),
                     labels = c("ë§¤ìš° ê·¸ë ‡ë‹¤","ê·¸ë ‡ë‹¤","ë³´í†µì´ë‹¤","ê·¸ë ‡ì§€ ì•Šë‹¤","ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤")),
    í™ë³´ì¶©ë¶„ì„±ì ìˆ˜ = case_when(
      ques_11 == 1 ~ 5,   # ë§¤ìš° ê·¸ë ‡ë‹¤
      ques_11 == 2 ~ 4,   # ê·¸ë ‡ë‹¤
      ques_11 == 3 ~ 3,   # ë³´í†µì´ë‹¤
      ques_11 == 4 ~ 2,   # ê·¸ë ‡ì§€ ì•Šë‹¤
      ques_11 == 5 ~ 1,   # ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤
      TRUE ~ NA_real_
    )
  )
# =============================================================================
# 4. ì§ì±…ë³„ ë¶„ì„
# =============================================================================

# ì§ì±…ë³„ êµì°¨í‘œ
summary_table_11 <- dat_filtered %>%
  group_by(ì§ì±…, í™ë³´ì¶©ë¶„ì„±) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

summary_with_total_11 <- summary_table_11 %>%
  group_by(ì§ì±…) %>%
  summarise(n = sum(n), pct = sum(pct), í™ë³´ì¶©ë¶„ì„± = "í•©ê³„") %>%
  bind_rows(summary_table_11) %>%
  arrange(
    factor(ì§ì±…, levels = c("í•™êµì¥","êµê°","êµì‚¬ ë“±")),
    í™ë³´ì¶©ë¶„ì„± == "í•©ê³„",
    if_else(í™ë³´ì¶©ë¶„ì„± != "í•©ê³„", -n, 0)
  )

print(summary_with_total_11, n = Inf)

# ì§ì±…ë³„ ì¹´ì´ì œê³± ê²€ì •
tab1_11 <- table(dat_filtered$ì§ì±…, dat_filtered$í™ë³´ì¶©ë¶„ì„±)
chisq_test1_11 <- chisq.test(tab1_11)
print(chisq_test1_11)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# ì§ì±…ë³„ ëˆ„ì ë§‰ëŒ€ê·¸ë˜í”„
summary_job_11 <- dat_filtered %>%
  group_by(ì§ì±…, í™ë³´ì¶©ë¶„ì„±) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup() %>%
  mutate(í™ë³´ì¶©ë¶„ì„± = factor(í™ë³´ì¶©ë¶„ì„±, 
                        levels = c("ë§¤ìš° ê·¸ë ‡ë‹¤", "ê·¸ë ‡ë‹¤", "ë³´í†µì´ë‹¤", 
                                 "ê·¸ë ‡ì§€ ì•Šë‹¤", "ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤")))

p0_11 <- ggplot(summary_job_11, aes(x = factor(ì§ì±…, levels = c("í•™êµì¥", "êµê°", "êµì‚¬ ë“±")), 
                                    y = pct, fill = í™ë³´ì¶©ë¶„ì„±)) +
  geom_bar(stat = "identity", width = 0.7) +
  labs(
    title = "ì§ì±…ë³„ í™ë³´ì¶©ë¶„ì„±",
    x = "ì§ì±…",
    y = "ë¹„ìœ¨",
    fill = "í™ë³´ì¶©ë¶„ì„±"
  ) +
  scale_y_continuous(limits = c(0, 100), expand = expansion(mult = c(0, 0.02))) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
    axis.text.x = element_text(size = 20, face = "bold"),
    axis.text.y = element_text(size = 20),
    axis.title.x = element_text(size = 25, angle = 0, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),
    legend.position = "right",
    legend.text = element_text(size = 20),
    legend.title = element_text(size = 20, face = "bold")
  )
print(p0_11)
```

í•™êµì¥(3.8), êµê°(3.72), êµì‚¬ ë“±(3.35) ê°„ í™ë³´ì¶©ë¶„ì„± ëŒ€í•œ í‰ê· ì ìˆ˜ë¥¼ ë¹„êµí•œ ê²°ê³¼, í•™êµì¥ê³¼ êµê° ê°„ì—ëŠ” ìœ ì˜ë¯¸í•œ ì°¨ì´ëŠ” ì—†ì—ˆì§€ë§Œ, í•™êµì¥-êµì‚¬ ë“±, êµê°-êµì‚¬ ë“± ê°„ì—ëŠ” ìœ ì˜ë¯¸í•œ ì¸ì‹ë„ ì°¨ì´ê°€ ìˆëŠ” ê²ƒìœ¼ë¡œ ë‚˜íƒ€ë‚¨ (í•™ìƒë§ì¶¤í†µí•©ì§€ì› í™ë³´ê°€ ì¶©ë¶„í•œì§€ì— ëŒ€í•´ í•™êµì¥ \>êµì‚¬ ë“±, êµê° \> êµì‚¬ ë“± ìˆœìœ¼ë¡œ ë‚˜íƒ€ë‚¨)

```{r}
#| echo: false
#| warning: false
#| message: false
# ì§ì±…ë³„ ê¸°ìˆ í†µê³„ ë° ANOVA
job_summary_11 <- dat_filtered %>%
  mutate(ì§ì±… = factor(ì§ì±…, levels = c("í•™êµì¥", "êµê°", "êµì‚¬ ë“±"))) %>%
  group_by(ì§ì±…) %>%
  summarise(
    í‰ê·  = round(mean(í™ë³´ì¶©ë¶„ì„±ì ìˆ˜, na.rm = TRUE), 2),
    í‘œì¤€í¸ì°¨ = round(sd(í™ë³´ì¶©ë¶„ì„±ì ìˆ˜, na.rm = TRUE), 2),
    n = n(),
    .groups = "drop"
  ) %>%
  arrange(ì§ì±…)

print(job_summary_11)

anova_job_11 <- aov(í™ë³´ì¶©ë¶„ì„±ì ìˆ˜ ~ ì§ì±…, data = dat_filtered)
summary(anova_job_11)

tukey_job_11 <- TukeyHSD(anova_job_11)
print(tukey_job_11)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# ì§ì±…ë³„ Tukey ê·¸ë£¹ ë ˆí„° ìƒì„±
tukey_letters_job_11 <- multcompView::multcompLetters4(anova_job_11, tukey_job_11)
letters_df_job_11 <- data.frame(
  ì§ì±… = names(tukey_letters_job_11$`ì§ì±…`$Letters),
  group = tukey_letters_job_11$`ì§ì±…`$Letters
)

job_summary_with_groups_11 <- job_summary_11 %>%
  left_join(letters_df_job_11, by = "ì§ì±…")

# ì§ì±…ë³„ ë°•ìŠ¤í”Œë¡¯
ggplot(dat_filtered, aes(x = factor(ì§ì±…, levels = c("í•™êµì¥", "êµê°", "êµì‚¬ ë“±")), y = í™ë³´ì¶©ë¶„ì„±ì ìˆ˜, fill = ì§ì±…)) +
  geom_boxplot(alpha = 0.7, width = 0.6, outlier.shape = 21) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 4, fill = "yellow", stroke = 1) +
  geom_text(data = job_summary_with_groups_11, 
            aes(x = ì§ì±…, y = 6, label = paste0(group, "\n(M=", í‰ê· , ")")),
            inherit.aes = FALSE, fontface = "bold", size = 9, vjust = 0, lineheight=0.5) +
  labs(
    title = "ì§ì±…ë³„ í™ë³´ì¶©ë¶„ì„±",
    x = "ì§ì±…", 
    y = "í™ë³´ì¶©ë¶„ì„±"
  ) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
    axis.text.x = element_text(size = 18),
    axis.text.y = element_text(size = 18),
    axis.title.x = element_text(size = 20, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),
    legend.position = "none"
  ) +
  scale_y_continuous(expand = expansion(mult = c(0.1, 0.2)))
```

### ë¬¸í•­ 11-2. í•™êµê¸‰ë³„ í™ë³´ì¶©ë¶„ì„± ë¶„ì„

í•™êµê¸‰ë³„ ì‘ë‹µìëŠ” ì´ 3,090ëª…ì´ë©°, ì´ˆë“±í•™êµ ì‘ë‹µìëŠ” 1,277ëª…(41.33%), ì¤‘í•™êµ ì‘ë‹µìëŠ” 1,100ëª…(35.60%), ê³ ë“±í•™êµ ì‘ë‹µìëŠ” 713ëª…(23.07%)ì´ ì‘ë‹µí•˜ì˜€ìŒ.

ì´ˆë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 194ëª…(15.2%), ê·¸ë ‡ë‹¤ëŠ” 527ëª…(41.3%), ë³´í†µì´ë‹¤ëŠ” 425ëª…(33.3%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 104ëª…(8.1%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 27ëª…(2.1%)ì´ì—ˆìŒ.

ì¤‘í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 153ëª…(13.9%), ê·¸ë ‡ë‹¤ëŠ” 436ëª…(39.6%), ë³´í†µì´ë‹¤ëŠ” 373ëª…(33.9%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 123ëª…(11.2%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 15ëª…(1.4%)ì´ì—ˆìŒ.

ê³ ë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 50ëª…(7%), ê·¸ë ‡ë‹¤ëŠ” 261ëª…(36.6%), ë³´í†µì´ë‹¤ëŠ” 284ëª…(39.8%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 104ëª…(14.6%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 14ëª…(2%)ì´ì—ˆìŒ.

```{r}
#| echo: false
#| warning: false
#| message: false
# í•™êµê¸‰ë³„ ê¸°ìˆ í†µê³„
summary_table_11 <- dat_filtered %>%
  group_by(í•™êµê¸‰, í™ë³´ì¶©ë¶„ì„±) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

summary_with_total_11 <- summary_table_11 %>%
  group_by(í•™êµê¸‰) %>%
  summarise(n = sum(n), pct = sum(pct), í™ë³´ì¶©ë¶„ì„± = "í•©ê³„") %>%
  bind_rows(summary_table_11) %>%
  arrange(
    factor(í•™êµê¸‰, levels = c("ì´ˆë“±í•™êµ","ì¤‘í•™êµ","ê³ ë“±í•™êµ")),
    í™ë³´ì¶©ë¶„ì„± == "í•©ê³„",
    if_else(í™ë³´ì¶©ë¶„ì„± != "í•©ê³„", -n, 0)
  )

print(summary_with_total_11, n = Inf)

# í•™êµê¸‰ë³„ ì¹´ì´ì œê³± ê²€ì •
tab_school_11 <- table(dat_filtered$í•™êµê¸‰, dat_filtered$í™ë³´ì¶©ë¶„ì„±)
chisq_test_school_11 <- chisq.test(tab_school_11)
print(chisq_test_school_11)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# 5. í•™êµê¸‰ë³„ ë¶„í¬ (pct ë³€ìˆ˜ ì¶”ê°€)
summary_school_11 <- dat_filtered %>%
  group_by(í•™êµê¸‰, í™ë³´ì¶©ë¶„ì„±) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%  # ì´ ì¤„ì´ ëˆ„ë½ë˜ì—ˆì—ˆìŒ
  ungroup() %>%
  mutate(í™ë³´ì¶©ë¶„ì„± = factor(í™ë³´ì¶©ë¶„ì„±, 
                        levels = c("ë§¤ìš° ê·¸ë ‡ë‹¤", "ê·¸ë ‡ë‹¤", "ë³´í†µì´ë‹¤", 
                                 "ê·¸ë ‡ì§€ ì•Šë‹¤", "ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤")))

# 5. í•™êµê¸‰ë³„ ëˆ„ì ë§‰ëŒ€ê·¸ë˜í”„
ggplot(summary_school_11, aes(x = factor(í•™êµê¸‰, levels = c("ì´ˆë“±í•™êµ", "ì¤‘í•™êµ", "ê³ ë“±í•™êµ")), y = pct, fill = í™ë³´ì¶©ë¶„ì„±)) +
  geom_bar(stat = "identity", width = 0.7) +
  labs(
    title = "í•™êµê¸‰ë³„ í•™ìƒë§ì¶¤í†µí•©ì§€ì› í™ë³´ ì¶©ë¶„ì„±",
    x = "í•™êµê¸‰",
    y = "ë¹„ìœ¨",
    fill = "í™ë³´ì¶©ë¶„ì„±"
  ) +
  scale_y_continuous(limits = c(0, 100), expand = expansion(mult = c(0, 0.02))) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(size = 32, face = "bold", hjust = 0.5),
    axis.text.x = element_text(size = 23, margin = margin(t = 10)),
    axis.text.y = element_text(size = 23),
    axis.title.x = element_text(size = 23, angle = 0, margin = margin(t = 15)),
    axis.title.y = element_text(size = 23, angle = 0, vjust = 0.5),
    legend.position = "right",
    legend.text = element_text(size = 23),
    legend.title = element_text(size = 23, face = "bold")
  )
```

ì´ˆë“±í•™êµ(3.59), ì¤‘í•™êµ(3.54), ê³ ë“±í•™êµ(3.32) ê°„ í™ë³´ì¶©ë¶„ì„± í‰ê· ì ìˆ˜ë¥¼ ë¹„êµí•œ ê²°ê³¼, ì´ˆë“±í•™êµ-ê³ ë“±í•™êµ, ì¤‘í•™êµ-ê³ ë“±í•™êµ í•™êµê¸‰ ê°„ ì •ì±…ì¸ì‹ë„ í‰ê·  ì ìˆ˜ì—ëŠ” ìœ ì˜ë¯¸í•œ ì°¨ì´ê°€ ìˆëŠ” ê²ƒìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìœ¼ë©°, ì´ˆë“±í•™êµì™€ ì¤‘í•™êµ í‰ê· ì„¬ìˆ˜ ì°¨ì´ëŠ” ìœ ì˜ë¯¸í•˜ê²Œ ë‚˜íƒ€ë‚˜ì§€ ì•ŠìŒ (ì´ˆë“±í•™êµ \> ì¤‘í•™êµ \> ê³ ë“±í•™êµ)undefined

```{r}
#| echo: false
#| warning: false
#| message: false
school_summary_11 <- dat_filtered %>%
  mutate(í•™êµê¸‰ = factor(í•™êµê¸‰, levels = c("ì´ˆë“±í•™êµ", "ì¤‘í•™êµ", "ê³ ë“±í•™êµ"))) %>%
  group_by(í•™êµê¸‰) %>%
  summarise(
    í‰ê·  = round(mean(í™ë³´ì¶©ë¶„ì„±ì ìˆ˜, na.rm = TRUE), 2),
    í‘œì¤€í¸ì°¨ = round(sd(í™ë³´ì¶©ë¶„ì„±ì ìˆ˜, na.rm = TRUE), 2),
    n = n(),
    .groups = "drop"
  ) %>%
  arrange(í•™êµê¸‰)  # factor ìˆœì„œëŒ€ë¡œ ì •ë ¬

print(school_summary_11)

# ANOVA (í•™êµê¸‰ë³„)
anova_school_11 <- aov(í™ë³´ì¶©ë¶„ì„±ì ìˆ˜ ~ í•™êµê¸‰, data = dat_filtered)
summary(anova_school_11)

tukey_school_11 <- TukeyHSD(anova_school_11)
print(tukey_school_11)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# í•™êµê¸‰ë³„ Tukey ê·¸ë£¹ ë ˆí„° ìƒì„±
tukey_letters_school_11 <- multcompView::multcompLetters4(anova_school_11, tukey_school_11)
letters_df_school_11 <- data.frame(
  í•™êµê¸‰ = names(tukey_letters_school_11$`í•™êµê¸‰`$Letters),
  group = tukey_letters_school_11$`í•™êµê¸‰`$Letters
)

school_summary_with_groups_11 <- school_summary_11 %>%
  left_join(letters_df_school_11, by = "í•™êµê¸‰")

# í•™êµê¸‰ë³„ ë°•ìŠ¤í”Œë¡¯
ggplot(dat_filtered, aes(x = factor(í•™êµê¸‰, levels = c("ì´ˆë“±í•™êµ", "ì¤‘í•™êµ", "ê³ ë“±í•™êµ")), y = í™ë³´ì¶©ë¶„ì„±ì ìˆ˜, fill = í•™êµê¸‰)) +
  geom_boxplot(alpha = 0.7, width = 0.6, outlier.shape = 21) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 8, fill = "yellow", stroke = 1) +
  geom_text(data = school_summary_with_groups_11, 
            aes(x = í•™êµê¸‰, y = 6, label = paste0(group, "\n(M=", í‰ê· , ")"), lineheight = 0.8),
            inherit.aes = FALSE, fontface = "bold", size = 9, vjust = 0.2, lineheight =0.5) +
  labs(
    title = "í•™êµê¸‰ë³„ í™ë³´ ì¶©ë¶„ì„±",
    x = "í•™êµê¸‰", 
    y = "í™ë³´ì¶©ë¶„ì„±"
  ) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
    axis.text.x = element_text(size = 22),
    axis.text.y = element_text(size = 22),
    axis.title.x = element_text(size = 23, margin = margin(t = 15)),
    axis.title.y = element_text(size = 23, angle = 0, vjust = 0.5),
    legend.position = "none"
  ) +
  scale_y_continuous(expand = expansion(mult = c(0.05, 0.15)))
```

### ë¬¸í•­ 11-3. ì„¤ë¦½ë³„ í™ë³´ì¶©ë¶„ì„± ë¶„ì„

ì„¤ë¦½ë³„ ì‘ë‹µìëŠ” ì´ 3,090ëª…ì´ë©° ì´ ì¤‘ì—ì„œ ê³µë¦½í•™êµ ì‘ë‹µìëŠ” 2,317ëª…(74.5%), ì‚¬ë¦½í•™êµ ì‘ë‹µìëŠ” 761ëª…(25.5%)ì´ ì‘ë‹µí•˜ì˜€ìŒ

ê³µë¦½í•™êµ ì‘ë‹µê±´ìˆ˜ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 991ëª…(42.8%), ê·¸ë ‡ë‹¤ëŠ” 965ëª…(41.6%), ë³´í†µì´ë‹¤ëŠ” 310ëª…(13.4%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 41ëª…(1.8%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 10ëª…(0.4%)ì´ì—ˆìŒ

ì‚¬ë¦½í•™êµ ì‘ë‹µê±´ìˆ˜ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 224ëª…(29%), ê·¸ë ‡ë‹¤ëŠ” 375ëª…(27.8%), ë³´í†µì´ë‹¤ëŠ” 140ëª…(18.1%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 27ëª…(3.5%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 7ëª…(0.9%)ì´ì—ˆìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
# ì„¤ë¦½ë³„ ë°ì´í„° ì¤€ë¹„
dat_found_11 <- dat_filtered %>%
  filter(ì„¤ë¦½ %in% c("ê³µë¦½", "ì‚¬ë¦½")) %>%
  mutate(ì„¤ë¦½ = factor(ì„¤ë¦½, levels = c("ê³µë¦½", "ì‚¬ë¦½")))

# ì„¤ë¦½ë³„ êµì°¨í‘œ
summary_found_11 <- dat_found_11 %>%
  group_by(ì„¤ë¦½, í™ë³´ì¶©ë¶„ì„±) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

summary_found_total_11 <- summary_found_11 %>%
  group_by(ì„¤ë¦½) %>%
  summarise(n = sum(n), pct = 100, í™ë³´ì¶©ë¶„ì„± = "í•©ê³„", .groups = "drop") %>%
  bind_rows(summary_found_11) %>%
  arrange(ì„¤ë¦½, í™ë³´ì¶©ë¶„ì„± == "í•©ê³„", desc(n))

print(summary_found_total_11, n = Inf)

# ì„¤ë¦½ë³„ ì¹´ì´ì œê³± ê²€ì •
tab_found_11 <- table(dat_found_11$ì„¤ë¦½, dat_found_11$í™ë³´ì¶©ë¶„ì„±)
chisq_test_found_11 <- chisq.test(tab_found_11)
print(chisq_test_found_11)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# ì„¤ë¦½ë³„ ëˆ„ì ë§‰ëŒ€ê·¸ë˜í”„
summary_found_plot_11 <- summary_found_11 %>%
  mutate(í™ë³´ì¶©ë¶„ì„± = factor(í™ë³´ì¶©ë¶„ì„±, 
                        levels = c("ë§¤ìš° ê·¸ë ‡ë‹¤", "ê·¸ë ‡ë‹¤", "ë³´í†µì´ë‹¤", 
                                 "ê·¸ë ‡ì§€ ì•Šë‹¤", "ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤")))

ggplot(summary_found_plot_11, aes(x = ì„¤ë¦½, y = pct, fill = í™ë³´ì¶©ë¶„ì„±)) +
  geom_bar(stat = "identity", width = 0.7) +
  labs(
    title = "ì„¤ë¦½ë³„ í•™ìƒë§ì¶¤í†µí•©ì§€ì› í™ë³´ ì¶©ë¶„ì„±",
    x = "ì„¤ë¦½",
    y = "ë¹„ìœ¨",
    fill = "í™ë³´ì¶©ë¶„ì„±"
  ) +
  scale_y_continuous(limits = c(0, 100), expand = expansion(mult = c(0, 0.02))) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(size = 32, face = "bold", hjust = 0.5),
    axis.text.x = element_text(size = 20, margin = margin(t = 10)),
    axis.text.y = element_text(size = 20),
    axis.title.x = element_text(size = 20, angle = 0, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),
    legend.position = "right",
    legend.text = element_text(size = 20),
    legend.title = element_text(size = 20, face = "bold")
  )
```

ê³µë¦½í•™êµ(3.55), ì‚¬ë¦½í•™êµ(3.4) ê°„ í™ë³´ì¶©ë¶„ì„± í‰ê· ì ìˆ˜ë¥¼ ë¹„êµí•œ ê²°ê³¼, ê³µë¦½í•™êµì™€ ì‚¬ë¦½í•™êµ ê°„ì—ëŠ” ì •ì±…ì¸ì‹ë„ í‰ê·  ì ìˆ˜ì—ëŠ” ìœ ì˜ë¯¸í•œ ì°¨ì´ê°€ ìˆëŠ” ê²ƒìœ¼ë¡œ ë‚˜íƒ€ë‚¨

```{r}
#| echo: false
#| warning: false
#| message: false
# T-test ë¶„ì„ì„ ìœ„í•œ ê¸°ìˆ í†µê³„
summary_found_stats_11 <- dat_found_11 %>%
  group_by(ì„¤ë¦½) %>%
  summarise(
    í‰ê·  = round(mean(í™ë³´ì¶©ë¶„ì„±ì ìˆ˜, na.rm = TRUE), 2),
    í‘œì¤€í¸ì°¨ = round(sd(í™ë³´ì¶©ë¶„ì„±ì ìˆ˜, na.rm = TRUE), 2),
    n = n(),
    .groups = "drop"
  )

print(summary_found_stats_11)

# ì •ê·œì„± ê²€ì •
normality_test_11 <- dat_found_11 %>%
  group_by(ì„¤ë¦½) %>%
  summarise(
    shapiro_p = shapiro.test(í™ë³´ì¶©ë¶„ì„±ì ìˆ˜)$p.value,
    .groups = "drop"
  )

print(normality_test_11)

# T-test
t_test_result_11 <- t.test(í™ë³´ì¶©ë¶„ì„±ì ìˆ˜ ~ ì„¤ë¦½, data = dat_found_11, var.equal = FALSE)
print(t_test_result_11)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# ì„¤ë¦½ë³„ ë°•ìŠ¤í”Œë¡¯
# â”€â”€ 3) t-test ê²°ê³¼ë¡œ 'ê°€ì§œ Tukey' ë ˆí„° ë§Œë“¤ê¸° (a/b ë˜ëŠ” a/a)
tukey_letters_school_11 <- list(
  `ì„¤ë¦½` = list(
    Letters = setNames(
      if (t_test_result_11$p.value < 0.05) c("a","b") else c("a","a"),
      c("ê³µë¦½","ì‚¬ë¦½")
    )
  )
)

# â”€â”€ 4) ê¸°ìˆ í†µê³„ì™€ ë ˆí„° ê²°í•© (í”Œë¡¯ì— ì“¸ í‘œ)
school_summary_final_11 <- summary_found_stats_11 %>%
  dplyr::left_join(
    data.frame(
      ì„¤ë¦½ = names(tukey_letters_school_11$`ì„¤ë¦½`$Letters),
      group = unname(tukey_letters_school_11$`ì„¤ë¦½`$Letters)
    ),
    by = "ì„¤ë¦½"
  )

# â”€â”€ 5) ë°•ìŠ¤í”Œë¡¯ + ë ˆí„°/í‰ê·  í‘œì‹(ìë™ yì¢Œí‘œ)
y_top_estab_11 <- max(dat_found_11$í™ë³´ì¶©ë¶„ì„±ì ìˆ˜, na.rm = TRUE) + 0.25

ggplot(dat_found_11, aes(x = ì„¤ë¦½, y = í™ë³´ì¶©ë¶„ì„±ì ìˆ˜, fill = ì„¤ë¦½)) +
  geom_boxplot(alpha = 0.7, width = 0.6, outlier.shape = 21) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 4,
               fill = "yellow", stroke = 1) +
  geom_text(data = school_summary_final_11,
            aes(x = ì„¤ë¦½, y = y_top_estab_11,
                label = paste0(group, "\n(M=", í‰ê· , ")"), lineheight =0.5),
            inherit.aes = FALSE, fontface = "bold", size = 9, vjust = 0) +
  labs(title = "ì„¤ë¦½ë³„ í™ë³´ì¶©ë¶„ì„±",
       x = "ì„¤ë¦½", y = "í™ë³´ì¶©ë¶„ì„±") +
  theme_minimal(base_size = 15) +
  theme(plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
        axis.text.x = element_text(size = 22),
        axis.text.y = element_text(size = 22),
        axis.title.x = element_text(size = 22, margin = margin(t = 15)),
        axis.title.y = element_text(size = 22, angle = 0, vjust = 0.5),
        legend.position = "none") +
  scale_y_continuous(limits = c(min(dat_found_11$í™ë³´ì¶©ë¶„ì„±ì ìˆ˜, na.rm = TRUE),
                                y_top_estab_11 + 0.1),
                     expand = expansion(mult = c(0.05, 0.15)))
```

# 4. ì‹¤íƒœì¡°ì‚¬ (í•™ìƒë§ì¶¤í†µí•©ì§€ì› ìš´ì˜í˜„í™© ì¡°ì‚¬)

## \* ì‘ë‹µì ì„ ì •ì— ê´€í•­

ìš´ì˜ í˜„í™©ì¡°ì‚¬ ë¬¸í•­ë“¤ì€ ì¤‘ë³µì‘ë‹µì„ ë°©ì§€í•˜ê¸° ìœ„í•´ í•™êµë³„ 1ëª…ì”©ë§Œ ì‘ë‹µìë¥¼ ì„ ë³„í•¨. ì‘ë‹µìëŠ” êµê°ì„ ìš°ì„  ì„ ë³„í•˜ê³ , ë‹¤ìŒìœ¼ë¡œ í•™êµì¥, êµì‚¬ ë“± ìˆœìœ¼ë¡œ í•™êµë³„ ì‘ë‹µìë¥¼ ì¶”ì¶œí•˜ì˜€ìŒ.

### ë¬¸í•­12. í•™êµ ë‚´ì— í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ì´ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆê¹Œ?

â‘  ê·¸ë ‡ë‹¤ â‘¡ ì•„ë‹ˆë‹¤

í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ êµ¬ì„±ì—¬ë¶€ ë¬¸í•­ì— ëŒ€í•œ ì‘ë‹µìëŠ” ì´ 1,155ëª…ì´ë©° ì´ˆë“±í•™êµ ì‘ë‹µìëŠ” 518ëª…(44.8%), ì¤‘í•™êµ ì‘ë‹µìëŠ” 347ëª…(30%), ê³ ë“±í•™êµ ì‘ë‹µìëŠ” 264ëª…(22.9%), íŠ¹ìˆ˜í•™êµ ì‘ë‹µìëŠ” 17ëª…(1.5%), ê°ì¢…í•™êµ ì‘ë‹µìëŠ” 9ëª…(0.8%)ì´ì—ˆìŒ

ì´ˆë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ì´ êµ¬ì„±ë˜ì–´ ìˆë‹¤ëŠ” ì‘ë‹µì€ 472ëª…(91.1%), êµ¬ì„±ë˜ì–´ ìˆì§€ ì•Šë‹¤ëŠ” 46ëª…(8.9%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ì¤‘í•™êµ ì‘ë‹µì ì¤‘ì—ì„œ í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ì´ êµ¬ì„±ë˜ì–´ ìˆë‹¤ëŠ” ì‘ë‹µì€ 311ëª…(89.6%), êµ¬ì„±ë˜ì–´ ìˆì§€ ì•Šë‹¤ëŠ” 36ëª…(10.4%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê³ ë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ì´ êµ¬ì„±ë˜ì–´ ìˆë‹¤ëŠ” ì‘ë‹µì€ 208ëª…(78.8%), êµ¬ì„±ë˜ì–´ ìˆì§€ ì•Šë‹¤ëŠ” 56ëª…(21.2%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

íŠ¹ìˆ˜í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ì´ êµ¬ì„±ë˜ì–´ ìˆë‹¤ëŠ” ì‘ë‹µì€ 12ëª…(70.6%), êµ¬ì„±ë˜ì–´ ìˆì§€ ì•Šë‹¤ëŠ” 5ëª…(29.4%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê°ì¢…í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ì´ êµ¬ì„±ë˜ì–´ ìˆë‹¤ëŠ” ì‘ë‹µì€ 5ëª…(55.6%), êµ¬ì„±ë˜ì–´ ìˆì§€ ì•Šë‹¤ëŠ” 4ëª…(44.4%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
dat_trimed <- dat %>%
  filter(!is.na(ques_12)) %>%   # 12ë²ˆ ë¬¸í•­ ì‘ë‹µë§Œ ì¶”ì¶œ
  # ìš°ì„ ìˆœìœ„ ì»¬ëŸ¼ ìƒì„±
  mutate(
    ìš°ì„ ìˆœìœ„ = case_when(
      ques_7 == "2" ~ 1,
      ques_7 == "1" ~ 2,
      ques_7 == "3" ~ 3,
      ques_7 == "4" ~ 4,
      ques_7 == "8" ~ 5,
      ques_7 == "9" ~ 6,
      ques_7 == "5" ~ 7,
      TRUE ~ 8
    )
  ) %>%
  group_by(í•™êµì•„ì´ë””) %>%   # âš  í•™êµ ì‹ë³„ ì»¬ëŸ¼ëª…ìœ¼ë¡œ ë³€ê²½ í•„ìš”
  arrange(ìš°ì„ ìˆœìœ„) %>%  # ìš°ì„ ìˆœìœ„ ë‚®ì€ ê°’(êµê°) ë¨¼ì €
  slice(1) %>%           # ìµœì¢…ì ìœ¼ë¡œ 1ëª…ë§Œ ì„ íƒ
  ungroup() %>%
  mutate(
    í•™êµê¸‰ = recode(as.character(ques_1),
                 "1" = "ì´ˆë“±í•™êµ",
                 "2" = "ì¤‘í•™êµ",
                 "3" = "ê³ ë“±í•™êµ",
                 "4" = "íŠ¹ìˆ˜í•™êµ",
                 "5" = "ê°ì¢…í•™êµ"),
    ë¬¸í•­12 = factor(
      ques_12,
      levels = 1:2,
      labels = c("êµ¬ì„±ë˜ì–´ ìˆë‹¤", "êµ¬ì„±ë˜ì–´ ìˆì§€ ì•Šë‹¤")
    ),
    í•™êµê¸‰ = factor(í•™êµê¸‰, 
                 levels = c("ì´ˆë“±í•™êµ","ì¤‘í•™êµ","ê³ ë“±í•™êµ","íŠ¹ìˆ˜í•™êµ","ê°ì¢…í•™êµ"))
  )
dat_q12 <- dat_trimed
summary_q12 <- dat_q12 %>%
  group_by(í•™êµê¸‰, ë¬¸í•­12) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  arrange(desc(n)) %>%
  ungroup()
# í•©ê³„ ì¶”ê°€
summary_q12_total <- summary_q12 %>%
  group_by(í•™êµê¸‰) %>%
  summarise(n = sum(n), pct = 100, ë¬¸í•­12 = "í•©ê³„", .groups = "drop") %>%
  bind_rows(summary_q12) %>%
  mutate(ë¬¸í•­12 = factor(ë¬¸í•­12, levels = c("êµ¬ì„±ë˜ì–´ ìˆë‹¤","êµ¬ì„±ë˜ì–´ ìˆì§€ ì•Šë‹¤","í•©ê³„"))) %>%
  arrange(factor(í•™êµê¸‰, 
                 levels=c("ì´ˆë“±í•™êµ","ì¤‘í•™êµ","ê³ ë“±í•™êµ","íŠ¹ìˆ˜í•™êµ","ê°ì¢…í•™êµ")),
          if_else(ë¬¸í•­12=="í•©ê³„", 2, 1),  # í•©ê³„ë¥¼ ë§ˆì§€ë§‰ìœ¼ë¡œ
          desc(n))
print(summary_q12_total, n = Inf)
```

```{r}
#| echo: false
#| warning: false
#| message: false
ggplot(summary_q12 %>% filter(ë¬¸í•­12 != "í•©ê³„"), aes(x = ë¬¸í•­12, y = n, fill = ë¬¸í•­12)) +
  geom_bar(stat="identity", width=0.7) +
  geom_text(aes(label = paste0(n,"ëª…\n(",pct,"%)")), 
            vjust=-0.2, size=6.5, lineheight = 0.5, fontface="bold") +
  facet_wrap(~í•™êµê¸‰, ncol = 3, nrow = 2) +  # 2í–‰ 3ì—´ ë°°ì¹˜
  labs(
    title = "í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€\nêµ¬ì„± ì—¬ë¶€(í•™êµê¸‰ë³„)",
    x = "êµ¬ì„±ì—¬ë¶€",
    y = "ì‘ë‹µìˆ˜"
  ) +
  scale_x_discrete(labels = c("êµ¬ì„±ë˜ì–´\nìˆë‹¤", "êµ¬ì„±ë˜ì–´\nìˆì§€ ì•Šë‹¤")) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face="bold", size=24, hjust=0.5, margin = margin(b = 18)),
    legend.position = "none",
    axis.text.x = element_text(angle=0, hjust=0.5, size=15, lineheight=0.5),
    axis.text.y = element_text(size=13),
    axis.title.x = element_text(size=15, margin = margin(t = 12)),
    axis.title.y = element_text(angle = 0, vjust = 0.5, size=15),
    strip.text = element_text(face="bold", size=18, margin = margin(t = 6, b = 6)),
    panel.spacing = unit(1.2, "lines"),  # íŒ¨ë„ ê°„ê²© ì¡°ê¸ˆ ì¦ê°€
    plot.margin = margin(18, 18, 18, 18)
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.4))) +
  coord_cartesian(clip = "off")
```

### ë¬¸í•­13. í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ì´ êµ¬ì„±ë°©ë²•ì€?

â‘  ê¸°ì¡´ ìœ„ì›íšŒ í™œìš© â‘¡ ë³„ë„ë¡œ íŒ€ì„ êµ¬ì„±í•˜ì—¬ ìš´ì˜

í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ êµ¬ì„±ë°©ë²•ì— ëŒ€í•œ ì‘ë‹µìëŠ” ì´ 1,001ëª…ì´ë©° ì´ˆë“±í•™êµ ì‘ë‹µìëŠ” 472ëª…(47.15%), ì¤‘í•™êµ ì‘ë‹µìëŠ” 311ëª…(31.07%), ê³ ë“±í•™êµ ì‘ë‹µìëŠ” 208ëª…(20.78%), íŠ¹ìˆ˜í•™êµ ì‘ë‹µìëŠ” 5ëª…(0.5%), ê°ì¢…í•™êµ ì‘ë‹µìëŠ” 5ëª…(0.5%)ì´ì—ˆìŒ

ì´ˆë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ê¸°ì¡´ ìœ„ì›íšŒë¥¼ í™œìš©í•œë‹¤ëŠ” ì‘ë‹µìëŠ” 275ëª…(58.3%), ë³„ë„ë¡œ íŒ€ì„ êµ¬ì„±í•˜ì—¬ ìš´ì˜í•œë‹¤ëŠ” ì‘ë‹µìëŠ” 197ëª…(41.7%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ì¤‘í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ê¸°ì¡´ ìœ„ì›íšŒë¥¼ í™œìš©í•œë‹¤ëŠ” ì‘ë‹µìëŠ” 210ëª…(67.5%), ë³„ë„ë¡œ íŒ€ì„ êµ¬ì„±í•˜ì—¬ ìš´ì˜í•œë‹¤ëŠ” ì‘ë‹µìëŠ” 101ëª…(32.5%)ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê³ ë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ê¸°ì¡´ ìœ„ì›íšŒë¥¼ í™œìš©í•œë‹¤ëŠ” ì‘ë‹µìëŠ” 129ëª…(62%), ë³„ë„ë¡œ íŒ€ì„ êµ¬ì„±í•˜ì—¬ ìš´ì˜í•œë‹¤ëŠ” ì‘ë‹µìëŠ” 79ëª…(38%)ìœ¼ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

íŠ¹ìˆ˜í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ê¸°ì¡´ ìœ„ì›íšŒ í™œìš©ì€ 5ëª…(100%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê°ì¢…í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ê¸°ì¡´ ìœ„ì›íšŒ í™œìš©ì€ 5ëª…(100%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
dat_q13 <- dat_trimed %>%
  filter(ques_12 != 2, !is.na(ques_13)) %>%   # 12ë²ˆ ì‘ë‹µì ì œì™¸ & ê²°ì¸¡ ì œê±°
  mutate(ë¬¸í•­13 = factor(
      ques_13,
      levels = 1:2,
      labels = c("ê¸°ì¡´ ìœ„ì›íšŒ í™œìš©","ë³„ë„ë¡œ íŒ€ì„ êµ¬ì„±í•˜ì—¬ ìš´ì˜")
    )
  )
summary_q13 <- dat_q13 %>%
  group_by(í•™êµê¸‰, ë¬¸í•­13) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()
# í•©ê³„ ì¶”ê°€ (í•™êµê¸‰ë³„)
summary_q13_total <- summary_q13 %>%
  group_by(í•™êµê¸‰) %>%
  summarise(
    n = sum(n),
    pct = 100,
    ë¬¸í•­13 = "í•©ê³„",
    .groups = "drop"
  ) %>%
  bind_rows(summary_q13) %>%
  arrange(
    factor(í•™êµê¸‰, levels = c("ì´ˆë“±í•™êµ","ì¤‘í•™êµ","ê³ ë“±í•™êµ","íŠ¹ìˆ˜í•™êµ","ê°ì¢…í•™êµ")),
    if_else(ë¬¸í•­13 == "í•©ê³„", 2, 1),
    desc(n)
  )
print(summary_q13_total, n = Inf)
```

```{r}
#| echo: false
#| warning: false
#| message: false
ggplot(summary_q13, aes(x = ë¬¸í•­13, y = n, fill = ë¬¸í•­13)) +
  geom_bar(stat="identity", width=0.7) +
  geom_text(aes(label = paste0(n,"ëª…\n(",pct,"%)")), 
            vjust=-0.2, size=6, fontface="bold", lineheight =0.6) +
  facet_wrap(~í•™êµê¸‰, ncol = 3, nrow = 2) +  # 2í–‰ 3ì—´ ë°°ì¹˜
  labs(
    title = "í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€\n êµ¬ì„± ë°©ë²•(í•™êµê¸‰ë³„)",
    x = "êµ¬ì„±ë°©ë²•",
    y = "ì‘ë‹µìˆ˜"
  ) +
  scale_x_discrete(labels = c("ê¸°ì¡´ ìœ„ì›íšŒ\ní™œìš©", "ë³„ë„ë¡œ íŒ€ì„\nêµ¬ì„±í•˜ì—¬ ìš´ì˜")) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face="bold", size=32, hjust=0.5, margin = margin(b = 18), lineheight = 0.5),
    legend.position = "none",
    axis.text.x = element_text(size= 16, angle=0, hjust=0.5, lineheight=0.5),
    axis.text.y = element_text(size=16),
    axis.title.x = element_text(size=18, margin = margin(t = 12)),
    axis.title.y = element_text(angle = 0, vjust = 0.5, size=18),
    strip.text = element_text(face="bold", size=18, margin = margin(t = 6, b = 6)),
    panel.spacing = unit(1.2, "lines"),  # íŒ¨ë„ ê°„ê²© ì¡°ê¸ˆ ì¦ê°€
    plot.margin = margin(18, 18, 18, 18)
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.4))) +
  coord_cartesian(clip = "off")
```

### ë¬¸í•­14.\[13ë²ˆ ë¬¸í•­ì— â‘ ë¡œ ë‹µë³€í•œ ê²½ìš°ë§Œ ì‘ë‹µ\] ê¸°ì¡´ ìœ„ì›íšŒë¥¼ í™œìš©í•œ ê²½ìš°ëŠ” ì–´ë–¤ ìœ„ì›íšŒë¥¼ ì£¼ë¡œ í™œìš©í•˜ì˜€ìŠµë‹ˆê¹Œ? (ì¤‘ë³µì‘ë‹µ)

â‘  êµìœ¡ë³µì§€ìœ„ì›íšŒ(êµìœ¡ë³µì§€í†µí•©ì§€ì›íŒ€) â‘¡ ìƒëª…ì¡´ì¤‘ìœ„ì›íšŒ(ìœ„ê¸°ê´€ë¦¬ìœ„ì›íšŒ) â‘¢ í•™ìŠµì§€ì›ëŒ€ìƒí•™ìƒì§€ì›í˜‘ì˜íšŒ â‘£ ê¸°íƒ€

ê¸°ì¡´ìœ„ì›íšŒë¥¼ í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ìœ¼ë¡œ í™œìš©í•œë‹¤ëŠ” ì‘ë‹µê±´ìˆ˜ëŠ” 744ëª…ì´ë©° ì´ˆë“±í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 309ê±´(41.5%), ì¤‘í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 241ê±´(32.4%), ê³ ë“±í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 173ê±´(23.3%), íŠ¹ìˆ˜í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 13ê±´(1.7%), ê°ì¢…í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 8ê±´(1.1%)ì´ì—ˆìŒ

ì´ˆë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ êµìœ¡ë³µì§€ìœ„ì›íšŒë¥¼ í™œìš©í•œë‹¤ëŠ” ì‘ë‹µê±´ìˆ˜ëŠ” 223ê±´(72.2%), ìƒëª…ì¡´ì¤‘ìœ„ì›íšŒë¥¼ í™œìš©í•œë‹¤ëŠ” ì‘ë‹µê±´ìˆ˜ëŠ” 46ê±´(14.9%), í•™ê¸‰ì§€ì›ëŒ€ìƒ í•™ìƒì§€ì›í˜‘ì˜íšŒë¥¼ í™œìš©í•œë‹¤ëŠ” ì‘ë‹µê±´ìˆ˜ëŠ”21ê±´(6.8%), ê¸°íƒ€ëŠ” 19ê±´(6.1%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ì¤‘í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ êµìœ¡ë³µì§€ìœ„ì›íšŒë¥¼ í™œìš©í•œë‹¤ëŠ” ì‘ë‹µê±´ìˆ˜ëŠ” 155ê±´(64.3%), ìƒëª…ì¡´ì¤‘ìœ„ì›íšŒë¥¼ í™œìš©í•œë‹¤ëŠ” ì‘ë‹µê±´ìˆ˜ëŠ” 59ê±´(24.5%), í•™ê¸‰ì§€ì›ëŒ€ìƒ í•™ìƒì§€ì›í˜‘ì˜íšŒë¥¼ í™œìš©í•œë‹¤ëŠ” ì‘ë‹µê±´ìˆ˜ëŠ” 12ê±´(5%), ê¸°íƒ€ëŠ” 15ê±´(6.2%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê³ ë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ êµìœ¡ë³µì§€ìœ„ì›íšŒë¥¼ í™œìš©í•œë‹¤ëŠ” ì‘ë‹µê±´ìˆ˜ëŠ” 105ê±´(60.7%), ìƒëª…ì¡´ì¤‘ìœ„ì›íšŒë¥¼ í™œìš©í•œë‹¤ëŠ” ì‘ë‹µê±´ìˆ˜ëŠ” 54ê±´(31.2%), í•™ê¸‰ì§€ì›ëŒ€ìƒ í•™ìƒì§€ì›í˜‘ì˜íšŒë¥¼ í™œìš©í•œë‹¤ëŠ” ì‘ë‹µê±´ìˆ˜ëŠ” 5ê±´(2.9%), ê¸°íƒ€ëŠ” 9ê±´(5.2%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

íŠ¹ìˆ˜í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ êµìœ¡ë³µì§€ìœ„ì›íšŒë¥¼ í™œìš©í•œë‹¤ëŠ” ì‘ë‹µê±´ìˆ˜ëŠ” 1ê±´(7.7%), ìƒëª…ì¡´ì¤‘ìœ„ì›íšŒë¥¼ í™œìš©í•œë‹¤ëŠ” ì‘ë‹µê±´ìˆ˜ëŠ” 7ê±´(53.8%), ê¸°íƒ€ëŠ” 5ê±´(38.5%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê°ì¢…í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ êµìœ¡ë³µì§€ìœ„ì›íšŒë¥¼ í™œìš©í•œë‹¤ëŠ” ì‘ë‹µê±´ìˆ˜ëŠ” 2ê±´(25%), ìƒëª…ì¡´ì¤‘ìœ„ì›íšŒë¥¼ í™œìš©í•œë‹¤ëŠ” ì‘ë‹µê±´ìˆ˜ëŠ” 2ê±´(25%), í•™ê¸‰ì§€ì›ëŒ€ìƒ í•™ìƒì§€ì›í˜‘ì˜íšŒë¥¼ í™œìš©í•œë‹¤ëŠ” ì‘ë‹µê±´ìˆ˜ëŠ” 2ê±´(25%), ê¸°íƒ€ëŠ” 2ê±´(25%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
dat_q14 <- dat_trimed %>%
  filter(ques_13 == 1) %>%   # 2ë²ˆ ì‘ë‹µì ì œì™¸ & ê²°ì¸¡ ì œê±°
  mutate(
    ë¬¸í•­14 = factor(
      ques_14,
      levels = 1:4,
      labels = c("êµìœ¡ë³µì§€ìœ„ì›íšŒ","ìƒëª…ì¡´ì¤‘ìœ„ì›íšŒ", "í•™ê¸‰ì§€ì›ëŒ€ìƒí•™ìƒì§€ì›í˜‘ì˜íšŒ","ê¸°íƒ€")
    )
  )

summary_q14 <- dat_q14 %>%
  group_by(í•™êµê¸‰, ë¬¸í•­14) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1))%>%
  arrange(desc(n)) %>% 
  ungroup()

summary_q14_total <- summary_q14 %>%
  group_by(í•™êµê¸‰) %>%
  summarise(
    n = sum(n),
    pct = 100,
    ë¬¸í•­14 = "í•©ê³„",
    .groups = "drop"
  ) %>%
  bind_rows(summary_q14) %>%
  arrange(
    factor(í•™êµê¸‰, levels = c("ì´ˆë“±í•™êµ","ì¤‘í•™êµ","ê³ ë“±í•™êµ","íŠ¹ìˆ˜í•™êµ","ê°ì¢…í•™êµ")),
    if_else(ë¬¸í•­14 == "í•©ê³„", 2, 1),
    desc(n)
  )

print(summary_q14_total, n = Inf)
```

```{r}
#| echo: false
#| warning: false
#| message: false
ggplot(summary_q14, aes(x = ë¬¸í•­14, y = n, fill = ë¬¸í•­14)) +
  geom_bar(stat="identity", width=0.7) +
  geom_text(aes(label = paste0(n,"ê±´\n(",pct,"%)")), 
            vjust= -0.25, size=4.5, fontface="bold", lineheight=0.5) +
  facet_wrap(~í•™êµê¸‰, ncol = 3, nrow = 2) +  # 2í–‰ 3ì—´ ë°°ì¹˜
  labs(
    title = "í™œìš©í•˜ëŠ” ê¸°ì¡´ ìœ„ì›íšŒ",
    x = "ìœ„ì›íšŒ ìœ í˜•",
    y = "ì‘ë‹µìˆ˜"
  ) +
  scale_x_discrete(labels = c("êµìœ¡\në³µì§€\nìœ„ì›íšŒ", "ìƒëª…\nì¡´ì¤‘\nìœ„ì›íšŒ", "í•™ê¸‰ì§€ì›\nëŒ€ìƒí•™ìƒ\nì§€ì›\ní˜‘ì˜íšŒ", "ê¸°íƒ€")) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face="bold", size=32, hjust=0.5, margin = margin(b = 18)),
    legend.position = "none",
    axis.text.x = element_text(angle=0, hjust=0.5, size=16, lineheight=0.5),
    axis.text.y = element_text(size=16),
    axis.title.x = element_text(size=20, margin = margin(t = 12)),
    axis.title.y = element_text(angle = 0, vjust = 0.5, size=20),
    strip.text = element_text(face="bold", size=20, margin = margin(t = 6, b = 6)),
    panel.spacing = unit(1.2, "lines"),  # íŒ¨ë„ ê°„ê²© ì¡°ê¸ˆ ì¦ê°€
    plot.margin = margin(18, 18, 18, 18)
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.4))) +
  coord_cartesian(clip = "off")
```

### ë¬¸í•­15.í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ êµ¬ì„±ì›ì€ ëˆ„êµ¬ì…ë‹ˆê¹Œ? (ì¤‘ë³µì‘ë‹µ)

â‘  êµì¥ â‘¡ êµê° â‘¢ ë‹´ë‹¹ë¶€ì¥êµì‚¬ ë˜ëŠ” ë‹´ë‹¹ì—…ë¬´êµì‚¬ â‘£ ë‹´ì„êµì‚¬ â‘¤ ìƒë‹´êµì‚¬ â‘¥ ë³´ê±´êµì‚¬ â‘¦ ì˜ì–‘êµì‚¬ â‘§ ì§€ì—­ì‚¬íšŒêµìœ¡ì „ë¬¸ê°€ â‘¨ ìƒë‹´ì‚¬ â‘© í–‰ì •ì‹¤ì¥ â‘ª ê¸°íƒ€

í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ êµ¬ì„±ì›ì— ëŒ€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 6,135ê±´ì´ë©° ì´ˆë“±í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 2,759ê±´(45%), ì¤‘í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 1,933ê±´(31.5%), ê³ ë“±í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 1,323ê±´(21.6%), íŠ¹ìˆ˜í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 77ê±´(1.3%), ê°ì¢…í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 43ê±´(0.7%)ì´ì—ˆìŒ

ì´ˆë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ ì£¼ìš” êµ¬ì„±ì› ë¬¸í•­ì— êµê°ì€ 507ê±´(18.4%), ë‹´ë‹¹ë¶€ì¥ ë˜ëŠ” ë‹´ë‹¹êµì‚¬ëŠ” 507ê±´(18.4%), ë³´ê±´êµì‚¬ëŠ” 349ê±´(12.8%), ë‹´ì„êµì‚¬ëŠ” 349ê±´(12.6%), êµì¥ì€ 303ê±´(11%), ìƒë‹´êµì‚¬ëŠ” 268ê±´(9.7%), ì§€ì—­ì‚¬íšŒêµìœ¡ì „ë¬¸ê°€ëŠ” 183ê±´(6.6%), ìƒë‹´ì‚¬ëŠ” 169ê±´(6.1%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ì¤‘í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ ì£¼ìš” êµ¬ì„±ì› ë¬¸í•­ì— ë‹´ë‹¹ë¶€ì¥ ë˜ëŠ” ë‹´ë‹¹êµì‚¬ëŠ” 341ê±´(17.6%), êµê°ì€ 336ê±´(17.4%), ë³´ê±´êµì‚¬ëŠ” 249ê±´(12.9%), ìƒë‹´êµì‚¬ëŠ” 245ê±´(12.7%), ë‹´ì„êµì‚¬ëŠ” 199ê±´(10.3%), êµì¥ì€ 186ê±´(9.6%), ì§€ì—­ì‚¬íšŒêµìœ¡ì „ë¬¸ê°€ëŠ” 146ê±´(7.6%), ìƒë‹´ì‚¬ëŠ” 133ê±´(6.9%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê³ ë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ ì£¼ìš” êµ¬ì„±ì› ë¬¸í•­ì— êµê°ì€ 258ê±´(19.5%), ë‹´ë‹¹ë¶€ì¥ ë˜ëŠ” ë‹´ë‹¹êµì‚¬ëŠ” 257ê±´(19.4%), ìƒë‹´êµì‚¬ëŠ” 205ê±´(15.5%), ë³´ê±´êµì‚¬ëŠ” 172ê±´(13%), ë‹´ì„êµì‚¬ëŠ” 151ê±´(11.4%), êµì¥ì€ 108ê±´(8.2%), ìƒë‹´ì‚¬ëŠ” 55ê±´(4.2%), ì§€ì—­ì‚¬íšŒêµìœ¡ì „ë¬¸ê°€ëŠ” 43ê±´(3.3%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

íŠ¹ìˆ˜í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ ì£¼ìš” êµ¬ì„±ì› ë¬¸í•­ì— êµê°ì€ 15ê±´(19.5%), ë‹´ë‹¹ë¶€ì¥ ë˜ëŠ” ë‹´ë‹¹êµì‚¬ëŠ” 15ê±´(19.5%), ë‹´ì„êµì‚¬ëŠ” 12ê±´(15.6%), ë³´ê±´êµì‚¬ëŠ” 11ê±´(14.3%), êµì¥ì€ 10ê±´(13%), êµì¥ì€ 10ê±´(13%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê°ì¢…í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ ì£¼ìš” êµ¬ì„±ì› ë¬¸í•­ì— ë‹´ë‹¹ë¶€ì¥ ë˜ëŠ” ë‹´ë‹¹êµì‚¬ëŠ” 9ê±´(20.9%), êµê°ì€ 8ê±´(18.6%), ë³´ê±´êµì‚¬ëŠ” 6ê±´(14%), ìƒë‹´êµì‚¬ëŠ” 5ê±´(11.6%), í–‰ì •ì‹¤ì¥ì€ 5ê±´(11.6%), êµì¥ì€ 4ê±´(9.3%), ë‹´ì„êµì‚¬ëŠ” 4ê±´(9.3%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
# ë¬¸í•­15 ë°ì´í„° ì²˜ë¦¬ 
dat_q15_long <- dat_trimed %>%  
  filter(!is.na(ques_15)) %>%
  separate_rows(ques_15, sep = ",\\s*") %>%
  mutate(
    ques_15 = str_trim(as.character(ques_15)),
    ë¬¸í•­15 = recode(ques_15,
                   "1" = "êµì¥",
                   "2" = "êµê°",
                   "3" = "ë‹´ë‹¹ë¶€ì¥ ë˜ëŠ” ë‹´ë‹¹êµì‚¬",
                   "4" = "ë‹´ì„êµì‚¬",
                   "5" = "ìƒë‹´êµì‚¬",
                   "6" = "ë³´ê±´êµì‚¬",
                   "7" = "ì˜ì–‘êµì‚¬",
                   "8" = "ì§€ì—­ì‚¬íšŒêµìœ¡ì „ë¬¸ê°€",
                   "9" = "ìƒë‹´ì‚¬",
                   "10" = "í–‰ì •ì‹¤ì¥",
                   "11" = "ê¸°íƒ€",
                   .default = "ê¸°íƒ€")
  )

# ê¸°ìˆ í†µê³„
summary_q15 <- dat_q15_long %>%
  group_by(í•™êµê¸‰, ë¬¸í•­15) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

# í•©ê³„ ì¶”ê°€
summary_q15_total <- summary_q15 %>%
  group_by(í•™êµê¸‰) %>%
  summarise(n = sum(n), pct = 100, ë¬¸í•­15 = "í•©ê³„", .groups = "drop") %>%
  bind_rows(summary_q15) %>%
  arrange(í•™êµê¸‰,
          if_else(ë¬¸í•­15 == "í•©ê³„", 2, 1),
          desc(n))

print(summary_q15_total, n = Inf)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# ì „ì²´ ë°ì´í„°ì— ëŒ€í•œ ê¸°ìˆ í†µê³„ ìƒì„± 
ggplot(summary_q15 %>% filter(ë¬¸í•­15 != "í•©ê³„"), aes(x = n, y = reorder(ë¬¸í•­15, n), fill = ë¬¸í•­15)) +
  geom_bar(stat = "identity", width = 0.6) +
  geom_text(aes(label = paste0(n, "ê±´ (", pct, "%)")), hjust = -0.1, size = 5) +  # size ì¤„ì„
  facet_wrap(~í•™êµê¸‰, ncol = 2, nrow = 3) +  # 5í–‰ 1ì—´
  labs(
    title = "í•™êµê¸‰ë³„ í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ êµ¬ì„±ì› í˜„í™©",
    x = "ì‘ë‹µìˆ˜",
    y = "êµ¬ì„±ì›",
    fill = "êµ¬ì„±ì›"
  ) +
  theme_minimal(base_size = 12) +  # base_size ì¤„ì„
  theme(
    plot.title = element_text(size = 28, face = "bold", hjust = 0.5, margin = margin(b = 18)),
    axis.text.x = element_text(size = 14, margin = margin(t = 8)),
    axis.text.y = element_text(size = 12),  # yì¶• í…ìŠ¤íŠ¸ í¬ê¸° ì¤„ì„
    axis.title.x = element_text(size = 16, angle = 0, margin = margin(t = 12)),
    axis.title.y = element_text(size = 16, angle = 0, vjust = 0.5),
    strip.text = element_text(face = "bold", size = 14, margin = margin(t = 6, b = 6)),
    legend.position = "none",
    panel.spacing = unit(1.2, "lines"),
    plot.margin = margin(18, 18, 18, 18)
  ) +
   scale_x_continuous(expand = expansion(mult = c(0, 0.30))) +  # ì´ ì¤„ ì¶”ê°€
  coord_cartesian(clip = "off")
```

### ë¬¸í•­16.í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€(ìœ„ì›íšŒ)ì˜ ìœ„ì›ì¥ì€ ëˆ„êµ¬ì…ë‹ˆê¹Œ?

â‘  êµì¥â‘¡ êµê°

í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ ìœ„ì›ì¥ì´ ëˆ„êµ¬ì¸ì§€ì— ëŒ€í•œ ë¬¸í•­ì— ì‘ë‹µììˆ˜ëŠ” ì´ 1,155ëª…ì´ë©° ì´ˆë“±í•™êµ ì‘ë‹µììˆ˜ëŠ” 518ëª…(50.4%), ì¤‘í•™êµ ì‘ë‹µììˆ˜ëŠ” 347ëª…(30%), ê³ ë“±í•™êµ ì‘ë‹µììˆ˜ëŠ” 264ëª…(22.9%), íŠ¹ìˆ˜í•™êµ ì‘ë‹µììˆ˜ëŠ” 17ëª…(1.5%), ê°ì¢…í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 9ëª…(0.8%)ì´ì—ˆìŒ

ì´ˆë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ ìœ„ì›ì¥ì´ êµê°ì´ë¼ëŠ” ì‘ë‹µìëŠ” 261ëª…(50.4%), êµì¥ì´ë¼ëŠ” ì‘ë‹µìëŠ” 257ëª…(49.6%)ë¡œ ë‚˜íƒ€ë‚¨

ì¤‘í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ ìœ„ì›ì¥ì´ êµê°ì´ë¼ëŠ” ì‘ë‹µìëŠ” 191ëª…(55%), êµì¥ì´ë¼ëŠ” ì‘ë‹µìëŠ” 156ëª…(45%)ë¡œ ë‚˜íƒ€ë‚¨

ê³ ë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ ìœ„ì›ì¥ì´ êµê°ì´ë¼ëŠ” ì‘ë‹µìëŠ” 174ëª…(65.9%), êµì¥ì´ë¼ëŠ” ì‘ë‹µìëŠ” 90ëª…(34.1%)ë¡œ ë‚˜íƒ€ë‚¨

íŠ¹ìˆ˜í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ ìœ„ì›ì¥ì´ êµê°ì´ë¼ëŠ” ì‘ë‹µìëŠ” 10ëª…(58.8%), êµì¥ì´ë¼ëŠ” ì‘ë‹µìëŠ” 7ëª…(41.2%)ë¡œ ë‚˜íƒ€ë‚¨

ê°ì¢…í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ ìœ„ì›ì¥ì´ êµê°ì´ë¼ëŠ” ì‘ë‹µìëŠ” 5ëª…(55.6%), êµì¥ì´ë¼ëŠ” ì‘ë‹µìëŠ” 4ëª…(44.4%)ë¡œ ë‚˜íƒ€ë‚¨

```{r}
#| echo: false
#| warning: false
#| message: false
dat_q16 <- dat_trimed %>%
  filter(!is.na(ques_16)) %>%
  mutate(
    ë¬¸í•­16 = recode(as.character(ques_16),
                  "1" = "êµì¥",
                  "2" = "êµê°")
  )

# ê¸°ìˆ í†µê³„
summary_q16 <- dat_q16 %>%
  group_by(í•™êµê¸‰, ë¬¸í•­16) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

# í•©ê³„ ì¶”ê°€
summary_q16_total <- summary_q16 %>%
  group_by(í•™êµê¸‰) %>%
  summarise(n = sum(n), pct = 100, ë¬¸í•­16 = "í•©ê³„", .groups = "drop") %>%
  bind_rows(summary_q16) %>%
  arrange(í•™êµê¸‰,
          if_else(ë¬¸í•­16 == "í•©ê³„", 2, 1),
          desc(n))

print(summary_q16_total, n = Inf)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# ê¸°ìˆ í†µê³„
summary_q16 <- dat_q16 %>%
  group_by(í•™êµê¸‰, ë¬¸í•­16) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

summary_q16_total <- summary_q16 %>%
  group_by(í•™êµê¸‰) %>%
  summarise(
    n = sum(n),
    pct = 100,
    ë¬¸í•­16 = "í•©ê³„",
    .groups = "drop"
  ) %>%
  bind_rows(summary_q16) %>%
  arrange(factor(í•™êµê¸‰),
          if_else(ë¬¸í•­16 == "í•©ê³„", 2, 1),
          desc(n))

# ì‹œê°í™”
ggplot(summary_q16, aes(x = ë¬¸í•­16, y = n, fill = ë¬¸í•­16)) +
  geom_bar(stat="identity", width=0.7) +
  geom_text(aes(label = paste0(n,"ëª…\n(",pct,"%)")), 
            vjust=-0.3, size=6.5, fontface="bold", lineheight =0.5) +
  facet_wrap(~í•™êµê¸‰, ncol = 3, nrow = 2) +  # 2í–‰ 3ì—´ ë°°ì¹˜
  labs(
    title = "í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€\nìœ„ì›ì¥",
    x = "ìœ„ì›ì¥",
    y = "ì‘ë‹µìˆ˜"
  ) +
  scale_x_discrete(labels = c("êµì¥", "êµê°")) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face="bold", size=32, hjust=0.5, margin = margin(b = 18), lineheight = 0.6),
    legend.position = "none",
    axis.text.x = element_text(angle=0, hjust=0.5, size=18, lineheight=0.6),
    axis.text.y = element_text(size=18),
    axis.title.x = element_text(size=20, margin = margin(t = 12)),
    axis.title.y = element_text(angle = 0, vjust = 0.5, size=20),
    strip.text = element_text(face="bold", size=18, margin = margin(t = 6, b = 6)),
    panel.spacing = unit(1.2, "lines"),  # íŒ¨ë„ ê°„ê²© ì¡°ê¸ˆ ì¦ê°€
    plot.margin = margin(18, 18, 18, 18)
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.4))) +
  coord_cartesian(clip = "off")
```

### ë¬¸í•­17.í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ íšŒì˜ì—ì„œ ì£¼ëœ ì—­í• ì„ ìˆ˜í–‰í•˜ëŠ” êµ¬ì„±ì›ì€ ëˆ„êµ¬ì…ë‹ˆê¹Œ?

â‘  êµì¥â‘¡ êµê° â‘¢ ë‹´ë‹¹ë¶€ì¥ ë˜ëŠ” ë‹´ë‹¹êµì‚¬ â‘£ ìƒë‹´(êµ)ì‚¬ â‘¤ ì§€ì—­ì‚¬íšŒêµìœ¡ì „ë¬¸ê°€ â‘¥ ê¸°íƒ€

í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ íšŒì˜ì—ì„œ ì£¼ëœ ì—­í• ì„ ìˆ˜í–‰í•˜ëŠ” êµ¬ì„±ì› ì„¤ë¬¸ì— ëŒ€í•œ ì‘ë‹µììˆ˜ëŠ” ì´ 1,155ëª…ì´ë©° ì´ˆë“±í•™êµ ì‘ë‹µììˆ˜ëŠ” 518ëª…(50.4%), ì¤‘í•™êµ ì‘ë‹µììˆ˜ëŠ” 347ëª…(30%), ê³ ë“±í•™êµ ì‘ë‹µììˆ˜ëŠ” 264ëª…(22.9%), íŠ¹ìˆ˜í•™êµ ì‘ë‹µììˆ˜ëŠ” 17ëª…(1.5%), ê°ì¢…í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 9ëª…(0.8%)ì´ì—ˆìŒ

ì´ˆë“±í•™êµì˜ ê²½ìš° í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ íšŒì˜ì—ì„œ ì£¼ëœ ì—­í• ì„ ìˆ˜í–‰í•˜ëŠ” êµ¬ì„±ì›ì€ ë‹´ë‹¹ë¶€ì¥ ë˜ëŠ” ë‹´ë‹¹êµì‚¬ë¼ê³  ë‹µë³€í•œ ì‘ë‹µìê°€ 357ëª…(68.9%) êµê°ì€ 82ëª…(15.8%), ì§€ì—­ì‚¬íšŒêµìœ¡ì „ë¬¸ê°€ëŠ” 42ëª…(12.1%), êµê°ì€ 82ëª…(15.8%), ì§€ì—­ì‚¬íšŒêµìœ¡ì „ë¬¸ê°€ëŠ” 42ëª…(8.1%), êµì¥ì€ 16ëª…(3.1%), ìƒë‹´(êµ)ì‚¬ëŠ” 14ëª…(2.7%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ì¤‘í•™êµì˜ ê²½ìš° í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ íšŒì˜ì—ì„œ ì£¼ëœ ì—­í• ì„ ìˆ˜í–‰í•˜ëŠ” êµ¬ì„±ì›ì€ ë‹´ë‹¹ë¶€ì¥ ë˜ëŠ” ë‹´ë‹¹êµì‚¬ë¼ê³  ë‹µë³€í•œ ì‘ë‹µìê°€ 232ëª…(66.9%), ì§€ì—­ì‚¬íšŒêµìœ¡ì „ë¬¸ê°€ëŠ” 42ëª…(12.1%), ìƒë‹´(êµ)ì‚¬ëŠ” 36ëª…(10.4%), êµê°ì€ 26ëª…(7.5%), êµì¥ì€ 6ëª…(1.7%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê³ ë“±í•™êµì˜ ê²½ìš° í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ íšŒì˜ì—ì„œ ì£¼ëœ ì—­í• ì„ ìˆ˜í–‰í•˜ëŠ” êµ¬ì„±ì›ì€ ë‹´ë‹¹ë¶€ì¥ ë˜ëŠ” ë‹´ë‹¹êµì‚¬ë¼ê³  ë‹µë³€í•œ ì‘ë‹µìê°€ 195ëª…(73.9%), ìƒë‹´(êµ)ì‚¬ëŠ” 37ëª…(14%), êµê°ì€ 24ëª…(9.1%), êµê°ì€ 24ëª…(7.5%), êµì¥ì€ 4ëª…(1.5%), ì§€ì—­ì‚¬íšŒêµìœ¡ì „ë¬¸ê°€ëŠ” 2ëª…(0.8%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

íŠ¹ìˆ˜í•™êµì˜ ê²½ìš° í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ íšŒì˜ì—ì„œ ì£¼ëœ ì—­í• ì„ ìˆ˜í–‰í•˜ëŠ” êµ¬ì„±ì›ì€ ë‹´ë‹¹ë¶€ì¥ ë˜ëŠ” ë‹´ë‹¹êµì‚¬ë¼ê³  ë‹µë³€í•œ ì‘ë‹µìê°€ 12ëª…(70.6%), êµì¥ì€ 2ëª…(11.8%), ìƒë‹´(êµ)ì‚¬ëŠ” 1ëª…(5.9%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê°ì¢…í•™êµì˜ ê²½ìš° í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ íšŒì˜ì—ì„œ ì£¼ëœ ì—­í• ì„ ìˆ˜í–‰í•˜ëŠ” êµ¬ì„±ì›ì€ ë‹´ë‹¹ë¶€ì¥ ë˜ëŠ” ë‹´ë‹¹êµì‚¬ë¼ê³  ë‹µë³€í•œ ì‘ë‹µìê°€ 8ëª…(88.9%), ìƒë‹´(êµ)ì‚¬ëŠ” 1ëª…(11.1%)ë¡œ ë‚˜íƒ€ë‚¬ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
# ë¬¸í•­17 ë°ì´í„° ì²˜ë¦¬ (í†µí•© ì½”ë“œ)
dat_q17_long <- dat_trimed %>%
  filter(!is.na(ques_17)) %>%
  separate_rows(ques_17, sep = ",\\s*") %>%
  mutate(
    ì½”ë“œ17 = str_trim(as.character(ques_17)),
    ë¬¸í•­17 = recode(ì½”ë“œ17,
                   "1" = "êµì¥",
                   "2" = "êµê°", 
                   "3" = "ë‹´ë‹¹ë¶€ì¥ ë˜ëŠ” ë‹´ë‹¹êµì‚¬",
                   "4" = "ìƒë‹´(êµ)ì‚¬",
                   "5" = "ì§€ì—­ì‚¬íšŒêµìœ¡ì „ë¬¸ê°€",
                   "6" = "ê¸°íƒ€",
                   .default = "ê¸°íƒ€")
  )
# ê¸°ìˆ í†µê³„(í•™êµê¸‰ë³„ ë¹ˆë„/ë¹„ìœ¨) + í•©ê³„ í–‰
summary_q17 <- dat_q17_long %>%
  group_by(í•™êµê¸‰, ë¬¸í•­17) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

summary_q17_total <- summary_q17 %>%
  group_by(í•™êµê¸‰) %>%
  summarise(n = sum(n), pct = 100, ë¬¸í•­17 = "í•©ê³„", .groups = "drop") %>%
  bind_rows(summary_q17) %>%
  arrange(factor(í•™êµê¸‰),
          if_else(ë¬¸í•­17 == "í•©ê³„", 2, 1),
          desc(n))

print(summary_q17_total, n = Inf)
```

```{r}
#| echo: false
#| warning: false
#| message: false
ggplot(summary_q17, aes(x = ë¬¸í•­17, y = n, fill = ë¬¸í•­17)) +
  geom_bar(stat="identity", width=0.7) +
  geom_text(aes(label = paste0(n,"ëª…\n(",pct,"%)"),
                y = n),  # ë§‰ëŒ€ ë°”ë¡œ ìœ„ì— ìœ„ì¹˜
            hjust=0.5, vjust=-0.1, size=4.5, fontface="bold", lineheight=0.4) +  # ì¤„ê°„ê²© ì¢ê²Œ, vjustë¡œ ë¯¸ì„¸ì¡°ì •
  facet_wrap(~í•™êµê¸‰, ncol = 2, nrow = 3) +  # 3í–‰ 2ì—´ ë°°ì¹˜
  labs(
    title = "í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€\nêµ¬ì„±ì›",
    x = "êµ¬ì„±ì›",
    y = "ì‘ë‹µìˆ˜"
  ) +
  scale_x_discrete(labels = c("ë‹´ë‹¹ë¶€ì¥\në˜ëŠ”\në‹´ë‹¹êµì‚¬", "êµê°", "ì§€ì—­\nì‚¬íšŒ\nêµìœ¡ì „ë¬¸ê°€","ìƒë‹´(êµ)ì‚¬","êµì¥", "ê¸°íƒ€")) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face="bold", size=32, hjust=0.5, margin = margin(b = 18), lineheight = 0.5),
    legend.position = "none",
    axis.text.x = element_text(angle=0, hjust=0.5, size=18, lineheight=0.5,margin = margin(b = 10)),  # xì¶• í…ìŠ¤íŠ¸ ì¤„ê°„ê²© ë” ì¢ê²Œ
    axis.text.y = element_text(size=18),
    axis.title.x = element_text(size=20, margin = margin(t = 18)),  # xì¶• ì œëª© ì—¬ë°± ì ì ˆíˆ
    axis.title.y = element_text(angle = 0, vjust = 0.5, size=20),
    strip.text = element_text(face="bold", size=15, margin = margin(t = 6, b = 6)),
    panel.spacing = unit(1.5, "lines"),
    plot.margin = margin(20, 20, 20, 20)
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.25))) +  # ìƒë‹¨ ì—¬ë°± ì ë‹¹íˆ
  coord_cartesian(clip = "off")
```

### ë¬¸í•­18. í•™ìƒë§ì¶¤í†µí•©ì§€ì›ì„ ìœ„í•´ ì£¼ë¡œ ì–´ëŠ ë¶€ì„œì™€ í˜‘ì—…í•©ë‹ˆê¹Œ? (ì¤‘ë³µì‘ë‹µ)

â‘  êµë¬´ë¶€ â‘¡ ì—°êµ¬ë¶€ â‘¢ ìƒí™œì§€ë„ë¶€ â‘£ êµìœ¡ë³µì§€ë¶€ â‘¤ ì§„ë¡œë¶€ â‘¥ ìƒë‹´ë¶€(ìœ„í´ë˜ìŠ¤) â‘¦ ë³´ê±´ì‹¤ â‘§ ê¸°íƒ€

í•™ìƒë§ì¶¤í†µí•©ì§€ì›ì„ ìœ„í•´ ì£¼ë¡œ í˜‘ì—…í•˜ëŠ” ë¶€ì„œì— ì„¤ë¬¸ ì‘ë‹µê±´ìˆ˜ëŠ” ì´ 2,765ê±´ì´ë©° ì´ˆë“±í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 1,302ê±´(47.1%), ì¤‘í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 817ê±´(29.5%), ê³ ë“±í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 601ê±´(21.7%), íŠ¹ìˆ˜í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 25ê±´(0.9%), ê°ì¢…í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 20ê±´(0.7%)ì´ì—ˆìŒ

ì´ˆë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ í•™ìƒë§ì¶¤í†µí•©ì§€ì›ì„ ìœ„í•´ ì£¼ë¡œ í˜‘ì—…í•˜ëŠ” ë¶€ì„œë¡œ êµìœ¡ë³µì§€ë¶€ëŠ” 324ê±´(24.9%), ìƒí™œì§€ë„ë¶€ëŠ” 317ê±´(24.3%), ìƒë‹´ë¶€(ìœ„í´ë˜ìŠ¤)ëŠ” 228ê±´(17.5%), êµë¬´ë¶€ëŠ” 157ê±´(12.1%), ì—°êµ¬ë¶€ëŠ” 103ê±´(7.9%), ë³´ê±´ì‹¤ì€ 79ê±´(6.1%), ì§„ë¡œë¶€ëŠ” 79ê±´(6.1%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ì¤‘í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ í•™ìƒë§ì¶¤í†µí•©ì§€ì›ì„ ìœ„í•´ ì£¼ë¡œ í˜‘ì—…í•˜ëŠ” ë¶€ì„œë¡œ ìƒë‹´ë¶€(ìœ„í´ë˜ìŠ¤)ëŠ” 267ê±´(32.7%), êµìœ¡ë³µì§€ë¶€ëŠ” 215ê±´(26.3%), ìƒí™œì§€ë„ë¶€ëŠ” 132ê±´(16.2%), ë³´ê±´ì‹¤ì€ 61ê±´(7.5%), ì§„ë¡œë¶€ëŠ” 59ê±´(7.2%), êµë¬´ë¶€ëŠ” 38ê±´(4.7%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê³ ë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ í•™ìƒë§ì¶¤í†µí•©ì§€ì›ì„ ìœ„í•´ ì£¼ë¡œ í˜‘ì—…í•˜ëŠ” ë¶€ì„œë¡œ ìƒë‹´ë¶€(ìœ„í´ë˜ìŠ¤)ëŠ” 183ê±´(30.4%), ìƒí™œì§€ë„ë¶€ëŠ” 142ê±´(23.6%), êµìœ¡ë³µì§€ë¶€ëŠ” 68ê±´(11.3%), êµë¬´ë¶€ëŠ” 42ê±´(7%), ì—°êµ¬ë¶€ëŠ” 32ê±´(5.3%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

íŠ¹ìˆ˜í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ í•™ìƒë§ì¶¤í†µí•©ì§€ì›ì„ ìœ„í•´ ì£¼ë¡œ í˜‘ì—…í•˜ëŠ” ë¶€ì„œë¡œ ìƒí™œì§€ë„ë¶€ëŠ” 11ê±´(44%), êµë¬´ë¶€ëŠ” 7ê±´(28%), ë³´ê±´ì‹¤ì€ 2ê±´(8%), êµìœ¡ë³µì§€ë¶€, ì—°êµ¬ë¶€, ìƒë‹´ë¶€(ìœ„í´ë˜ìŠ¤)ê°€ ê° 1ê±´(4%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê°ì¢…í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ í•™ìƒë§ì¶¤í†µí•©ì§€ì›ì„ ìœ„í•´ ì£¼ë¡œ í˜‘ì—…í•˜ëŠ” ë¶€ì„œë¡œ ìƒí™œì§€ë„ë¶€ëŠ” 7ê±´(35%), ìƒí™œì§€ë„ë¶€ëŠ” 4ê±´(20%), ì—°êµ¬ë¶€ëŠ” 3ê±´(15%), êµë¬´ë¶€ëŠ” 2ê±´(10%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
# ë¬¸í•­18 ë°ì´í„° ì²˜ë¦¬ 
dat_q18_long <- dat_trimed %>%
  filter(!is.na(ques_18)) %>%
  separate_rows(ques_18, sep = ",\\s*") %>%
  mutate(
    ques_18 = str_trim(as.character(ques_18)),
    ë¬¸í•­18 = recode(ques_18,
                   "1" = "êµë¬´ë¶€",
                   "2" = "ì—°êµ¬ë¶€", 
                   "3" = "ìƒí™œì§€ë„ë¶€",
                   "4" = "êµìœ¡ë³µì§€ë¶€",
                   "5" = "ì§„ë¡œë¶€",
                   "6" = "ìƒë‹´ë¶€(ìœ„í´ë˜ìŠ¤)",
                   "7" = "ë³´ê±´ì‹¤",
                   "8" = "ê¸°íƒ€",
                   .default = "ê¸°íƒ€")
  )

# ê¸°ìˆ í†µê³„
summary_q18 <- dat_q18_long %>%
  group_by(í•™êµê¸‰, ë¬¸í•­18) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

# í•©ê³„ ì¶”ê°€ (í•„ìš”í•œ ê²½ìš°)
summary_q18_total <- summary_q18 %>%
  group_by(í•™êµê¸‰) %>%
  summarise(n = sum(n), pct = 100, ë¬¸í•­18 = "í•©ê³„", .groups = "drop") %>%
  bind_rows(summary_q18) %>%
  arrange(í•™êµê¸‰, 
          if_else(ë¬¸í•­18 == "í•©ê³„", 2, 1),
          desc(n))

print(summary_q18_total, n = Inf)
```

```{r}
#| echo: false
#| warning: false
#| message: false
ggplot(
  summary_q18 %>%
    mutate(ë¬¸í•­18 = reorder(ë¬¸í•­18, -n)),   # n ê¸°ì¤€ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
  aes(x = ë¬¸í•­18, y = n, fill = ë¬¸í•­18)
) +
  geom_bar(stat = "identity", width = 0.7) +
  geom_text(aes(label = paste0(n,"ê±´\n(",pct,"%)"), 
                y = n + max(n) * 0.05),  # ìµœëŒ€ê°’ì˜ 5%ë§Œí¼ ìœ„ì— ìœ„ì¹˜
            vjust = 0.1, hjust = 0.5, size = 5.5, lineheight = 0.4) +
  facet_wrap(~í•™êµê¸‰, ncol = 1, scales = "free_y") +
  labs(
    title = "í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ í˜‘ë ¥ë¶€ì„œ",
    x = "í˜‘ë ¥ë¶€ì„œ",
    y = "ì‘ë‹µìˆ˜"
  ) +
  scale_x_discrete(labels = c("êµë¬´ë¶€", "ì—°êµ¬ë¶€", "ìƒí™œì§€ë„ë¶€", "êµìœ¡ë³µì§€ë¶€", "ì§„ë¡œë¶€", "ìƒë‹´ë¶€\n(ìœ„í´ë˜ìŠ¤)", "ë³´ê±´ì‹¤", "ê¸°íƒ€")) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
    legend.position = "none",
    axis.text.x = element_text(angle = 0, vjust = 0.8, lineheight = 0.5, size = 17, margin = margin(t = 40)),  # ì¤‘ë³µ ì œê±° ë° í†µí•©
    axis.text.y = element_text(size = 15),
    strip.text = element_text(face = "bold", size = 20),
    axis.title.x = element_text(size = 20, margin = margin(t = 18)),
    axis.title.y = element_text(angle = 0, vjust = 0.5, size = 20)  # yì¶• ì œëª© í¬ê¸° ì¶”ê°€
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.15))) +
  coord_cartesian(clip = "off")
```

### ë¬¸í•­19. 2025ë…„ë„ ìƒë°˜ê¸°(1ì›”\~6ì›”)ì— í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ì€ ëª‡ íšŒ ìš´ì˜í•˜ì˜€ìŠµë‹ˆê¹Œ?

â‘  1íšŒ â‘¡ 2íšŒ â‘¢ 3íšŒ â‘£ 4íšŒ â‘¤ 5íšŒ ì´ìƒ â‘¥ ë¯¸ì‹¤ì‹œ

2025ë…„ë„ ìƒë°˜ê¸° ë™ì•ˆ í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ì„ ìš´ì˜í•œ íšŸìˆ˜ì— ëŒ€í•œ ë¬¸í•­ì— ì‘ë‹µìëŠ” ì´ 1,155ëª…ì´ë©° ì´ˆë“±í•™êµ ì‘ë‹µìëŠ” 518ëª…(44.8%), ì¤‘í•™êµ ì‘ë‹µìëŠ” 347ëª…(30%), ê³ ë“±í•™êµ ì‘ë‹µìëŠ” 264ëª…(22.9%), íŠ¹ìˆ˜í•™êµ ì‘ë‹µìëŠ” 17ëª…(1.5%), ê°ì¢…í•™êµ ì‘ë‹µìëŠ” 9ëª…(0.8%)ì´ì—ˆìŒ

ì´ˆë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ 1íšŒ ìš´ì˜í–ˆë‹¤ëŠ” ì‘ë‹µì€ 171ëª…(33%), 2íšŒëŠ” 122ëª…(23.6%), 3íšŒëŠ” 73ëª…(14.1%), 4íšŒëŠ” 16ëª…(3.1%), 5íšŒ ì´ìƒì€ 43ëª…(8.3%), ë¯¸ì‹¤ì‹œëŠ” 93ëª…(18%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ì¤‘í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ 1íšŒ ìš´ì˜í–ˆë‹¤ëŠ” ì‘ë‹µì€ 75ëª…(21.6%), 2íšŒëŠ” 78ëª…(22.5%), 3íšŒëŠ” 66ëª…(19%), 4íšŒëŠ” 28ëª…(8.1%), 5íšŒ ì´ìƒì€ 44ëª…(12.7%), ë¯¸ì‹¤ì‹œëŠ” 56ëª…(16.1%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê³ ë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ 1íšŒ ìš´ì˜í–ˆë‹¤ëŠ” ì‘ë‹µì€ 85ëª…(32.1%), 2íšŒëŠ” 58ëª…(22%), 3íšŒëŠ” 23ëª…(8.7%), 4íšŒëŠ” 9ëª…(3.4%), 5íšŒ ì´ìƒì€ 17ëª…(6.4%), ë¯¸ì‹¤ì‹œëŠ” 72ëª…(27.3%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

íŠ¹ìˆ˜í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ 1íšŒ ìš´ì˜í–ˆë‹¤ëŠ” ì‘ë‹µì€ 2ëª…(11.8%), 2íšŒëŠ” 1ëª…(5.9%), 4íšŒëŠ” 2ëª…(14.1%), 5íšŒ ì´ìƒì€ 1ëª…(5.9%), ë¯¸ì‹¤ì‹œëŠ” 11ëª…(64.7%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê°ì¢…í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ 1íšŒ ìš´ì˜í–ˆë‹¤ëŠ” ì‘ë‹µì€ 2ëª…(22.2%), 2íšŒëŠ” 2ëª…(22.2%), ë¯¸ì‹¤ì‹œëŠ” 5ëª…(55.6%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
# ë¬¸í•­19 ë°ì´í„° ì²˜ë¦¬ 
dat_q19 <- dat_trimed %>%  # dat_q16 â†’ dat_trimedë¡œ ë³€ê²½
  filter(!is.na(ques_19)) %>%
  mutate(
    ë¬¸í•­19 = recode(as.character(ques_19),
                   "1" = "1íšŒ",
                   "2" = "2íšŒ",
                   "3" = "3íšŒ", 
                   "4" = "4íšŒ",
                   "5" = "5íšŒ ì´ìƒ",
                   "6" = "ë¯¸ì‹¤ì‹œ",
                   .default = "ê¸°íƒ€"),
    ë¬¸í•­19 = factor(ë¬¸í•­19, levels = c("1íšŒ", "2íšŒ", "3íšŒ", "4íšŒ", "5íšŒ ì´ìƒ", "ë¯¸ì‹¤ì‹œ"))
  )

# ê¸°ìˆ í†µê³„
summary_q19 <- dat_q19 %>%
  group_by(í•™êµê¸‰, ë¬¸í•­19) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

# í•©ê³„ ì¶”ê°€
summary_q19_total <- summary_q19 %>%
  group_by(í•™êµê¸‰) %>%
  summarise(n = sum(n), pct = 100, ë¬¸í•­19 = "í•©ê³„", .groups = "drop") %>%
  bind_rows(summary_q19) %>%
  arrange(í•™êµê¸‰,  # school_levels5 ì˜ì¡´ì„± ì œê±°
          if_else(ë¬¸í•­19 == "í•©ê³„", 2, 1))

print(summary_q19_total, n = Inf)
```

```{r}
#| echo: false
#| warning: false
#| message: false
ggplot(
  summary_q19 %>%
    mutate(ë¬¸í•­19 = reorder(ë¬¸í•­19, -n)),   # n ê¸°ì¤€ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
  aes(x = ë¬¸í•­19, y = n, fill = ë¬¸í•­19)
) +
  geom_bar(stat = "identity", width = 0.7) +
  geom_text(aes(label = paste0(n,"êµ\n(",pct,"%)"), 
                y = n + max(n) * 0.05),  # ìµœëŒ€ê°’ì˜ 5%ë§Œí¼ ìœ„ì— ìœ„ì¹˜
            vjust = -0.2, hjust = 0.5, size = 5, lineheight = 0.4) +
  facet_wrap(~í•™êµê¸‰, ncol = 1, scales = "free_y") +
  labs(
    title = "í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ íšŒì˜ ê°œìµœ íšŸìˆ˜",
    x = "íšŒì˜íšŸìˆ˜",
    y = "ì‘ë‹µìˆ˜"
  ) +
  scale_x_discrete(labels = c("1íšŒ", "2íšŒ", "3íšŒ", "4íšŒ", "5íšŒ ì´ìƒ", "ë¯¸ì‹¤ì‹œ")) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
    legend.position = "none",
    axis.text.x = element_text(angle = 0, vjust = 0.8, lineheight = 0.7, size = 15),
    axis.text.y = element_text(size = 15),
    strip.text = element_text(face = "bold", size = 20),
    axis.title.x = element_text(size = 20, margin = margin(t = 18)),
    axis.title.y = element_text(angle = 0, vjust = 0.5, size = 20)
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.15))) +
  coord_cartesian(clip = "off")
```

### ë¬¸í•­20. 2025ë…„ë„ ìƒë°˜ê¸°(1ì›”\~6ì›”)ì— í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ì—ì„œ ì§€ì›í•œ í•™ìƒì€ ëª‡ ëª…ì…ë‹ˆê¹Œ?

â‘  1ëª… â‘¡ 2ëª… â‘¢ 3ëª… â‘£ 4ëª… â‘¤ 5ëª… ì´ìƒ â‘¥ ì—†ìŒ

2025ë…„ë„ ìƒë°˜ê¸° ë™ì•ˆ í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ì´ ì§€ì›í•œ í•™ìƒìˆ˜ì— ëŒ€í•œ ë¬¸í•­ì— ì‘ë‹µìëŠ” ì´ 1,155ëª…ì´ë©° ì´ˆë“±í•™êµ ì‘ë‹µìëŠ” 518ëª…(44.8%), ì¤‘í•™êµ ì‘ë‹µìëŠ” 347ëª…(30%), ê³ ë“±í•™êµ ì‘ë‹µìëŠ” 264ëª…(22.9%), íŠ¹ìˆ˜í•™êµ ì‘ë‹µìëŠ” 17ëª…(1.5%), ê°ì¢…í•™êµ ì‘ë‹µìëŠ” 9ëª…(0.8%)ì´ì—ˆìŒ

ì´ˆë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ 1ëª…ì„ ì§€ì›í–ˆë‹¤ëŠ” ì‘ë‹µì€ 83ëª…(16%), 2ëª… ì§€ì›ì€ 81ëª…(15.6%), 3ëª… ì§€ì›ì€ 54ëª…(10.4%), 4ëª… ì§€ì›ì€ 141ëª…(27.2%), 5ëª… ì´ìƒì€ 141ëª…(27.2%), ë¯¸ì§€ì›ì€ 124ëª…(23.9%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ì¤‘í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ 1ëª…ì„ ì§€ì›í–ˆë‹¤ëŠ” ì‘ë‹µì€ 47ëª…(13.5%), 2ëª… ì§€ì›ì€ 43ëª…(12.4%), 3ëª… ì§€ì›ì€ 40ëª…(11.5%), 4ëª… ì§€ì›ì€ 23ëª…(6.6%), 5ëª… ì´ìƒì€ 119ëª…(34.3%), ë¯¸ì§€ì›ì€ 75ëª…(21.6%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê³ ë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ 1ëª…ì„ ì§€ì›í–ˆë‹¤ëŠ” ì‘ë‹µì€ 32ëª…(12.1%), 2ëª… ì§€ì›ì€ 26ëª…(9.8%), 3ëª… ì§€ì›ì€ 17ëª…(6.4%), 4ëª… ì§€ì›ì€ 11ëª…(4.2%), 5ëª… ì´ìƒì€ 79ëª…(29.9%), ë¯¸ì§€ì›ì€ 99ëª…(37.5%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

íŠ¹ìˆ˜í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ 4ëª…ì„ ì§€ì›í–ˆë‹¤ëŠ” ì‘ë‹µì€ 1ëª…(5.9%), 5ëª… ì´ìƒì€ 2ëª…(11.8%), ë¯¸ì§€ì›ì€ 14ëª…(82.4%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê°ì¢…í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ 1ëª…ì„ ì§€ì›í–ˆë‹¤ëŠ” ì‘ë‹µì€ 1ëª…(11.1%), 3ëª… ì§€ì›ì€ 1ëª…(11.1%), 5ëª… ì´ìƒì€ 141ëª…(22.2%), ë¯¸ì§€ì›ì€ 5ëª…(55.6%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

```{r}
# ë¬¸í•­20 ë°ì´í„° ì²˜ë¦¬ (ê°„ì†Œí™”ëœ ë²„ì „)
dat_q20 <- dat_trimed %>%  # dat_q19 â†’ dat_trimedë¡œ ë³€ê²½
  filter(!is.na(ques_20)) %>%
  mutate(
    ë¬¸í•­20 = recode(as.character(ques_20),
                   "1" = "1ëª…",
                   "2" = "2ëª…",
                   "3" = "3ëª…", 
                   "4" = "4ëª…",
                   "5" = "5ëª… ì´ìƒ",
                   "6" = "ì—†ìŒ",
                   .default = "ê¸°íƒ€"),
    ë¬¸í•­20 = factor(ë¬¸í•­20, levels = c("1ëª…", "2ëª…", "3ëª…", "4ëª…", "5ëª… ì´ìƒ", "ì—†ìŒ"))
  )

# ê¸°ìˆ í†µê³„
summary_q20 <- dat_q20 %>%
  group_by(í•™êµê¸‰, ë¬¸í•­20) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

# í•©ê³„ ì¶”ê°€
summary_q20_total <- summary_q20 %>%
  group_by(í•™êµê¸‰) %>%
  summarise(n = sum(n), pct = 100, ë¬¸í•­20 = "í•©ê³„", .groups = "drop") %>%
  bind_rows(summary_q20) %>%
  arrange(í•™êµê¸‰,  # school_levels5 ì˜ì¡´ì„± ì œê±°
          if_else(ë¬¸í•­20 == "í•©ê³„", 2, 1))

print(summary_q20_total, n = Inf)
```

```{r}
# ì‹œê°í™”
ggplot(
  summary_q20 %>%
    mutate(ë¬¸í•­20 = reorder(ë¬¸í•­20, -n)),   # n ê¸°ì¤€ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
  aes(x = ë¬¸í•­20, y = n, fill = ë¬¸í•­20)
) +
  geom_bar(stat = "identity", width = 0.7) +
  geom_text(aes(label = paste0(n,"êµ\n(",pct,"%)"), 
                y = n + max(n) * 0.05),  # ìµœëŒ€ê°’ì˜ 5%ë§Œí¼ ìœ„ì— ìœ„ì¹˜
            vjust = -0.2, hjust = 0.5, size = 5, lineheight = 0.4) +
  facet_wrap(~í•™êµê¸‰, ncol = 1, scales = "free_y") +
  labs(
    title = "í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€\n ì§€ì›í•œ í•™ìƒìˆ˜",
    x = "ì§€ì›í•™ìƒìˆ˜",
    y = "ì‘ë‹µìˆ˜"
  ) +
  scale_x_discrete(labels = c("1ëª…", "2ëª…", "3ëª…", "4ëª…", "5ëª… ì´ìƒ", "ì—†ìŒ")) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
    legend.position = "none",
    axis.text.x = element_text(angle = 0, vjust = 0.8, lineheight = 0.7, size = 15),
    axis.text.y = element_text(size = 15),
    strip.text = element_text(face = "bold", size = 20),
    axis.title.x = element_text(size = 20, margin = margin(t = 18)),
    axis.title.y = element_text(angle = 0, vjust = 0.5, size = 20)
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.15))) +
  coord_cartesian(clip = "off")
```

### ë¬¸í•­21. í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ì— ì˜ë¢°ëœ ì§€ì›ìš”ì²­ì€ ì–´ëŠ ë¶„ì•¼ì…ë‹ˆê¹Œ? \[20ë²ˆ ë¬¸í•­ì— â‘  \~ â‘¤í•­ìœ¼ë¡œ ë‹µë³€í•œ ê²½ìš°ë§Œ ì‘ë‹µ\] (ì¤‘ë³µì‘ë‹µ)

â‘  ê²½ì œì  ì§€ì› â‘¡ ì‹¬ë¦¬ì •ì„œ ì§€ì› â‘¢ í•™ì—… ë° ì§„ë¡œì§€ì› â‘£ ì•ˆì „ì§€ì›(í•™êµí­ë ¥, ì•„ë™í•™ëŒ€, ì„±í¬ë¡±ã†ì„±í­ë ¥, ê²Œì„ì¤‘ë…, ì•½ë¬¼ì¤‘ë… ë“±) â‘¤ ê±´ê°•ì§€ì›(ìœ„ìƒê´€ë¦¬, ì˜ì–‘ê´€ë¦¬, ìš´ë™ê´€ë¦¬, ìŠ¤íŠ¸ë ˆìŠ¤ ê´€ë¦¬, ìˆ˜ë©´ê´€ë¦¬, ìŠ¤ë§ˆíŠ¸í° ì‚¬ìš© ì‹œê°„ ê´€ë¦¬ ë“±)

í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ì— ì˜ë¢°ëœ ì§€ì›ìš”ì²­ ë¶„ì•¼ì— ëŒ€í•œ ì„¤ë¬¸ ì‘ë‹µê±´ìˆ˜ëŠ” ì´ 1,594ê±´ì´ë©° ì´ˆë“±í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 722ê±´(45.3%), ì¤‘í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 544ê±´(34.1%), ê³ ë“±í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 315ê±´(19.8%), íŠ¹ìˆ˜í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 7ê±´(0.4%), ê°ì¢…í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 6ê±´(0.4%)ì´ì—ˆìŒ

ì´ˆë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ì‹¬ë¦¬ì •ì„œ ì§€ì› ìš”ì²­ê±´ìˆ˜ëŠ” 346ê±´(47.9%), ê²½ì œì  ì§€ì› ìš”ì²­ê±´ìˆ˜ëŠ” 151ê±´(20.9%), í•™ì—… ë° ì§„ë¡œì§€ì› ìš”ì²­ê±´ìˆ˜ëŠ” 112ê±´(15.5%), ì•ˆì „ì§€ì› ìš”ì²­ê±´ìˆ˜ëŠ” 63ê±´(8.7%), ê±´ê°•ì§€ì› ìš”ì²­ê±´ìˆ˜ëŠ” 50ê±´(6.9%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ì¤‘í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ì‹¬ë¦¬ì •ì„œ ì§€ì› ìš”ì²­ê±´ìˆ˜ëŠ” 223ê±´(41%), ê²½ì œì  ì§€ì› ìš”ì²­ê±´ìˆ˜ëŠ” 150ê±´(27.6%), í•™ì—… ë° ì§„ë¡œì§€ì› ìš”ì²­ê±´ìˆ˜ëŠ” 73ê±´(13.4%), ì•ˆì „ì§€ì› ìš”ì²­ê±´ìˆ˜ëŠ” 54ê±´(9.9%), ê±´ê°•ì§€ì› ìš”ì²­ê±´ìˆ˜ëŠ” 44ê±´(8.1%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê³ ë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ì‹¬ë¦¬ì •ì„œ ì§€ì› ìš”ì²­ê±´ìˆ˜ëŠ” 127ê±´(40.3%), ê²½ì œì  ì§€ì› ìš”ì²­ê±´ìˆ˜ëŠ” 88ê±´(27.9%), í•™ì—… ë° ì§„ë¡œì§€ì› ìš”ì²­ ê±´ìˆ˜ëŠ” 66ê±´(21%), ê±´ê°•ì§€ì› ìš”ì²­ê±´ìˆ˜ëŠ” 17ê±´(5.4%), ì•ˆì „ì§€ì› ìš”ì²­ê±´ìˆ˜ëŠ” 17ê±´(5.4%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

íŠ¹ìˆ˜í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ì‹¬ë¦¬ì •ì„œ ì§€ì› ìš”ì²­ê±´ìˆ˜ëŠ” 3ê±´(47.9%), ì•ˆì „ì§€ì› ìš”ì²­ê±´ìˆ˜ëŠ” 3ê±´(42.9%), ê²½ì œì  ì§€ì› ìš”ì²­ê±´ìˆ˜ëŠ” 1ê±´(14.3%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê°ì¢…í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ê²½ì œì  ì§€ì› ìš”ì²­ê±´ìˆ˜ëŠ” 2ê±´(33.3%), ì‹¬ë¦¬ì •ì„œ ì§€ì› ìš”ì²­ê±´ìˆ˜ëŠ” 3ê±´(33.3%), ì•ˆì „ì§€ì› ìš”ì²­ ê±´ìˆ˜ëŠ” 1ê±´(16.7%), í•™ì—… ë° ì§„ë¡œì§€ì› ìš”ì²­ê±´ìˆ˜ëŠ” 1ê±´(16.7%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
# ë¬¸í•­21 ë°ì´í„° ì²˜ë¦¬ 
dat_q21_long <- dat_trimed %>%
  filter(!is.na(ques_20), !is.na(ques_21)) %>%
  filter(as.character(ques_20) %in% as.character(1:5)) %>%  # ë¬¸í•­20ì´ 1~5ì¸ ê²½ìš°ë§Œ
  separate_rows(ques_21, sep = ",\\s*") %>%
  mutate(ques_21 = str_trim(as.character(ques_21))) %>%
  filter(ques_21 %in% as.character(1:5)) %>%  # ë¬¸í•­21ì´ 1~5ì¸ ê²½ìš°ë§Œ
  mutate(
    ë¬¸í•­21 = recode(ques_21,
                   "1" = "ê²½ì œì  ì§€ì›",
                   "2" = "ì‹¬ë¦¬ì •ì„œ ì§€ì›",
                   "3" = "í•™ì—… ë° ì§„ë¡œì§€ì›",
                   "4" = "ì•ˆì „ì§€ì›",
                   "5" = "ê±´ê°•ì§€ì›",
                   .default = "ê¸°íƒ€")
  )

# ê¸°ìˆ í†µê³„
summary_q21 <- dat_q21_long %>%
  group_by(í•™êµê¸‰, ë¬¸í•­21) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

# í•©ê³„ ì¶”ê°€
summary_q21_total <- summary_q21 %>%
  group_by(í•™êµê¸‰) %>%
  summarise(n = sum(n), pct = 100, ë¬¸í•­21 = "í•©ê³„", .groups = "drop") %>%
  bind_rows(summary_q21) %>%
  arrange(í•™êµê¸‰,  # school_levels5 ì˜ì¡´ì„± ì œê±°
          if_else(ë¬¸í•­21 == "í•©ê³„", 2, 1),
          desc(n))

print(summary_q21_total, n = Inf)
```

```{r}
#| echo: false
#| warning: false
#| message: false
ggplot(
  summary_q21 %>%
    mutate(ë¬¸í•­21 = reorder(ë¬¸í•­21, -n)),   # n ê¸°ì¤€ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
  aes(x = ë¬¸í•­21, y = n, fill = ë¬¸í•­21)
) +
  geom_bar(stat = "identity", width = 0.7) +
  geom_text(aes(label = paste0(n,"ê±´\n(",pct,"%)"), 
                y = n + max(n) * 0.05),  # ìµœëŒ€ê°’ì˜ 5%ë§Œí¼ ìœ„ì— ìœ„ì¹˜
            vjust = 0.1, hjust = 0.5, size = 4.5, lineheight = 0.4) +
  facet_wrap(~í•™êµê¸‰, ncol = 1, scales = "free_y") +
  labs(
    title = "í•™ìƒë§ì¶¤í†µí•©ì§€ì› ì œê³µ ì˜ì—­",
    x = "ì§€ì›ì˜ì—­",
    y = "ì‘ë‹µìˆ˜"
  ) +
  scale_x_discrete(labels = c("ê²½ì œì  ì§€ì›", "ì‹¬ë¦¬ì •ì„œ ì§€ì›", "í•™ì—… ë°\nì§„ë¡œì§€ì›", "ì•ˆì „ì§€ì›", "ê±´ê°•ì§€ì›")) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
    legend.position = "none",
    axis.text.x = element_text(angle = 0, vjust = 0.8, lineheight = 0.7, size = 15),
    axis.text.y = element_text(size = 15),
    strip.text = element_text(face = "bold", size = 20),
    axis.title.x = element_text(size = 20, margin = margin(t = 18)),
    axis.title.y = element_text(angle = 0, vjust = 0.5, size = 20)
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.15))) +
  coord_cartesian(clip = "off")
```

### ë¬¸í•­22. í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ ìš´ì˜ê³¼ì •ì—ì„œ ê²ªëŠ” ì–´ë ¤ì›€ì€ ì–´ë–¤ ì˜ì—­ì…ë‹ˆê¹Œ? (ì¤‘ë³µì‘ë‹µ)

â‘  ëª…í™•í•œ ìš´ì˜ ë°©ì¹¨ ë¶€ì¬ â‘¡ í•™ìƒ ê´€ë¦¬ ì‹œìŠ¤í…œ ë¶€ì¬ â‘¢ êµì‚¬ì˜ ì¸ì‹ ë¶€ì¡± â‘£ êµìœ¡êµ¬ì„±ì› ê°„ í˜‘ë ¥ë¶€ì¡± â‘¤ í•™ìƒ ì§€ì› ë°©ì•ˆì˜ ë³µì¡ì„± â‘¥ ì™¸ë¶€ê¸°ê´€ê³¼ì˜ ì—°ê³„ ì–´ë ¤ì›€ â‘¦ ê¸°íƒ€ (ì£¼ê´€ì‹: (ì˜ˆì‹œ) ì „ë¬¸ê°€ì˜ ìë¬¸ ë° í•™êµìƒí™©ì— ë§ëŠ” ì§€ë„ë°©ë²• ë“±)

í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ ìš´ì˜ê³¼ì •ì˜ ì–´ë ¤ì›€ì— ëŒ€í•œ ì„¤ë¬¸ì— ì´ ì‘ë‹µê±´ìˆ˜ëŠ” 1,473ê±´ì´ë©° ì´ˆë“±í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 680ëª…(46.16%), ì¤‘í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 472ê±´(32.04%)ì´ê³  ê³ ë“±í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 306ê±´(20.78%)ì´ê³ , íŠ¹ìˆ˜í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 7ê±´(0.48%)ì´ê³  ê°ì¢…í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 8ê±´(0.54%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¨

ì´ˆë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ í†µí•©ì§€ì›íŒ€ ìš´ì˜ ê³¼ì •ì—ì„œ ì–´ë ¤ì›€ì„ ê²ªëŠ” ë¶„ì•¼ì— ëŒ€í•´ í•™ìƒ ì§€ì› ë°©ì•ˆì˜ ë³µì¡ì„±ìœ¼ë¡œ ì‘ë‹µí•œ ê±´ìˆ˜ê°€ 194ê±´(28.5%)ì´ê³  ëª…í™•í•œ ìš´ì˜ ë°©ì¹¨ ë¶€ì¬ë¼ê³  ì‘ë‹µí•œ ê±´ìˆ˜ëŠ” 141ê±´(20.7%), ì™¸ë¶€ê¸°ê´€ê³¼ì˜ ì—°ê³„ ì–´ë ¤ì›€ìœ¼ë¡œ 131ê±´(19.3%), í•™ìƒ ê´€ë¦¬ ì‹œìŠ¤í…œ ë¶€ì¬ë¼ëŠ” ì‘ë‹µê±´ìˆ˜ëŠ” 92ê±´(13.5%), êµìœ¡êµ¬ì„±ì› ê°„ í˜‘ë ¥ë¶€ì¡±ì€ 37ê±´(5.4%), êµì‚¬ì˜ ì¸ì‹ ë¶€ì¡±ì€ 31ê±´(4.6%) ë“±ìœ¼ë¡œ ì‘ë‹µí•˜ì˜€ìŒ

ì¤‘í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ í†µí•©ì§€ì›íŒ€ ìš´ì˜ ê³¼ì •ì—ì„œ ì–´ë ¤ì›€ì„ ê²ªëŠ” ë¶„ì•¼ì— ëŒ€í•´ í•™ìƒ ì§€ì› ë°©ì•ˆì˜ ë³µì¡ì„±ìœ¼ë¡œ ì‘ë‹µí•œ ê±´ìˆ˜ê°€ 132ê±´(28%)ì´ê³  ëª…í™•í•œ ìš´ì˜ ë°©ì¹¨ ë¶€ì¬ë¼ê³  ì‘ë‹µí•œ ê±´ìˆ˜ëŠ” 95ê±´(20.1%), ì™¸ë¶€ê¸°ê´€ê³¼ì˜ ì—°ê³„ ì–´ë ¤ì›€ìœ¼ë¡œ 86ê±´(18.2%), í•™ìƒ ê´€ë¦¬ ì‹œìŠ¤í…œ ë¶€ì¬ë¼ëŠ” ì‘ë‹µê±´ìˆ˜ëŠ” 56ê±´(11.9%), êµìœ¡êµ¬ì„±ì› ê°„ í˜‘ë ¥ë¶€ì¡±ì€ 34ê±´(7.2%), êµì‚¬ì˜ ì¸ì‹ ë¶€ì¡±ì€ 33ê±´(7%) ë“±ì´ë¼ê³  ì‘ë‹µí•˜ì˜€ìŒ

ê³ ë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ í†µí•©ì§€ì›íŒ€ ìš´ì˜ ê³¼ì •ì—ì„œ ì–´ë ¤ì›€ì„ ê²ªëŠ” ë¶„ì•¼ì— ëŒ€í•´ í•™ìƒ ì§€ì› ë°©ì•ˆì˜ ë³µì¡ì„±ìœ¼ë¡œ ì‘ë‹µí•œ ê±´ìˆ˜ê°€ 97ê±´(31.7%)ì´ê³  ëª…í™•í•œ ìš´ì˜ ë°©ì¹¨ ë¶€ì¬ë¼ê³  ì‘ë‹µí•œ ê±´ìˆ˜ëŠ” 64ê±´(20.9%), ì™¸ë¶€ê¸°ê´€ê³¼ì˜ ì—°ê³„ ì–´ë ¤ì›€ìœ¼ë¡œ 41ê±´(13.4%), í•™ìƒ ê´€ë¦¬ ì‹œìŠ¤í…œ ë¶€ì¬ë¼ëŠ” ì‘ë‹µê±´ìˆ˜ëŠ” 29ê±´(9.5%), êµìœ¡êµ¬ì„±ì› ê°„ í˜‘ë ¥ë¶€ì¡±ì€ 25ê±´(8.2%) ë“±ì´ë¼ê³  ì‘ë‹µí•˜ì˜€ìŒ

íŠ¹ìˆ˜í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ í†µí•©ì§€ì›íŒ€ ìš´ì˜ ê³¼ì •ì—ì„œ ì–´ë ¤ì›€ì„ ê²ªëŠ” ë¶„ì•¼ì— ëŒ€í•´ ì™¸ë¶€ê¸°ê´€ê³¼ì˜ ì—°ê³„ ì–´ë ¤ì›€ì´ë¼ê³  ì‘ë‹µí•œ ê±´ìˆ˜ê°€ 3ê±´(42.9%)ì´ê³  êµì‚¬ì˜ ì¸ì‹ë¶€ì¡±ìœ¼ë¡œ ì‘ë‹µí•œ ê±´ìˆ˜ëŠ” 1ê±´(14.3%), êµìœ¡êµ¬ì„±ì› ê°„ í˜‘ë ¥ë¶€ì¡±ìœ¼ë¡œ ì‘ë‹µí•œ ê±´ìˆ˜ëŠ” 1ê±´(14.33%), ëª…í™•í•œ ìš´ì˜ ë°©ì¹¨ ë¶€ì¬ë¼ê³  ì‘ë‹µí•œ ê±´ìˆ˜ëŠ” 1ê±´(14.3%), í•™ìƒ ì§€ì› ë°©ì•ˆì˜ ë³µì¡ì„±ì´ë¼ê³  ì‘ë‹µí•œ ê±´ìˆ˜ê°€ 1ê±´(14.3%)ë¼ê³  ì‘ë‹µí•˜ì˜€ìŒ

ê°ì¢…í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ í†µí•©ì§€ì›íŒ€ ìš´ì˜ ê³¼ì •ì—ì„œ ì–´ë ¤ì›€ì„ ê²ªëŠ” ë¶„ì•¼ì— ëŒ€í•´ êµìœ¡êµ¬ì„±ì› ê°„ í˜‘ë ¥ë¶€ì¡±ì´ë¼ëŠ” ì‘ë‹µê±´ìˆ˜ëŠ” 2ê±´(25%), í•™ìƒ ê´€ë¦¬ ì‹œìŠ¤í…œ ë¶€ì¬ë¼ëŠ” ì‘ë‹µê±´ìˆ˜ëŠ” 2ê±´(25%), êµì‚¬ì˜ ì¸ì‹ë¶€ì¡±ìœ¼ë¡œ ì‘ë‹µí•œ ê±´ìˆ˜ê°€ 1ê±´(12.5%), ëª…í™•í•œ ìš´ì˜ ë°©ì¹¨ ë¶€ì¬ë¼ê³  ì‘ë‹µí•œ ê±´ìˆ˜ëŠ” 1ê±´(12.5%), ì™¸ë¶€ê¸°ê´€ê³¼ì˜ ì—°ê³„ ì–´ë ¤ì›€ì´ë¼ê³  ì‘ë‹µí•œ ê±´ìˆ˜ëŠ” 1ê±´(12.5%), í•™ìƒ ì§€ì› ë°©ì•ˆì˜ ë³µì¡ì„±ì´ë¼ê³ 

```{r}
#| echo: false
#| warning: false
#| message: false
dat_q22_long <- dat_trimed %>%
  filter(!is.na(ques_20), !is.na(ques_21), !is.na(ques_22)) %>%
  filter(as.character(ques_20) %in% as.character(1:5)) %>%  # ë¬¸í•­20 ì¡°ê±´ ìœ ì§€
  separate_rows(ques_22, sep = ",\\s*") %>%
  mutate(ques_22 = str_trim(as.character(ques_22))) %>%
  filter(ques_22 %in% as.character(1:7)) %>%  # ë¬¸í•­22ê°€ 1~7ì¸ ê²½ìš°ë§Œ
  mutate(
    ë¬¸í•­22 = recode(ques_22,
                   "1" = "ëª…í™•í•œ ìš´ì˜ ë°©ì¹¨ ë¶€ì¬",
                   "2" = "í•™ìƒ ê´€ë¦¬ ì‹œìŠ¤í…œ ë¶€ì¬",
                   "3" = "êµì‚¬ì˜ ì¸ì‹ ë¶€ì¡±",
                   "4" = "êµìœ¡êµ¬ì„±ì› ê°„ í˜‘ë ¥ë¶€ì¡±",
                   "5" = "í•™ìƒ ì§€ì› ë°©ì•ˆì˜ ë³µì¡ì„±",
                   "6" = "ì™¸ë¶€ê¸°ê´€ê³¼ì˜ ì—°ê³„ ì–´ë ¤ì›€",
                   "7" = "ê¸°íƒ€",
                   .default = "ê¸°íƒ€")
  )

# ê¸°ìˆ í†µê³„
summary_q22 <- dat_q22_long %>%
  group_by(í•™êµê¸‰, ë¬¸í•­22) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

# í•©ê³„ ì¶”ê°€
summary_q22_total <- summary_q22 %>%
  group_by(í•™êµê¸‰) %>%
  summarise(n = sum(n), pct = 100, ë¬¸í•­22 = "í•©ê³„", .groups = "drop") %>%
  bind_rows(summary_q22) %>%
  arrange(í•™êµê¸‰,  # school_levels5 ì˜ì¡´ì„± ì œê±°
          if_else(ë¬¸í•­22 == "í•©ê³„", 2, 1),
          desc(n))

print(summary_q22_total, n = Inf)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# ì‹œê°í™”
ggplot(
  summary_q22 %>%
    mutate(ë¬¸í•­22 = reorder(ë¬¸í•­22, -n)),   # n ê¸°ì¤€ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
  aes(x = ë¬¸í•­22, y = n, fill = ë¬¸í•­22)
) +
  geom_bar(stat = "identity", width = 0.7) +
  geom_text(aes(label = paste0(n,"ê±´(",pct,"%)"), 
                y = n + max(n) * 0.05),  # ìµœëŒ€ê°’ì˜ 5%ë§Œí¼ ìœ„ì— ìœ„ì¹˜
            vjust = 0.15, hjust = 0.5, size = 4.5, lineheight = 0.4) +
  facet_wrap(~í•™êµê¸‰, ncol = 1, scales = "free_y") +
  labs(
    title = "í•™ìƒë§ì¶¤í†µí•©ì§€ì› ìš´ì˜ì˜ ì–´ë ¤ì›€",
    x = "ìš´ì˜ê³¼ì •ì˜ ì–´ë ¤ì›€ ìœ í˜•",
    y = "ì‘ë‹µìˆ˜"
  ) +
  scale_x_discrete(labels = c("ëª…í™•í•œ ìš´ì˜\në°©ì¹¨ ë¶€ì¬", "í•™ìƒ ê´€ë¦¬\nì‹œìŠ¤í…œ ë¶€ì¬", "êµì‚¬ì˜\nì¸ì‹ ë¶€ì¡±", "êµìœ¡êµ¬ì„±ì› ê°„\ní˜‘ë ¥ë¶€ì¡±", "í•™ìƒ ì§€ì› ë°©ì•ˆì˜\në³µì¡ì„±", "ì™¸ë¶€ê¸°ê´€ê³¼ì˜\nì—°ê³„ ì–´ë ¤ì›€", "ê¸°íƒ€")) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
    legend.position = "none",
    axis.text.x = element_text(angle = 0, vjust = 0.8, lineheight = 0.4, size = 15),
    axis.text.y = element_text(size = 15),
    strip.text = element_text(face = "bold", size = 20),
    axis.title.x = element_text(size = 20, margin = margin(t = 18)),
    axis.title.y = element_text(angle = 0, vjust = 0.5, size = 20)
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.15))) +
  coord_cartesian(clip = "off")
```

### ë¬¸í•­23. í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ê³¼ ì§€ì—­ê¸°ê´€(êµìœ¡ì§€ì›ì²­ ìš´ì˜ ê°ì¢…ì„¼í„° ë“± í¬í•¨)ì´ ì—°ê³„í•˜ì—¬ í•™ìƒì„ ì§€ì›í•œ ì ì´ ìˆìŠµë‹ˆê¹Œ?

â‘  ê·¸ë ‡ë‹¤ â‘¡ ì•„ë‹ˆë‹¤

í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ì´ ì§€ì—­ê¸°ê´€ê³¼ ì—°ê³„í•˜ì—¬ í•™ìƒì„ ì§€ì›í•œ ì ì´ ìˆëŠ”ì§€ì— ëŒ€í•œ ì„¤ë¬¸ì— ì´ ì‘ë‹µìëŠ” 838ëª…ì´ê³  ì´ˆë“±í•™êµ ì‘ë‹µìëŠ” 394ëª…(47%) ì¤‘í•™êµ ì‘ë‹µìëŠ” 272ëª…(32.4%)ì´ê³  ê³ ë“±í•™êµ ì‘ë‹µìëŠ” 165ëª…(19.7%)ì´ê³ , íŠ¹ìˆ˜í•™êµ ì‘ë‹µìëŠ” 3ëª…(0.4%)ì´ê³  ê°ì¢…í•™êµ ì‘ë‹µìëŠ” 4ëª…(0.5%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¨

ì´ˆë“±í•™êµì—ì„œ í†µí•©ì§€ì›íŒ€ì´ ì§€ì—­ê¸°ê´€ê³¼ ì—°ê³„í•´ì„œ ì§€ì›í•œ ì ì´ ìˆë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 296ëª…(75.1%)ì´ê³  ì§€ì›í•˜ì§€ ì•Šì•˜ë‹¤ëŠ” ì‘ë‹µìëŠ” 98ëª…(24.9%)ì˜€ìŒ

ì¤‘í•™êµì—ì„œ í†µí•©ì§€ì›íŒ€ì´ ì§€ì—­ê¸°ê´€ê³¼ ì—°ê³„í•´ì„œ ì§€ì›í•œ ì ì´ ìˆë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 202ëª…(74.3%)ì´ê³  ì§€ì›í•˜ì§€ ì•Šì•˜ë‹¤ëŠ” ì‘ë‹µì§€ëŠ” 70ëª…(25.7%)ì˜€ìŒ

ê³ ë“±í•™êµì—ì„œ í†µí•©ì§€ì›íŒ€ì´ ì§€ì—­ê¸°ê´€ê³¼ ì—°ê³„í•´ì„œ ì§€ì›í•œ ì ì´ ìˆë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 91ëª…(55.2%)ì´ê³  ì§€ì›í•˜ì§€ ì•Šì•˜ë‹¤ëŠ” ì‘ë‹µìëŠ” 74ëª…(44.8%)ì˜€ìŒ

íŠ¹ìˆ˜í•™êµì—ì„œ í†µí•©ì§€ì›íŒ€ì´ ì§€ì—­ê¸°ê´€ê³¼ ì—°ê³„í•´ì„œ ì§€ì›í•œ ì ì´ ìˆë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 1ëª…(33.3%)ì´ê³  ì§€ì›í•˜ì§€ ì•Šì•˜ë‹¤ëŠ” ì‘ë‹µìëŠ” 2ëª…6.6%)ì˜€ìŒ

ê°ì¢…í•™êµì—ì„œ í†µí•©ì§€ì›íŒ€ì´ ì§€ì—­ê¸°ê´€ê³¼ ì—°ê³„í•´ì„œ ì§€ì›í•œ ì ì´ ìˆë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µì 3ëª…5%)ì´ê³  ì§€ì›í•˜ì§€ ì•Šì•˜ë‹¤ëŠ” ì‘ë‹µì 1ëª…5%)ì˜€ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
# ë¬¸í•­23 ë°ì´í„° ì²˜ë¦¬ (ê°„ì†Œí™”ëœ ë²„ì „)
dat_q23 <- dat_trimed %>%
  filter(!is.na(ques_20), !is.na(ques_21), !is.na(ques_22), !is.na(ques_23)) %>%
  filter(as.character(ques_20) %in% as.character(1:5)) %>%  # ë¬¸í•­20 ì¡°ê±´ ìœ ì§€
  mutate(
    ë¬¸í•­23 = recode(as.character(ques_23),
                   "1" = "ê·¸ë ‡ë‹¤",
                   "2" = "ì•„ë‹ˆë‹¤",
                   .default = "ê¸°íƒ€"),
    ë¬¸í•­23 = factor(ë¬¸í•­23, levels = c("ê·¸ë ‡ë‹¤", "ì•„ë‹ˆë‹¤"))
  )

# ê¸°ìˆ í†µê³„
summary_q23 <- dat_q23 %>%
  group_by(í•™êµê¸‰, ë¬¸í•­23) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

# í•©ê³„ ì¶”ê°€
summary_q23_total <- summary_q23 %>%
  group_by(í•™êµê¸‰) %>%
  summarise(n = sum(n), pct = 100, ë¬¸í•­23 = "í•©ê³„", .groups = "drop") %>%
  bind_rows(summary_q23) %>%
  arrange(í•™êµê¸‰,  # school_levels5 ì˜ì¡´ì„± ì œê±°
          if_else(ë¬¸í•­23 == "í•©ê³„", 2, 1),
          desc(n))

print(summary_q23_total, n = Inf)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# ì‹œê°í™” (3í–‰ 2ì—´)
ggplot(summary_q23, aes(x = ë¬¸í•­23, y = n, fill = ë¬¸í•­23)) +
  geom_bar(stat="identity", width=0.7) +
  geom_text(aes(label = paste0(n,"ëª…\n(",pct,"%)"),
                y = n),  # ë§‰ëŒ€ ë°”ë¡œ ìœ„ì— ìœ„ì¹˜
            hjust=0.5, vjust=-0.1, size=6, fontface="bold", lineheight=0.5) +
  facet_wrap(~í•™êµê¸‰, ncol = 2, nrow = 3) +  # 3í–‰ 2ì—´ ë°°ì¹˜
  labs(
    title = "í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€\n ì§€ì—­ê¸°ê´€ ì—°ê³„ì—¬ë¶€",
    x = "ì—°ê³„ì—¬ë¶€",
    y = "ì‘ë‹µìˆ˜"
  ) +
  scale_x_discrete(labels = c("ê·¸ë ‡ë‹¤", "ì•„ë‹ˆë‹¤")) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face="bold", size=32, hjust=0.5, margin = margin(b = 18), lineheight = 0.5),
    legend.position = "none",
    axis.text.x = element_text(angle=0, hjust=0.5, size=18, lineheight=0.6),
    axis.text.y = element_text(size=18),
    axis.title.x = element_text(size=20, margin = margin(t = 18)),
    axis.title.y = element_text(angle = 0, vjust = 0.5, size=20),
    strip.text = element_text(face="bold", size=18, margin = margin(t = 6, b = 6)),
    panel.spacing = unit(1.5, "lines"),
    plot.margin = margin(20, 20, 20, 20)
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.25))) +
  coord_cartesian(clip = "off")
```

### ë¬¸í•­24.\[23ë²ˆ ë¬¸í•­ì— â‘ ë¡œ ë‹µë³€í•œ ì‘ë‹µìë§Œ ì‘ë‹µ\] í•™ìƒì§€ì›ì„ ìœ„í•´ ì—°ê³„ã†í˜‘ë ¥í•˜ëŠ” ê¸°ê´€ì€ ì–´ë–¤ ê¸°ê´€ì…ë‹ˆê¹Œ? (ì¤‘ë³µì‘ë‹µ)

â‘  ì§€ì—­êµìœ¡ë³µì§€ì„¼í„° â‘¡ ìœ„(Wee)ì„¼í„° â‘¢ ì§€ì—­í•™ìŠµì§„ë‹¨ì„±ì¥ì„¼í„° â‘£ êµ¬ì²­ â‘¤ ë™ì£¼ë¯¼ì„¼í„° â‘¥ ë³µì§€ê´€ â‘¦ ì²­ì†Œë…„ìƒë‹´ë³µì§€ì„¼í„° â‘§ ì²­ì†Œë…„ì„¼í„° â‘¨ ê°€ì¡±ì„¼í„° â‘© ê¸°íƒ€

í•™ìƒì§€ì›ì„ ìœ„í•´ ì—°ê³„ã†í˜‘ë ¥í•˜ëŠ” ê¸°ê´€ì— ëŒ€í•œ ì„¤ë¬¸ì— ì´ ì‘ë‹µê±´ìˆ˜ëŠ” 1,436ê±´ì´ê³  ì´ˆë“±í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 712ê±´(49.6%) ì¤‘í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 490ê±´(34.1%)ì´ê³  ê³ ë“±í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 223ê±´(15.5%)ì´ê³ , íŠ¹ìˆ˜í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 3ê±´(0.2%)ì´ê³  ê°ì¢…í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 8ê±´(0.6%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¨

ì´ˆë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ í•™ìƒì§€ì›ì„ ìœ„í•´ ì—°ê³„ã†í˜‘ë ¥í•œ ì§€ì—­ê¸°ê´€ìœ¼ë¡œ ì§€ì—­êµìœ¡ë³µì§€ì„¼í„°ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 226ê±´(31.7%), ìœ„(Wee)ì„¼í„°ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 168ê±´(23.6%), ì²­ì†Œë…„ìƒë‹´ë³µì§€ì„¼í„°ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 89ê±´(12.5%), êµ¬ì²­ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 49ê±´(6.9%), ì§€ì—­í•™ìŠµì§„ë‹¨ì„±ì¥ì„¼í„°ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 44ê±´(6.2%) ë³µì§€ê´€ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 43ê±´(6%), ì£¼ë¯¼ì„¼í„°ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 36ê±´(5.1%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ì¤‘í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ í•™ìƒì§€ì›ì„ ìœ„í•´ ì—°ê³„ã†í˜‘ë ¥í•œ ì§€ì—­ê¸°ê´€ìœ¼ë¡œ ì§€ì—­êµìœ¡ë³µì§€ì„¼í„°ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 136ê±´(27.8%), ìœ„(Wee)ì„¼í„°ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 109ê±´(22.2%), ì²­ì†Œë…„ìƒë‹´ë³µì§€ì„¼í„°ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 96ê±´(19.6%), êµ¬ì²­ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 34ê±´(6.9%), ë³µì§€ê´€ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 33ê±´(6.7%) ì£¼ë¯¼ì„¼í„°ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 29ê±´(5.9%), ì§€ì—­í•™ìŠµì§„ë‹¨ì„±ì¥ì„¼í„°ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 20ê±´(4.1%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê³ ë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ í•™ìƒì§€ì›ì„ ìœ„í•´ ì—°ê³„ã†í˜‘ë ¥í•œ ì§€ì—­ê¸°ê´€ìœ¼ë¡œ ì§€ì—­êµìœ¡ë³µì§€ì„¼í„°ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 79ê±´(35.4%), ìœ„(Wee)ì„¼í„°ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 54ê±´(24.2%), ì²­ì†Œë…„ìƒë‹´ë³µì§€ì„¼í„°ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 46ê±´(20.6%), ì²­ì†Œë…„ì„¼í„°ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 11ê±´(4.9%), ë³µì§€ê´€ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 9ê±´(4%), ì§€ì—­í•™ìŠµì§„ë‹¨ì„±ì¥ì„¼í„°ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 5ê±´(2.2%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

íŠ¹ìˆ˜í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ êµí•™ìƒì§€ì›ì„ ìœ„í•´ ì—°ê³„ã†í˜‘ë ¥í•œ ì§€ì—­ê¸°ê´€ìœ¼ë¡œ ê°€ì¡±ì„¼í„°ì„¼í„°ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 1ê±´(33.3%), ìœ„(Wee)ì„¼í„°ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 1ê±´(33.3%), ì§€ì—­êµìœ¡ë³µì§€ì„¼í„°ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 1ê±´(33.3%)ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê°ì¢…í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ í•™ìƒì§€ì›ì„ ìœ„í•´ ì—°ê³„ã†í˜‘ë ¥í•œ ì§€ì—­ê¸°ê´€ìœ¼ë¡œ ìœ„(Wee)ì„¼í„°ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 3ê±´(37.5%), ì£¼ë¯¼ì„¼í„°ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 1ê±´(12.5%), ë³µì§€ê´€ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 1ê±´(12.5%), ì§€ì—­êµìœ¡ë³µì§€ì„¼í„°ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 1ê±´(12.5%), ì§€ì—­í•™ìŠµì§„ë‹¨ì„±ì¥ì„¼í„°ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 1ê±´(12.5%), ì²­ì†Œë…„ìƒë‹´ë³µì§€ì„¼í„°ë¼ê³  ì‘ë‹µí•œ ê±´ìˆ˜ëŠ” 1ê±´(12.5%)ë¡œ ë‚˜íƒ€ë‚¬ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
dat_q24_long <- dat_trimed %>%
  filter(!is.na(ques_23), !is.na(ques_24)) %>%
  filter(as.character(ques_23) == "1") %>%  # ë¬¸í•­23ì—ì„œ "ê·¸ë ‡ë‹¤"ì¸ ê²½ìš°ë§Œ
  separate_rows(ques_24, sep = ",\\s*") %>%
  mutate(ques_24 = str_trim(as.character(ques_24))) %>%
  filter(ques_24 %in% as.character(1:10)) %>%
  mutate(
    ë¬¸í•­24 = recode(ques_24,
                   "1" = "ì§€ì—­êµìœ¡ë³µì§€ì„¼í„°",
                   "2" = "ìœ„(Wee)ì„¼í„°",
                   "3" = "ì§€ì—­í•™ìŠµì§„ë‹¨ì„±ì¥ì„¼í„°",
                   "4" = "êµ¬ì²­",
                   "5" = "ë™ì£¼ë¯¼ì„¼í„°",
                   "6" = "ë³µì§€ê´€",
                   "7" = "ì²­ì†Œë…„ìƒë‹´ë³µì§€ì„¼í„°",
                   "8" = "ì²­ì†Œë…„ì„¼í„°",
                   "9" = "ê°€ì¡±ì„¼í„°",
                   "10" = "ê¸°íƒ€",
                   .default = "ê¸°íƒ€")
  )

# ê¸°ìˆ í†µê³„
summary_q24 <- dat_q24_long %>%
  group_by(í•™êµê¸‰, ë¬¸í•­24) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

summary_q24_total <- summary_q24 %>%
  group_by(í•™êµê¸‰) %>%
  summarise(n = sum(n), pct = 100, ë¬¸í•­24 = "í•©ê³„", .groups = "drop") %>%
  bind_rows(summary_q24) %>%
  arrange(í•™êµê¸‰, if_else(ë¬¸í•­24 == "í•©ê³„", 2, 1), desc(n))

print(summary_q24_total, n = Inf)
```

```{r}
#| echo: false
#| warning: false
#| message: false
ggplot(summary_q24 %>% mutate(ë¬¸í•­24 = reorder(ë¬¸í•­24, -n)), aes(x = ë¬¸í•­24, y = n, fill = ë¬¸í•­24)) +
  geom_bar(stat = "identity", width = 0.7) +
  geom_text(aes(label = paste0(n,"ê±´\n(",pct,"%)"), y = n + max(n) * 0.05),
            vjust = 0, hjust = 0.5, size = 5, lineheight = 0.4) +
  facet_wrap(~í•™êµê¸‰, ncol = 1, scales = "free_y") +
  labs(title = "ì—°ê³„í˜‘ë ¥ ê¸°ê´€", x = "ê¸°ê´€ ìœ í˜•", y = "ì‘ë‹µìˆ˜") +
  scale_x_discrete(labels = c("ì§€ì—­êµìœ¡\në³µì§€ì„¼í„°", "ìœ„(Wee)\nì„¼í„°", "ì§€ì—­í•™ìŠµ\nì§„ë‹¨ì„±ì¥\nì„¼í„°", "êµ¬ì²­", "ë™ì£¼ë¯¼\nì„¼í„°", "ë³µì§€ê´€", "ì²­ì†Œë…„\nìƒë‹´ë³µì§€\nì„¼í„°","ì²­ì†Œë…„\nì„¼í„°","ê°€ì¡±ì„¼í„°","ê¸°íƒ€")) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
    legend.position = "none",
    axis.text.x = element_text(angle = 0, vjust = 0.8, lineheight = 0.7, size = 15),
    axis.text.y = element_text(size = 15),
    strip.text = element_text(face = "bold", size = 20),
    axis.title.x = element_text(size = 20, margin = margin(t = 18)),
    axis.title.y = element_text(angle = 0, vjust = 0.5, size = 20)
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.15))) +
  coord_cartesian(clip = "off")
```

### ë¬¸í•­25. 2025ë…„ ìƒë°˜ê¸°(1ì›”\~6ì›” í˜„ì¬)ì— í•™ìƒë§ì¶¤í†µí•©ì§€ì›ì— ëŒ€í•œ êµì§ì› ì—°ìˆ˜ëŠ” ëª‡ íšŒ ì‹¤ì‹œí•˜ì˜€ìŠµë‹ˆê¹Œ?

â‘  1íšŒ â‘¡ 2íšŒ â‘¢ 3íšŒì´ìƒ â‘£ ë¯¸ì‹¤ì‹œ

2025ë…„ë„ ìƒë°˜ê¸° ë™ì•ˆ ì‹¤ì‹œí•œ êµì§ì› ì—°ìˆ˜ íšŸìˆ˜ì— ëŒ€í•œ ì„¤ë¬¸ì— ì‘ë‹µìëŠ” ì´ 1,155ëª…ì´ë©° ì´ˆë“±í•™êµ ì‘ë‹µìëŠ” 518ëª…(44.8%), ì¤‘í•™êµ ì‘ë‹µìëŠ” 347ëª…(30%), ê³ ë“±í•™êµ ì‘ë‹µìëŠ” 264ëª…(22.9%), íŠ¹ìˆ˜í•™êµ ì‘ë‹µìëŠ” 17ëª…(1.5%), ê°ì¢…í•™êµ ì‘ë‹µìëŠ” 9ëª…(0.8%)ì´ì—ˆìŒ

ì´ˆë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ 1íšŒ ì‹¤ì‹œí–ˆë‹¤ëŠ” ì‘ë‹µì€ 278ëª…(53.7%), 2íšŒ ì‹¤ì‹œí–ˆë‹¤ëŠ” ì‘ë‹µì€ 27ëª…(5.2%), 3íšŒ ì´ìƒ ì‹¤ì‹œí–ˆë‹¤ëŠ” ì‘ë‹µì€ 6ëª…(1.2%), ë¯¸ì‹¤ì‹œëŠ” 207ëª…(40%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ì¤‘í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ 1íšŒ ì‹¤ì‹œí–ˆë‹¤ëŠ” ì‘ë‹µì€ 197ëª…(56.8%), 2íšŒ ì‹¤ì‹œí–ˆë‹¤ëŠ” ì‘ë‹µì€ 24ëª…(6.9%), 3íšŒ ì´ìƒ ì‹¤ì‹œí–ˆë‹¤ëŠ” ì‘ë‹µì€ 6ëª…(1.7%), ë¯¸ì‹¤ì‹œëŠ” 120ëª…(34.6%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê³ ë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ 1íšŒ ì‹¤ì‹œí–ˆë‹¤ëŠ” ì‘ë‹µì€ 278ëª…(46.2%), 2íšŒ ì‹¤ì‹œí–ˆë‹¤ëŠ” ì‘ë‹µì€ 6ëª…(2.3%), ë¯¸ì‹¤ì‹œëŠ” 136ëª…(51.5%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

íŠ¹ìˆ˜í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ 1íšŒ ì‹¤ì‹œí–ˆë‹¤ëŠ” ì‘ë‹µì€ 1ëª…(5.9%), 2íšŒ ì‹¤ì‹œí–ˆë‹¤ëŠ” ì‘ë‹µì€ 1ëª…(5.9%), 3íšŒ ì´ìƒ ì‹¤ì‹œí–ˆë‹¤ëŠ” ì‘ë‹µì€ 1ëª…(5.9%), ë¯¸ì‹¤ì‹œëŠ” 14ëª…(82.3%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê°ì¢…í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ 1íšŒ ì‹¤ì‹œí–ˆë‹¤ëŠ” ì‘ë‹µì€ 1ëª…(11.1%), 2íšŒ ì‹¤ì‹œí–ˆë‹¤ëŠ” ì‘ë‹µì€ 1ê±´(11.1%), ë¯¸ì‹¤ì‹œëŠ” 7ëª…(77.8%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
# ë°ì´í„° ì²˜ë¦¬
dat_q25 <- dat_trimed %>%
  filter(!is.na(ques_25)) %>%
  mutate(
    ë¬¸í•­25 = recode(as.character(ques_25),
                   "1" = "1íšŒ",
                   "2" = "2íšŒ",
                   "3" = "3íšŒ ì´ìƒ",
                   "4" = "ë¯¸ì‹¤ì‹œ",
                   .default = "ê¸°íƒ€"),
    ë¬¸í•­25 = factor(ë¬¸í•­25, levels = c("1íšŒ", "2íšŒ", "3íšŒ ì´ìƒ", "ë¯¸ì‹¤ì‹œ"))
  )

# ê¸°ìˆ í†µê³„
summary_q25 <- dat_q25 %>%
  group_by(í•™êµê¸‰, ë¬¸í•­25) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

summary_q25_total <- summary_q25 %>%
  group_by(í•™êµê¸‰) %>%
  summarise(n = sum(n), pct = 100, ë¬¸í•­25 = "í•©ê³„", .groups = "drop") %>%
  bind_rows(summary_q25) %>%
  arrange(í•™êµê¸‰, if_else(ë¬¸í•­25 == "í•©ê³„", 2, 1), desc(n))

print(summary_q25_total, n = Inf)
```

```{r}
#| echo: false
#| warning: false
#| message: false

# ì‹œê°í™”
ggplot(summary_q25 %>% mutate(ë¬¸í•­25 = reorder(ë¬¸í•­25, -n)), aes(x = ë¬¸í•­25, y = n, fill = ë¬¸í•­25)) +
  geom_bar(stat = "identity", width = 0.7) +
  geom_text(aes(label = paste0(n,"ëª…\n(",pct,"%)"), y = n + max(n) * 0.05),
            vjust = -0.2, hjust = 0.5, size = 6.5, lineheight = 0.4) +
  facet_wrap(~í•™êµê¸‰, ncol = 1, scales = "free_y") +
  labs(title = "êµì§ì› ì—°ìˆ˜ ì‹¤ì‹œ íšŸìˆ˜", x = "ì—°ìˆ˜ íšŸìˆ˜", y = "ì‘ë‹µìˆ˜") +
  scale_x_discrete(labels = c("1íšŒ", "2íšŒ", "3íšŒ ì´ìƒ", "ë¯¸ì‹¤ì‹œ")) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
    legend.position = "none",
    axis.text.x = element_text(angle = 0, vjust = 0.8, lineheight = 0.7, size = 20),
    axis.text.y = element_text(size = 20),
    strip.text = element_text(face = "bold", size = 20),
    axis.title.x = element_text(size = 20, margin = margin(t = 18)),
    axis.title.y = element_text(angle = 0, vjust = 0.5, size = 20)
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.15))) +
  coord_cartesian(clip = "off")
```

### ë¬¸í•­26. êµì§ì› ì—°ìˆ˜ë¥¼ ì‹¤ì‹œí–ˆë‹¤ë©´, ì—°ìˆ˜ë‚´ìš©ì€ ë¬´ì—‡ì´ì—ˆìŠµë‹ˆê¹Œ? (ì¤‘ë³µì‘ë‹µ)

â‘  í•™ìƒë§ì¶¤í†µí•©ì§€ì› ì •ì±…ì´í•´ â‘¡ í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ ìš´ì˜ì ˆì°¨ â‘¢ í•™ìƒë§ì¶¤í†µí•©ì§€ì› ì§€ì›ì‚¬ë¡€ â‘£ ê¸°íƒ€(ì£¼ê´€ì‹)

êµì§ì› ì—°ìˆ˜ë¥¼ ì‹¤ì‹œí•œ ê²½ìš° ì—°ìˆ˜ë‚´ìš©ì— ëŒ€í•œ ì„¤ë¬¸ì— ì‘ë‹µê±´ìˆ˜ëŠ” ì´ 895ê±´ì´ë©° ì´ˆë“±í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 415ê±´(46.4%), ì¤‘í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 313ê±´(35%), ê³ ë“±í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 161ê±´(18%), íŠ¹ìˆ˜í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 4ê±´(0.4%), ê°ì¢…í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 2ê±´(0.2%)ì´ì—ˆìŒ

ì´ˆë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ì •ì±…ì´í•´ë¼ëŠ” ì‘ë‹µì€ 234ê±´(56.4%), ìš´ì˜ì ˆì°¨ë¼ëŠ” ì‘ë‹µì€ 122ê±´(29.4%), ì§€ì›ì‚¬ë¡€ë¼ëŠ” ì‘ë‹µì€ 53ê±´(12.8%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ì¤‘í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ì •ì±…ì´í•´ë¼ëŠ” ì‘ë‹µì€ 172ê±´(55%), ìš´ì˜ì ˆì°¨ë¼ëŠ” ì‘ë‹µì€ 103ê±´(32.9%), ì§€ì›ì‚¬ë¡€ë¼ëŠ” ì‘ë‹µì€ 33ê±´(10.5%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê³ ë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ì •ì±…ì´í•´ë¼ëŠ” ì‘ë‹µì€ 98ê±´(60.9%), ìš´ì˜ì ˆì°¨ë¼ëŠ” ì‘ë‹µì€ 46ê±´(28.6%), ì§€ì›ì‚¬ë¡€ë¼ëŠ” ì‘ë‹µì€ 15ê±´(9.3%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

íŠ¹ìˆ˜í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ìš´ì˜ì ˆì°¨ë¼ëŠ” ì‘ë‹µì€ 2ê±´(50%), ê¸°íƒ€ê°€ 2ê±´(50%)ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê°ì¢…í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ìš´ì˜ì ˆì°¨ë¼ëŠ” ì‘ë‹µì€ 2ê±´(100%)ë¡œ ë‚˜íƒ€ë‚¬ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false

# ë°ì´í„° ì²˜ë¦¬ (ë³µìˆ˜ì‘ë‹µ)
dat_q26_long <- dat_trimed %>%
  filter(!is.na(ques_25), !is.na(ques_26)) %>%
  filter(as.character(ques_25) %in% as.character(1:3)) %>%  # ë¬¸í•­25ì—ì„œ 1~3ì¸ ê²½ìš°ë§Œ
  separate_rows(ques_26, sep = ",\\s*") %>%
  mutate(ques_26 = str_trim(as.character(ques_26))) %>%
  filter(ques_26 %in% as.character(1:4)) %>%
  mutate(
    ë¬¸í•­26 = recode(ques_26,
                   "1" = "ì •ì±…ì´í•´",
                   "2" = "ìš´ì˜ì ˆì°¨",
                   "3" = "ì§€ì›ì‚¬ë¡€",
                   "4" = "ê¸°íƒ€",
                   .default = "ê¸°íƒ€")
  )

# ê¸°ìˆ í†µê³„
summary_q26 <- dat_q26_long %>%
  group_by(í•™êµê¸‰, ë¬¸í•­26) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

summary_q26_total <- summary_q26 %>%
  group_by(í•™êµê¸‰) %>%
  summarise(n = sum(n), pct = 100, ë¬¸í•­26 = "í•©ê³„", .groups = "drop") %>%
  bind_rows(summary_q26) %>%
  arrange(í•™êµê¸‰, if_else(ë¬¸í•­26 == "í•©ê³„", 2, 1), desc(n))

print(summary_q26_total, n = Inf)
```

```{r}
#| echo: false
#| warning: false
#| message: false

# ì‹œê°í™”
ggplot(summary_q26 %>% mutate(ë¬¸í•­26 = reorder(ë¬¸í•­26, -n)), aes(x = ë¬¸í•­26, y = n, fill = ë¬¸í•­26)) +
  geom_bar(stat = "identity", width = 0.7) +
  geom_text(aes(label = paste0(n,"ê±´\n(",pct,"%)"), y = n + max(n) * 0.05),
            vjust = -0.2, hjust = 0.5, size = 6.5, lineheight = 0.6) +
  facet_wrap(~í•™êµê¸‰, ncol = 1, scales = "free_y") +
  labs(title = "êµì§ì› ì—°ìˆ˜ ë‚´ìš©", x = "ì—°ìˆ˜ ë‚´ìš©", y = "ì‘ë‹µìˆ˜") +
  scale_x_discrete(labels = c("ì •ì±…ì´í•´", "ìš´ì˜ì ˆì°¨", "ì§€ì›ì‚¬ë¡€", "ê¸°íƒ€")) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
    legend.position = "none",
    axis.text.x = element_text(angle = 0, vjust = 0.8, lineheight = 0.7, size = 20),
    axis.text.y = element_text(size = 20),
    strip.text = element_text(face = "bold", size = 20),
    axis.title.x = element_text(size = 20, margin = margin(t = 18)),
    axis.title.y = element_text(angle = 0, vjust = 0.5, size = 20)
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.15))) +
  coord_cartesian(clip = "off")
```

### ë¬¸í•­27. êµìœ¡ë¶€ ë˜ëŠ” êµìœ¡(ì§€ì›)ì²­ì—ì„œ â€˜êµì§ì› ëŒ€ìƒ í•™ìƒë§ì¶¤í†µí•©ì§€ì› ì°¾ì•„ê°€ëŠ” ì—°ìˆ˜â€™ë¥¼ ì‹¤ì‹œí•œë‹¤ë©´ ì—°ìˆ˜ë¥¼ ì‹ ì²­í•  ì˜í–¥ì´ ìˆìœ¼ì‹­ë‹ˆê¹Œ?

â‘  ê·¸ë ‡ë‹¤ â‘¡ ì•„ë‹ˆë‹¤

êµìœ¡ì²­ì´ë‚˜ êµìœ¡ì§€ì›ì²­ì´ ì°¾ì•„ê°€ëŠ” ì—°ìˆ˜ë¥¼ ì‹œí–‰í•˜ëŠ” ê²½ìš° ì—°ìˆ˜ì— ì°¸ì—¬í•  ì˜í–¥ì´ ìˆëŠ”ì§€ì— ëŒ€í•œ ì„¤ë¬¸ì— ì‘ë‹µìëŠ” ì´ 1,155ëª…ì´ë©° ì´ˆë“±í•™êµ ì‘ë‹µìëŠ” 518ëª…(44.8%), ì¤‘í•™êµ ì‘ë‹µìëŠ” 347ê±´(30%), ê³ ë“±í•™êµ ì‘ë‹µìëŠ” 264ê±´(22.9%), íŠ¹ìˆ˜í•™êµ ì‘ë‹µìëŠ” 17ê±´(1.5%), ê°ì¢…í•™êµ ì‘ë‹µìëŠ” 9ê±´(0.8%)ì´ì—ˆìŒ

ì´ˆë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ê·¸ë ‡ë‹¤ëŠ” ì‘ë‹µì€ 265ëª…(51.2%), ì•„ë‹ˆì˜¤ë¼ëŠ” ì‘ë‹µì€ 253ëª…(48.8%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ì¤‘í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ê·¸ë ‡ë‹¤ëŠ” ì‘ë‹µì€ 201ëª…(57.9%), ì•„ë‹ˆì˜¤ë¼ëŠ” ì‘ë‹µì€ 146ëª…(42.1%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê³ ë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ê·¸ë ‡ë‹¤ëŠ” ì‘ë‹µì€ 148ëª…(56.1%), ì•„ë‹ˆì˜¤ë¼ëŠ” ì‘ë‹µì€ 116ëª…(43.9%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

íŠ¹ìˆ˜í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ê·¸ë ‡ë‹¤ëŠ” ì‘ë‹µì€ 10ëª…(58.8%), ì•„ë‹ˆì˜¤ë¼ëŠ” ì‘ë‹µì€ 7ëª…(41.2%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê°ì¢…í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ê·¸ë ‡ë‹¤ëŠ” ì‘ë‹µì€ 6ëª…(66.7%), ì•„ë‹ˆì˜¤ë¼ëŠ” ì‘ë‹µì€ 3ëª…(33.3%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
# ë°ì´í„° ì²˜ë¦¬
dat_q27 <- dat_trimed %>%
  filter(!is.na(ques_27)) %>%
  mutate(
    ë¬¸í•­27 = recode(as.character(ques_27),
                   "1" = "ê·¸ë ‡ë‹¤",
                   "2" = "ì•„ë‹ˆë‹¤",
                   .default = "ê¸°íƒ€"),
    ë¬¸í•­27 = factor(ë¬¸í•­27, levels = c("ê·¸ë ‡ë‹¤", "ì•„ë‹ˆë‹¤"))
  )

# ê¸°ìˆ í†µê³„
summary_q27 <- dat_q27 %>%
  group_by(í•™êµê¸‰, ë¬¸í•­27) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

summary_q27_total <- summary_q27 %>%
  group_by(í•™êµê¸‰) %>%
  summarise(n = sum(n), pct = 100, ë¬¸í•­27 = "í•©ê³„", .groups = "drop") %>%
  bind_rows(summary_q27) %>%
  arrange(í•™êµê¸‰, if_else(ë¬¸í•­27 == "í•©ê³„", 2, 1), desc(n))

print(summary_q27_total, n = Inf)
```

```{r}
#| echo: false
#| warning: false
#| message: false
ggplot(summary_q27, aes(x = ë¬¸í•­27, y = n, fill = ë¬¸í•­27)) +
  geom_bar(stat="identity", width=0.7) +
  geom_text(aes(label = paste0(n,"ëª…\n(",pct,"%)"), y = n),
            hjust=0.5, vjust=0, size=6, fontface="bold", lineheight=0.5) +
  facet_wrap(~í•™êµê¸‰, ncol = 2, nrow = 3) +
  labs(title = "ì°¾ì•„ê°€ëŠ” ì—°ìˆ˜ ì‹ ì²­ ì˜í–¥\n(í•™êµê¸‰ë³„)", x = "ì‹ ì²­ì˜í–¥", y = "ì‘ë‹µìˆ˜") +
  scale_x_discrete(labels = c("ê·¸ë ‡ë‹¤", "ì•„ë‹ˆë‹¤")) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face="bold", size=32, hjust=0.5, margin = margin(b = 18), lineheight = 0.5),
    legend.position = "none",
    axis.text.x = element_text(angle=0, hjust=0.5, size=20, lineheight=0.6),
    axis.text.y = element_text(size=18),
    axis.title.x = element_text(size=18, margin = margin(t = 18)),
    axis.title.y = element_text(angle = 0, vjust = 0.5, size=20),
    strip.text = element_text(face="bold", size=23, margin = margin(t = 6, b = 6)),
    panel.spacing = unit(1.5, "lines"), plot.margin = margin(20, 20, 20, 20)
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.25))) +
  coord_cartesian(clip = "off")
```

# 5. ì‹¤íƒœì¡°ì‚¬ (í•™ìƒë§ì¶¤í†µí•©ì§€ì›ì„ ìœ„í•œ êµìœ¡êµ¬ì„±ì›ì˜ í˜‘ë ¥ í•„ìš”ì„± ì¸ì‹ ì¡°ì‚¬)

### ë¬¸í•­28. í•™êµ ë‚´ ë„ì›€ì´ í•„ìš”í•œ í•™ìƒì„ ì§€ì›í•˜ê¸° ìœ„í•´ í•™êµ êµ¬ì„±ì› ê°„ í˜‘ë ¥ì´ ì¤‘ìš”í•˜ë‹¤ê³  ìƒê°í•˜ì‹­ë‹ˆê¹Œ?

â‘  ë§¤ìš° ê·¸ë ‡ë‹¤ â‘¡ ê·¸ë ‡ë‹¤ â‘¢ ë³´í†µì´ë‹¤ â‘£ ê·¸ë ‡ì§€ ì•Šë‹¤ â‘¤ ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤

í•™êµ ë‚´ ë„ì›€ì´ í•„ìš”í•œ í•™ìƒì„ ì§€ì›í•˜ê¸° ìœ„í•´ í•™êµ êµ¬ì„±ì› ê°„ í˜‘ë ¥ì˜ ì¤‘ìš”ì„± ë¬¸í•­ì— ì´ ì‘ë‹µìëŠ” 3,178ëª…ì´ë©° ë§¤ìš° ê·¸ë ‡ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 2,253ëª…(70.9%), ê·¸ë ‡ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µ 821ëª…(25.8%), ë³´í†µì´ë‹¤ë¼ê³  ë‹µë³€í•œ ì‘ë‹µì€ 85ëª…(2.7%), ê·¸ë ‡ì§€ ì•Šë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µì€ 12ëª…(0.4%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 7ëª…(0.2%)ë¡œ ë‚˜íƒ€ë‚¬ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
ques28_freq <- dat %>%
  filter(!is.na(ques_28), ques_28 %in% as.character(1:5)) %>%
  count(ques_28) %>%
  mutate(
    ì‘ë‹µ = recode(ques_28,
                 "1" = "ë§¤ìš° ê·¸ë ‡ë‹¤",
                 "2" = "ê·¸ë ‡ë‹¤", 
                 "3" = "ë³´í†µì´ë‹¤",
                 "4" = "ê·¸ë ‡ì§€ ì•Šë‹¤",
                 "5" = "ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤"),
    pct = round(n / sum(n) * 100, 1)
  ) %>%
  arrange(desc(n)) %>%
  bind_rows(summarise(., ì‘ë‹µ = "í•©ê³„", n = sum(n), pct = sum(pct)))

print(ques28_freq %>% select(ì‘ë‹µ, n, pct), n = Inf)
```

```{r}
#| echo: false
#| warning: false
#| message: false
ggplot(ques28_freq %>% filter(ì‘ë‹µ != "í•©ê³„"), aes(x = reorder(ì‘ë‹µ, -n), y = n, fill = ì‘ë‹µ)) +
  geom_bar(stat = "identity", width = 0.5) +
  geom_text(aes(label = paste0(n, "ëª… (", pct, "%)")), 
            vjust = -0.5, size = 7) +
  labs(
    title = "í•™êµ êµ¬ì„±ì› ê°„ í˜‘ë ¥ì¤‘ìš”ì„± ì¸ì‹",
    x = "í˜‘ë ¥ì¤‘ìš”ì„± ì¸ì‹",
    y = "ì‘ë‹µìˆ˜"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(size = 32, face = "bold", hjust = 0.5),
    legend.position = "none",
    axis.text.x = element_text(angle=0, hjust=0.5, size=20, lineheight=0.6),
    axis.text.y = element_text(size=20),
    axis.title.x = element_text(size=20, margin = margin(t = 18)),
    axis.title.y = element_text(angle = 0, vjust = 0.5, size=20),
    strip.text = element_text(face="bold", size=23, margin = margin(t = 6, b = 6)),
    panel.spacing = unit(1.5, "lines"), plot.margin = margin(20, 20, 20, 20)
  ) +
  ylim(0, max(ques28_freq$n) * 1.15)
```

ë¶„ì„ê³¼ì •

1\) ì‘ë‹µì ìœ í˜• ë¶„ë¥˜: ì§ì±…ë³„(í•™êµì¥, êµê°, êµì‚¬ ë“±), í•™êµê¸‰ë³„(ì´ˆë“±í•™êµ, ì¤‘í•™êµ, ê³ ë“±í•™êµ), ì„¤ë¦½ë³„(ê³µë¦½, ì‚¬ë¦½)ìœ¼ë¡œ êµ¬ë¶„í•˜ì˜€ìŒ. ìœ í˜•ë³„ ë¹„êµë¥¼ ìœ„í•´ ì‘ë‹µì ìˆ˜ê°€ ì ì€ íŠ¹ìˆ˜í•™êµ, ê°ì¢…í•™êµ ë° ê³µë¦½í•™êµëŠ” ì¡°ì‚¬ëŒ€ìƒìì—ì„œ ì œì™¸í•˜ì˜€ìŒ. ì´ì™€ ê°™ì´ ì‘ë‹µì ìœ í˜•ì„ ë¶„ë¥˜í•˜ê³  ì‘ë‹µì ì§‘ë‹¨ ê°„ì˜ ë‹µë³€ ë¶„í¬ë¥¼ ë¹„êµí•˜ì˜€ìŒ.

2\) ì‘ë‹µì ìˆ˜ ì‚°ì¶œë°©ë²•: â€˜ë§¤ìš° ê·¸ë ‡ë‹¤â€™ëŠ” 5ì ì„ ë¶€ì—¬í•˜ê³  â€˜ê·¸ë ‡ë‹¤â€™ëŠ” 4ì , â€˜ë³´í†µì´ë‹¤â€™ëŠ” 3ì , â€˜ê·¸ë ‡ì§€ ì•Šë‹¤â€™ëŠ” 2ì , â€˜ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤â€™ëŠ” 1ì ì„ ë¶€ì—¬í•˜ì—¬ ì¸ì‹ë„ ì ìˆ˜ë¥¼ ì‚°ì¶œí•˜ì˜€ìŒ.

### ë¬¸í•­ 28-1. ì§ì±…ë³„ í˜‘ë ¥ì¤‘ìš”ì„± ë¶„ì„

ì§ì±…ë³„ ì‘ë‹µìëŠ” ì´ 3,090ëª…ì´ê³  ì´ ì¤‘ì—ì„œ í•™êµì¥ì€ 474ëª…(15.34%), êµê°ì€ 761ëª…(24.63%), êµì‚¬ ë“±ì€ 1,855ëª…(60.03%)ì´ì—ˆìŒ

í•™êµì¥ ì‘ë‹µ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 390ëª…(82.3%), ê·¸ë ‡ë‹¤ëŠ” 82ëª…(17.3%), ë³´í†µì´ë‹¤ëŠ” 2ëª…(0.4%)ì´ì—ˆìŒ.

êµê° ì‘ë‹µ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 592ëª…(77.8%), ê·¸ë ‡ë‹¤ëŠ” 153ëª…(20.1%), ë³´í†µì´ë‹¤ëŠ” 13ëª…(1.7%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 3ëª…(0.4%)ì´ì—ˆìŒ

êµì‚¬ ë“± ì‘ë‹µ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 1,210ëª…(65.2%), ê·¸ë ‡ë‹¤ëŠ” 562ëª…(30.3%), ë³´í†µì´ë‹¤ëŠ” 67ëª…(3.6%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 9ëª…(0.5%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 7ëª…(0.4%)ì´ì—ˆìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
## 2. ì§ì±…ë³„ ë¶„ì„

dat_filtered <- dat_filtered %>%
  mutate(í˜‘ë ¥ì¤‘ìš”ì„± = factor(as.character(ques_28),
                   levels = c("1","2","3","4","5"),
                   labels = c("ë§¤ìš° ê·¸ë ‡ë‹¤","ê·¸ë ‡ë‹¤","ë³´í†µì´ë‹¤","ê·¸ë ‡ì§€ ì•Šë‹¤","ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤"))
  )

# ì§ì±…ë³„ êµì°¨í‘œ
summary_table_28 <- dat_filtered %>%
  group_by(ì§ì±…, í˜‘ë ¥ì¤‘ìš”ì„±) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

summary_with_total_28 <- summary_table_28 %>%
  group_by(ì§ì±…) %>%
  summarise(n = sum(n), pct = sum(pct), í˜‘ë ¥ì¤‘ìš”ì„± = "í•©ê³„") %>%
  bind_rows(summary_table_28) %>%
  arrange(
    factor(ì§ì±…, levels = c("í•™êµì¥","êµê°","êµì‚¬ ë“±")),
    í˜‘ë ¥ì¤‘ìš”ì„± == "í•©ê³„",
    if_else(í˜‘ë ¥ì¤‘ìš”ì„± != "í•©ê³„", -n, 0)
  )

summary_final_28 <- summary_with_total_28 %>%
  bind_rows(
    summary_with_total_28 %>%
      summarise(ì§ì±… = "ì „ì²´ í•©ê³„", n = sum(n[í˜‘ë ¥ì¤‘ìš”ì„± == "í•©ê³„"]), pct = 100, í˜‘ë ¥ì¤‘ìš”ì„± = "í•©ê³„")
  )

print(summary_final_28, n = Inf)

# ì¹´ì´ì œê³± ê²€ì •
tab1_28 <- table(dat_filtered$ì§ì±…, dat_filtered$í˜‘ë ¥ì¤‘ìš”ì„±)
chisq_test1_28 <- chisq.test(tab1_28)
print(chisq_test1_28)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# ëˆ„ì ë§‰ëŒ€ê·¸ë˜í”„
summary_job_28 <- dat_filtered %>%
  group_by(ì§ì±…, í˜‘ë ¥ì¤‘ìš”ì„±) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup() %>%
  mutate(í˜‘ë ¥ì¤‘ìš”ì„± = factor(í˜‘ë ¥ì¤‘ìš”ì„±, 
                        levels = c("ë§¤ìš° ê·¸ë ‡ë‹¤", "ê·¸ë ‡ë‹¤", "ë³´í†µì´ë‹¤", 
                                 "ê·¸ë ‡ì§€ ì•Šë‹¤", "ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤")))

p0_28 <- ggplot(summary_job_28, aes(x = factor(ì§ì±…, levels = c("í•™êµì¥", "êµê°", "êµì‚¬ ë“±")), 
                                    y = pct, fill = í˜‘ë ¥ì¤‘ìš”ì„±)) +
  geom_bar(stat = "identity", width = 0.7) +
  labs(
    title = "ì§ì±…ë³„ í˜‘ë ¥ì¤‘ìš”ì„± ì¸ì‹",
    x = "ì§ì±…",
    y = "ë¹„ìœ¨",
    fill = "í˜‘ë ¥ì¤‘ìš”ì„±"
  ) +
  scale_y_continuous(limits = c(0, 100), expand = expansion(mult = c(0, 0.02))) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
    axis.text.x = element_text(size = 20, face = "bold"),
    axis.text.y = element_text(size = 18),
    axis.title.x = element_text(size = 25, angle = 0, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),
    legend.position = "right",
    legend.text = element_text(size = 14),
    legend.title = element_text(size = 16, face = "bold")
  )
print(p0_28)
```

í•™êµêµ¬ì„±ì› ê°„ í˜‘ë ¥ ì¤‘ìš”ì„± ì¸ì‹ì— ëŒ€í•œ ì§ì±…ë³„ í‰ê· ì ìˆ˜ë¥¼ ë¹„êµí•œ ê²°ê³¼, í•™êµì¥(4.82), êµê°(4.75), êµì‚¬ ë“±(4.6)ìœ¼ë¡œ í•™êµì¥-êµì‚¬ ë“±, êµê°-êµì‚¬ ë“± ê°„ì—ëŠ” í•™êµêµ¬ì„±ì› ê°„ í˜‘ë ¥ì¤‘ìš”ì„±ì— ëŒ€í•œ ì¸ì‹ì°¨ì´ê°€ ìˆëŠ” ê²ƒìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìœ¼ë©°, í•™êµì¥ê³¼ êµê° ê°„ì—ëŠ” ìœ ì˜ë¯¸í•œ ì¸ì‹ì¹˜ì•„ê°€ ìˆì§€ëŠ” ì•Šì•˜ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
# ANOVA ë¶„ì„
dat_score_28 <- dat_filtered %>%
  filter(!is.na(ques_28)) %>%
  mutate(
    í˜‘ë ¥ì¤‘ìš”ì„±ì ìˆ˜ = case_when(
      ques_28 == 1 ~ 5,   # ë§¤ìš° ê·¸ë ‡ë‹¤
      ques_28 == 2 ~ 4,   # ê·¸ë ‡ë‹¤
      ques_28 == 3 ~ 3,   # ë³´í†µì´ë‹¤
      ques_28 == 4 ~ 2,   # ê·¸ë ‡ì§€ ì•Šë‹¤
      ques_28 == 5 ~ 1,   # ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤
      TRUE ~ NA_real_
    ),
    ì§ì±… = factor(ì§ì±…, levels = c("í•™êµì¥", "êµê°", "êµì‚¬ ë“±"))
  )

job_summary_28 <- dat_score_28 %>%
  group_by(ì§ì±…) %>%
  summarise(
    í‰ê·  = round(mean(í˜‘ë ¥ì¤‘ìš”ì„±ì ìˆ˜, na.rm = TRUE), 2),
    í‘œì¤€í¸ì°¨ = round(sd(í˜‘ë ¥ì¤‘ìš”ì„±ì ìˆ˜, na.rm = TRUE), 2),
    n = n(),
    .groups = "drop"
  )
print(job_summary_28)

anova_job_28 <- aov(í˜‘ë ¥ì¤‘ìš”ì„±ì ìˆ˜ ~ ì§ì±…, data = dat_score_28)
summary(anova_job_28)

tukey_job_28 <- TukeyHSD(anova_job_28)
print(tukey_job_28)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# ë°•ìŠ¤í”Œë¡¯
tukey_letters_job_28 <- multcompView::multcompLetters4(anova_job_28, tukey_job_28)
letters_df_job_28 <- data.frame(
  ì§ì±… = names(tukey_letters_job_28$`ì§ì±…`$Letters),
  group = tukey_letters_job_28$`ì§ì±…`$Letters
)

job_summary_with_groups_28 <- job_summary_28 %>%
  left_join(letters_df_job_28, by = "ì§ì±…")

ggplot(dat_score_28, aes(x = factor(ì§ì±…, levels = c("í•™êµì¥", "êµê°", "êµì‚¬ ë“±")), y = í˜‘ë ¥ì¤‘ìš”ì„±ì ìˆ˜, fill = ì§ì±…)) +
  geom_boxplot(alpha = 0.7, width = 0.6, outlier.shape = 21) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 10, fill = "yellow", stroke = 1) +
  geom_text(data = job_summary_with_groups_28, 
            aes(x = ì§ì±…, y = 8, label = paste0(group, "\n(M=", í‰ê· , ")")),
            inherit.aes = FALSE, fontface = "bold", size = 8, vjust = 0.2, lineheight=0.5) +
  labs(
    title = "ì§ì±…ë³„ í˜‘ë ¥ì¤‘ìš”ì„± ì¸ì‹",
    x = "ì§ì±…", 
    y = "í˜‘ë ¥ì¤‘ìš”ì„±\nì¸ì‹ë„"
  ) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
    axis.text.x = element_text(size = 18),
    axis.text.y = element_text(size = 18, lineheight = 0.4),
    axis.title.x = element_text(size = 20, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5, lineheight=0.5),
    legend.position = "none"
  ) +
  scale_y_continuous(expand = expansion(mult = c(0.05, 0.15)))
```

### ë¬¸í•­ 28-2. í•™êµê¸‰ë³„ í˜‘ë ¥ì¤‘ìš”ì„± ë¶„ì„

í•™êµê¸‰ë³„ ì‘ë‹µìëŠ” ì´ 3,090ëª…ì´ë©°, ì´ˆë“±í•™êµ ì‘ë‹µìëŠ” 1,277ëª…(41.33%), ì¤‘í•™êµ ì‘ë‹µìëŠ” 1,100ëª…(35.60%), ê³ ë“±í•™êµ ì‘ë‹µìëŠ” 713ëª…(23.07%)ì´ ì‘ë‹µí•˜ì˜€ìŒ.

ì´ˆë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 940ëª…(73.6%), ê·¸ë ‡ë‹¤ëŠ” 289ëª…(22.6%), ë³´í†µì´ë‹¤ëŠ” 39ëª…(3.1%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 6ëª…(0.5%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 3ëª…(0.2%)ì´ì—ˆìŒ

ì¤‘í•™êµ ì‘ë‹µê±´ìˆ˜ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 821ëª…(74.6%), ê·¸ë ‡ë‹¤ëŠ” 257ëª…(23.4%), ë³´í†µì´ë‹¤ëŠ” 17ëª…(1.5%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 4ëª…(0.4%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 1ëª…(0.1%)ì´ì—ˆìŒ

ê³ ë“±í•™êµ ì‘ë‹µê±´ìˆ˜ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 431ëª…(60.5%), ê·¸ë ‡ë‹¤ëŠ” 251ëª…(35.2%), ë³´í†µì´ë‹¤ëŠ” 26ëª…(3.6%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 3ëª…(0.4%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 2ëª…(0.3%)ì´ì—ˆìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
summary_school_table_28 <- dat_filtered %>%
  group_by(í•™êµê¸‰, í˜‘ë ¥ì¤‘ìš”ì„±) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 2)) %>%
  ungroup()

summary_school_with_total_28 <- summary_school_table_28 %>%
  group_by(í•™êµê¸‰) %>%
  summarise(n = sum(n), pct = sum(pct), í˜‘ë ¥ì¤‘ìš”ì„± = "í•©ê³„") %>%
  bind_rows(summary_school_table_28) %>%
  arrange(
    factor(í•™êµê¸‰, levels = c("ì´ˆë“±í•™êµ","ì¤‘í•™êµ","ê³ ë“±í•™êµ")),
    í˜‘ë ¥ì¤‘ìš”ì„± == "í•©ê³„",
    if_else(í˜‘ë ¥ì¤‘ìš”ì„± != "í•©ê³„", -n, 0)
  )

summary_school_final_28 <- summary_school_with_total_28 %>%
  bind_rows(
    summary_school_with_total_28 %>%
      summarise(í•™êµê¸‰ = "ì „ì²´ í•©ê³„", n = sum(n[í˜‘ë ¥ì¤‘ìš”ì„± == "í•©ê³„"]), pct = 100, í˜‘ë ¥ì¤‘ìš”ì„± = "í•©ê³„")
  )

print(summary_school_final_28, n = Inf)

# ì¹´ì´ì œê³± ê²€ì •
tab_school_28 <- table(dat_filtered$í•™êµê¸‰, dat_filtered$í˜‘ë ¥ì¤‘ìš”ì„±)
chisq_test_school_28 <- chisq.test(tab_school_28)
print(chisq_test_school_28)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# í•™êµê¸‰ë³„ êµì°¨í‘œ
school_summary_28 <- dat_score_28 %>%
  group_by(í•™êµê¸‰) %>%
  summarise(
    í‰ê·  = round(mean(í˜‘ë ¥ì¤‘ìš”ì„±ì ìˆ˜, na.rm = TRUE), 2),
    í‘œì¤€í¸ì°¨ = round(sd(í˜‘ë ¥ì¤‘ìš”ì„±ì ìˆ˜, na.rm = TRUE), 2),
    n = n(),
    .groups = "drop"
  )

summary_school_28 <- dat_filtered %>%
  group_by(í•™êµê¸‰, í˜‘ë ¥ì¤‘ìš”ì„±) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

# ëˆ„ì ë§‰ëŒ€ê·¸ë˜í”„ (ìˆ˜ì •ëœ ì½”ë“œ)
summary_school_plot_28 <- summary_school_28 %>%  # â† ì—¬ê¸°ê°€ ì¤‘ìš”!
  mutate(í˜‘ë ¥ì¤‘ìš”ì„± = factor(í˜‘ë ¥ì¤‘ìš”ì„±, 
                        levels = c("ë§¤ìš° ê·¸ë ‡ë‹¤", "ê·¸ë ‡ë‹¤", "ë³´í†µì´ë‹¤", 
                                 "ê·¸ë ‡ì§€ ì•Šë‹¤", "ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤")))

ggplot(summary_school_plot_28, aes(x = factor(í•™êµê¸‰, levels = c("ì´ˆë“±í•™êµ", "ì¤‘í•™êµ", "ê³ ë“±í•™êµ")), y = pct, fill = í˜‘ë ¥ì¤‘ìš”ì„±)) +
  geom_bar(stat = "identity", width = 0.7) +
  labs(
    title = "í•™êµê¸‰ë³„ í˜‘ë ¥ì¤‘ìš”ì„± ì¸ì‹",
    x = "í•™êµê¸‰",
    y = "ë¹„ìœ¨",
    fill = "í˜‘ë ¥ì¤‘ìš”ì„±"
  ) +
  scale_y_continuous(limits = c(0, 100), expand = expansion(mult = c(0, 0.02))) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(size = 32, face = "bold", hjust = 0.5),
    axis.text.x = element_text(size = 18, margin = margin(t = 10)),
    axis.text.y = element_text(size = 18),
    axis.title.x = element_text(size = 20, angle = 0, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),
    legend.position = "right",
    legend.text = element_text(size = 14),
    legend.title = element_text(size = 16, face = "bold")
  )
```

í•™êµêµ¬ì„±ì› ê°„ í˜‘ë ¥ ì¤‘ìš”ì„± ì¸ì‹ì— ëŒ€í•œ í•™êµê¸‰ë³„ í‰ê· ì ìˆ˜ë¥¼ ë¹„êµí•œ ê²°ê³¼, ì´ˆë“±í•™êµ(4.69), ì¤‘í•™êµ(4.72), ê³ ë“±í•™êµ(4.55)ìœ¼ë¡œ ì´ˆë“±í•™êµ-ê³ ë“±í•™êµ, ì¤‘í•™êµ-ê³ ë“±í•™êµ ê°„ì—ëŠ” í•™êµêµ¬ì„±ì› ê°„ í˜‘ë ¥ì¤‘ìš”ì„±ì— ëŒ€í•œ ì¸ì‹ ì°¨ì´ê°€ ìˆëŠ” ê²ƒìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìœ¼ë©°, ì´ˆë“±í•™êµ-ì¤‘í•™êµ ê°„ì—ëŠ” ìœ ì˜ë¯¸í•œ ì¸ì‹ì°¨ì´ê°€ ìˆì§€ëŠ” ì•Šì•˜ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
print(school_summary_28)

anova_school_28 <- aov(í˜‘ë ¥ì¤‘ìš”ì„±ì ìˆ˜ ~ í•™êµê¸‰, data = dat_score_28)
summary(anova_school_28)

tukey_school_28 <- TukeyHSD(anova_school_28)
print(tukey_school_28)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# ë°•ìŠ¤í”Œë¡¯
tukey_letters_school_28 <- multcompView::multcompLetters4(anova_school_28, tukey_school_28)
letters_df_school_28 <- data.frame(
  í•™êµê¸‰ = names(tukey_letters_school_28$`í•™êµê¸‰`$Letters),
  group = tukey_letters_school_28$`í•™êµê¸‰`$Letters
)

school_summary_with_groups_28 <- school_summary_28 %>%
  left_join(letters_df_school_28, by = "í•™êµê¸‰")

ggplot(dat_score_28, aes(x = factor(í•™êµê¸‰, levels = c("ì´ˆë“±í•™êµ", "ì¤‘í•™êµ", "ê³ ë“±í•™êµ")), y = í˜‘ë ¥ì¤‘ìš”ì„±ì ìˆ˜, fill = í•™êµê¸‰)) +
  geom_boxplot(alpha = 0.7, width = 0.6, outlier.shape = 21) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 10, fill = "yellow", stroke = 1) +
  geom_text(data = school_summary_with_groups_28, 
            aes(x = í•™êµê¸‰, y = 8, label = paste0(group, "\n(M=", í‰ê· , ")")),
            inherit.aes = FALSE, fontface = "bold", size = 8, vjust = 0, lineheight=0.5) +
  labs(
    title = "í•™êµê¸‰ë³„ í˜‘ë ¥ì¤‘ìš”ì„± ì¸ì‹",
    x = "í•™êµê¸‰", 
    y = "í˜‘ë ¥ì¤‘ìš”ì„±\nì¸ì‹ë„"
  ) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5, lineheight = 0.7),
    axis.text.x = element_text(size = 20),
    axis.text.y = element_text(size = 20),
    axis.title.x = element_text(size = 20, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5, lineheight = 0.5),
    legend.position = "none"
  ) +
  scale_y_continuous(expand = expansion(mult = c(0.05, 0.15)))
```

### ë¬¸í•­ 28-3. ì„¤ë¦½ë³„ í˜‘ë ¥ì¤‘ìš”ì„± ë¶„ì„

ì„¤ë¦½ë³„ ì‘ë‹µìëŠ” 3,090ê±´ì´ê³  ê³µë¦½í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 2,317ëª…(74.5%), ì‚¬ë¦½í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 761ëª…(25.5%)ì´ ì‘ë‹µí•˜ì˜€ìŒ.

ê³µë¦½í•™êµ ì‘ë‹µê±´ìˆ˜ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 1,660ëª…(71.6%), ê·¸ë ‡ë‹¤ëŠ” 582ëª…(25.1%), ë³´í†µì´ë‹¤ëŠ” 63ëª…(2.72%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 8ëª…(0.35%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 4ëª…(0.17%)ì´ì—ˆìŒ

ì‚¬ë¦½í•™êµ ì‘ë‹µê±´ìˆ˜ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 532ëª…(68.8%), ê·¸ë ‡ë‹¤ëŠ” 215ëª…(27.8%), ë³´í†µì´ë‹¤ëŠ” 19ëª…(2.46%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 4ëª…(0.52%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 3ëª…(0.39%)ì´ì—ˆìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
# 4. ì„¤ë¦½ë³„ ë¶„ì„


# ì„¤ë¦½ë³„ ê¸°ìˆ í†µê³„ (í•©ê³„ í¬í•¨)
summary_found_table_28 <- dat_filtered %>%
  group_by(ì„¤ë¦½, í˜‘ë ¥ì¤‘ìš”ì„±) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 2)) %>%
  ungroup()

summary_found_with_total_28 <- summary_found_table_28 %>%
  group_by(ì„¤ë¦½) %>%
  summarise(n = sum(n), pct = sum(pct), í˜‘ë ¥ì¤‘ìš”ì„± = "í•©ê³„") %>%
  bind_rows(summary_found_table_28) %>%
  arrange(ì„¤ë¦½, í˜‘ë ¥ì¤‘ìš”ì„± == "í•©ê³„", desc(n))

summary_found_final_28 <- summary_found_with_total_28 %>%
  bind_rows(
    summary_found_with_total_28 %>%
      summarise(ì„¤ë¦½ = "ì „ì²´ í•©ê³„", n = sum(n[í˜‘ë ¥ì¤‘ìš”ì„± == "í•©ê³„"]), pct = 100, í˜‘ë ¥ì¤‘ìš”ì„± = "í•©ê³„")
  )

print(summary_found_final_28, n = Inf)


# ì¹´ì´ì œê³± ê²€ì •
tab_found_28 <- table(dat_filtered$ì„¤ë¦½, dat_filtered$í˜‘ë ¥ì¤‘ìš”ì„±)
print(tab_found_28)
chisq_test_found_28 <- chisq.test(tab_found_28)
print(chisq_test_found_28)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# ëˆ„ì ë§‰ëŒ€ê·¸ë˜í”„
summary_found_plot_28 <- summary_found_table_28 %>%
  mutate(í˜‘ë ¥ì¤‘ìš”ì„± = factor(í˜‘ë ¥ì¤‘ìš”ì„±, 
                        levels = c("ë§¤ìš° ê·¸ë ‡ë‹¤", "ê·¸ë ‡ë‹¤", "ë³´í†µì´ë‹¤", 
                                 "ê·¸ë ‡ì§€ ì•Šë‹¤", "ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤")))

ggplot(summary_found_plot_28, aes(x = ì„¤ë¦½, y = pct, fill = í˜‘ë ¥ì¤‘ìš”ì„±)) +
  geom_bar(stat = "identity", width = 0.7) +
  labs(
    title = "ì„¤ë¦½ë³„ í˜‘ë ¥ì¤‘ìš”ì„± ì¸ì‹",
    x = "ì„¤ë¦½",
    y = "ë¹„ìœ¨",
    fill = "í˜‘ë ¥ì¤‘ìš”ì„±"
  ) +
  scale_y_continuous(limits = c(0, 100), expand = expansion(mult = c(0, 0.02))) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(size = 32, face = "bold", hjust = 0.5),
    axis.text.x = element_text(size = 18, margin = margin(t = 10)),
    axis.text.y = element_text(size = 18),
    axis.title.x = element_text(size = 20, angle = 0, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),
    legend.position = "right",
    legend.text = element_text(size = 14),
    legend.title = element_text(size = 16, face = "bold")
  )
```

í•™êµêµ¬ì„±ì› ê°„ í˜‘ë ¥ ì¤‘ìš”ì„± ì¸ì‹ì— ëŒ€í•œ ì„¤ë¦½ë³„ í‰ê· ì ìˆ˜ë¥¼ ë¹„êµí•œ ê²°ê³¼, ê³µë¦½í•™êµ(4.68), ì‚¬ë¦½í•™êµ(4.64)ì—ì„œ í•™êµêµ¬ì„±ì› ê°„ í˜‘ë ¥ì¤‘ìš”ì„±ì— ëŒ€í•´ ìœ ì˜ë¯¸í•œ ì°¨ì´ê°€ ìˆì§€ëŠ” ì•Šì•˜ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
# T-test ë¶„ì„
dat_score_found_28 <- dat_filtered %>%
  mutate(
    í˜‘ë ¥ì¤‘ìš”ì„±ì ìˆ˜ = case_when(
      ques_28 == 1 ~ 5,   # ë§¤ìš° ê·¸ë ‡ë‹¤
      ques_28 == 2 ~ 4,   # ê·¸ë ‡ë‹¤
      ques_28 == 3 ~ 3,   # ë³´í†µì´ë‹¤
      ques_28 == 4 ~ 2,   # ê·¸ë ‡ì§€ ì•Šë‹¤
      ques_28 == 5 ~ 1,   # ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤
      TRUE ~ NA_real_
    )
  )

summary_found_stats_28 <- dat_score_found_28 %>%
  group_by(ì„¤ë¦½) %>%
  summarise(
    í‰ê·  = round(mean(í˜‘ë ¥ì¤‘ìš”ì„±ì ìˆ˜, na.rm = TRUE), 2),
    í‘œì¤€í¸ì°¨ = round(sd(í˜‘ë ¥ì¤‘ìš”ì„±ì ìˆ˜, na.rm = TRUE), 2),
    n = n(),
    .groups = "drop"
  )

print(summary_found_stats_28)

# T-test
t_test_result_28 <- t.test(í˜‘ë ¥ì¤‘ìš”ì„±ì ìˆ˜ ~ ì„¤ë¦½, data = dat_score_found_28, var.equal = FALSE)
print(t_test_result_28)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# T-test
t_test_result_28 <- t.test(í˜‘ë ¥ì¤‘ìš”ì„±ì ìˆ˜ ~ ì„¤ë¦½, data = dat_score_found_28, var.equal = FALSE)
print(t_test_result_28)

# ë°•ìŠ¤í”Œë¡¯
if(t_test_result_28$p.value < 0.05) {
  establishment_groups_28 <- data.frame(
    ì„¤ë¦½ = c("ê³µë¦½", "ì‚¬ë¦½"),
    group = c("a", "b")
  )
} else {
  establishment_groups_28 <- data.frame(
    ì„¤ë¦½ = c("ê³µë¦½", "ì‚¬ë¦½"),
    group = c("a", "a")
  )
}

summary_found_with_groups_28 <- summary_found_stats_28 %>%
  left_join(establishment_groups_28, by = "ì„¤ë¦½")

ggplot(dat_score_found_28, aes(x = ì„¤ë¦½, y = í˜‘ë ¥ì¤‘ìš”ì„±ì ìˆ˜, fill = ì„¤ë¦½)) +
  geom_boxplot(alpha = 0.7, width = 0.6, outlier.shape = 21) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 10, fill = "yellow", stroke = 1) +
  geom_text(data = summary_found_with_groups_28, 
            aes(x = ì„¤ë¦½, y = 8, label = paste0(group, "\n(M=", í‰ê· , ")")),
            inherit.aes = FALSE, fontface = "bold", size = 8, vjust = 0, lineheight=0.5) +
  labs(
    title = "ì„¤ë¦½ë³„ í˜‘ë ¥ì¤‘ìš”ì„± ì¸ì‹",
    x = "ì„¤ë¦½", 
    y = "í˜‘ë ¥ì¤‘ìš”ì„±\nì¸ì‹ë„"
  ) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
    axis.text.x = element_text(size = 20),
    axis.text.y = element_text(size = 20),
    axis.title.x = element_text(size = 20, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5, lineheight = 0.4),
    legend.position = "none"
  ) +
  scale_y_continuous(expand = expansion(mult = c(0.05, 0.15)))
```

### ë¬¸í•­29. í•™êµ ë‚´ì—ì„œ í•™ìƒ ì§€ì›ì„ ìœ„í•´ì„œ êµìœ¡êµ¬ì„±ì› ê°„ í˜‘ë ¥ì´ ì›í™œíˆ ì´ë£¨ì–´ì§€ê³  ìˆìŠµë‹ˆê¹Œ?

â‘  ë§¤ìš° ê·¸ë ‡ë‹¤ â‘¡ ê·¸ë ‡ë‹¤ â‘¢ ë³´í†µì´ë‹¤ â‘£ ê·¸ë ‡ì§€ ì•Šë‹¤ â‘¤ ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤

í•™êµ ë‚´ì—ì„œ í•™ìƒ ì§€ì›ì„ ìœ„í•´ì„œ êµìœ¡êµ¬ì„±ì› ê°„ í˜‘ë ¥ì´ ì›í™œí•œì§€ì— ëŒ€í•œ ë¬¸í•­ì˜ ì´ ì‘ë‹µìëŠ” 3,178ëª…ì´ë©° ë§¤ìš° ê·¸ë ‡ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 1,252ëª…(43.1%), ê·¸ë ‡ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 1,371ëª…(39.4%), ë³´í†µì´ë‹¤ë¼ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 464ëª…(14.6%), ê·¸ë ‡ì§€ ì•Šë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 74ëª…(2.33%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 17ëª…(0.53%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
ques29_freq <- dat %>%
  filter(!is.na(ques_29), ques_29 %in% as.character(1:5)) %>%
  count(ques_29) %>%
  mutate(
    ì‘ë‹µ = recode(ques_29,
                 "1" = "ë§¤ìš° ê·¸ë ‡ë‹¤",
                 "2" = "ê·¸ë ‡ë‹¤", 
                 "3" = "ë³´í†µì´ë‹¤",
                 "4" = "ê·¸ë ‡ì§€ ì•Šë‹¤",
                 "5" = "ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤"),
    pct = round(n / sum(n) * 100, 2)
  ) %>%
  bind_rows(summarise(., ì‘ë‹µ = "í•©ê³„", n = sum(n), pct = sum(pct)))

print(ques29_freq %>% select(ì‘ë‹µ, n, pct), n = Inf)
```

```{r}
#| echo: false
#| warning: false
#| message: false
ggplot(ques29_freq %>% filter(ì‘ë‹µ != "í•©ê³„"), aes(x = reorder(ì‘ë‹µ, -n), y = n, fill = ì‘ë‹µ)) +
  geom_bar(stat = "identity", width = 0.5) +
  geom_text(aes(label = paste0(n, "ëª… (", pct, "%)")), 
            vjust = -0.3, size = 7) +
  labs(
    title = "êµìœ¡êµ¬ì„±ì› ê°„\n í˜‘ë ¥ ì›í™œì„±",
    x = "í˜‘ë ¥ ì›í™œì„±",
    y = "ì‘ë‹µìˆ˜"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(size = 32, face = "bold", hjust = 0.5, lineheight = 0.5),
    axis.text.x = element_text(size = 20, face = "bold"),
    axis.text.y = element_text(size = 20),
    axis.title.x = element_text(size = 20, angle = 0, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),
    legend.text = element_text(size = 14),
    legend.title = element_text(size = 16, face = "bold"),
    legend.position = "none",
    panel.spacing = unit(1.5, "lines"), plot.margin = margin(20, 20, 20, 20)
  ) +
  ylim(0, max(ques29_freq$n) * 1.15)
```

ë¶„ì„ê³¼ì •

1\) ì‘ë‹µì ìœ í˜• ë¶„ë¥˜: ì§ì±…ë³„(í•™êµì¥, êµê°, êµì‚¬ ë“±), í•™êµê¸‰ë³„(ì´ˆë“±í•™êµ, ì¤‘í•™êµ, ê³ ë“±í•™êµ), ì„¤ë¦½ë³„(ê³µë¦½, ì‚¬ë¦½)ìœ¼ë¡œ êµ¬ë¶„í•˜ì˜€ìŒ. ìœ í˜•ë³„ ë¹„êµë¥¼ ìœ„í•´ ì‘ë‹µì ìˆ˜ê°€ ì ì€ íŠ¹ìˆ˜í•™êµ, ê°ì¢…í•™êµ ë° ê³µë¦½í•™êµëŠ” ì¡°ì‚¬ëŒ€ìƒìì—ì„œ ì œì™¸í•˜ì˜€ìŒ. ì´ì™€ ê°™ì´ ì‘ë‹µì ìœ í˜•ì„ ë¶„ë¥˜í•˜ê³  ì‘ë‹µì ì§‘ë‹¨ ê°„ì˜ ë‹µë³€ ë¶„í¬ë¥¼ ë¹„êµí•˜ì˜€ìŒ

2\) ì‘ë‹µì ìˆ˜ ì‚°ì¶œë°©ë²•: â€˜ë§¤ìš° ê·¸ë ‡ë‹¤â€™ëŠ” 5ì ì„ ë¶€ì—¬í•˜ê³  â€˜ê·¸ë ‡ë‹¤â€™ëŠ” 4ì , â€˜ë³´í†µì´ë‹¤â€™ëŠ” 3ì , â€˜ê·¸ë ‡ì§€ ì•Šë‹¤â€™ëŠ” 2ì , â€˜ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤â€™ëŠ” 1ì ì„ ë¶€ì—¬í•˜ì—¬ ì¸ì‹ë„ ì ìˆ˜ë¥¼ ì‚°ì¶œí•˜ì˜€ìŒ

### ë¬¸í•­ 29-1. ì§ì±…ë³„ í˜‘ë ¥ì›í™œì„± ë¶„ì„

ì§ì±…ë³„ ì‘ë‹µìëŠ” ì´ 3,090ëª…ì´ê³  ì´ ì¤‘ì—ì„œ í•™êµì¥ì€ 474ëª…(15.34%), êµê°ì€ 761ëª…(24.63%), êµì‚¬ ë“±ì€ 1,855ëª…(60.03%)ì´ì—ˆìŒ

í•™êµì¥ ì‘ë‹µê±´ìˆ˜ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 222ê±´(46.8%), ê·¸ë ‡ë‹¤ëŠ” 198ê±´(41.8%), ë³´í†µì´ë‹¤ëŠ” 51ê±´(10.8%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 3ê±´(0.6%)ì´ì—ˆìŒ.

êµê° ì‘ë‹µê±´ìˆ˜ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 295ê±´(38.8%), ê·¸ë ‡ë‹¤ëŠ” 359ê±´(47.2%), ë³´í†µì´ë‹¤ëŠ” 87ê±´(11.4%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 18ê±´(2.4%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 2ê±´(0.3%)ì´ì—ˆìŒ

êµì‚¬ ë“± ì‘ë‹µê±´ìˆ˜ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 698ê±´(37.63%), ê·¸ë ‡ë‹¤ëŠ” 783ê±´(42.21%), ë³´í†µì´ë‹¤ëŠ” 312ê±´(16.82%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 47ê±´(2.53%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 15ê±´(0.81%)ì´ì—ˆìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
dat_filtered_29 <- dat_filtered %>%
  mutate(
    í˜‘ë ¥ì›í™œì„± = factor(as.character(ques_29),
                   levels = c("1","2","3","4","5"),
                   labels = c("ë§¤ìš° ê·¸ë ‡ë‹¤","ê·¸ë ‡ë‹¤","ë³´í†µì´ë‹¤","ê·¸ë ‡ì§€ ì•Šë‹¤","ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤"))
  )

# ì§ì±…ë³„ ê¸°ìˆ í†µê³„ (í•©ê³„ í¬í•¨)
summary_table_29 <- dat_filtered_29 %>%
  group_by(ì§ì±…, í˜‘ë ¥ì›í™œì„±) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 2)) %>%
  ungroup()

summary_with_total_29 <- summary_table_29 %>%
  group_by(ì§ì±…) %>%
  summarise(n = sum(n), pct = sum(pct), í˜‘ë ¥ì›í™œì„± = "í•©ê³„") %>%
  bind_rows(summary_table_29) %>%
  arrange(
    factor(ì§ì±…, levels = c("í•™êµì¥","êµê°","êµì‚¬ ë“±")),
    í˜‘ë ¥ì›í™œì„± == "í•©ê³„",
    if_else(í˜‘ë ¥ì›í™œì„± != "í•©ê³„", -n, 0)
  )

summary_final_29 <- summary_with_total_29 %>%
  bind_rows(
    summary_with_total_29 %>%
      summarise(ì§ì±… = "ì „ì²´ í•©ê³„", n = sum(n[í˜‘ë ¥ì›í™œì„± == "í•©ê³„"]), pct = 100, í˜‘ë ¥ì›í™œì„± = "í•©ê³„")
  )

print(summary_final_29, n = Inf)

# ì¹´ì´ì œê³± ê²€ì •
tab1_29 <- table(dat_filtered_29$ì§ì±…, dat_filtered_29$í˜‘ë ¥ì›í™œì„±)
chisq_test1_29 <- chisq.test(tab1_29)
print(chisq_test1_29)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# ëˆ„ì ë§‰ëŒ€ê·¸ë˜í”„
summary_job_29 <- dat_filtered_29 %>%
  group_by(ì§ì±…, í˜‘ë ¥ì›í™œì„±) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup() %>%
  mutate(í˜‘ë ¥ì›í™œì„± = factor(í˜‘ë ¥ì›í™œì„±, 
                        levels = c("ë§¤ìš° ê·¸ë ‡ë‹¤", "ê·¸ë ‡ë‹¤", "ë³´í†µì´ë‹¤", 
                                 "ê·¸ë ‡ì§€ ì•Šë‹¤", "ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤")))

p0_29 <- ggplot(summary_job_29, aes(x = factor(ì§ì±…, levels = c("í•™êµì¥", "êµê°", "êµì‚¬ ë“±")), 
                                    y = pct, fill = í˜‘ë ¥ì›í™œì„±)) +
  geom_bar(stat = "identity", width = 0.7) +
  labs(
    title = "ì§ì±…ë³„ í˜‘ë ¥ì›í™œì„± ì¸ì‹",
    x = "ì§ì±…",
    y = "ë¹„ìœ¨",
    fill = "í˜‘ë ¥ì›í™œì„±"
  ) +
  scale_y_continuous(limits = c(0, 100), expand = expansion(mult = c(0, 0.02))) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
    axis.text.x = element_text(size = 20, face = "bold"),
    axis.text.y = element_text(size = 18),
    axis.title.x = element_text(size = 25, angle = 0, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),
    legend.position = "right",
    legend.text = element_text(size = 14),
    legend.title = element_text(size = 16, face = "bold")
  )
print(p0_29)
```

í•™êµ ë‚´ì—ì„œ í•™ìƒ ì§€ì›ì„ ìœ„í•´ì„œ êµìœ¡êµ¬ì„±ì› ê°„ í˜‘ë ¥ì´ ì›í™œí•œì§€ì— ëŒ€í•œ ì§ì±…ë³„ ì¸ì‹ë„ í‰ê· ì ìˆ˜ë¥¼ ë¹„êµí•œ ê²°ê³¼, í•™êµì¥(4.35), êµê°(4.22), êµì‚¬ ë“±(4.13)ìœ¼ë¡œ í•™êµì¥-êµê°, í•™êµì¥-êµì‚¬ ë“±, êµê°-êµì‚¬ ë“± ê°„ì—ëŠ” í˜‘ë ¥ ì›í™œì„±ì— ëŒ€í•œ ì¸ì‹ë„ì— ìœ ì˜ë¯¸í•œ ì°¨ì´ê°€ ìˆëŠ” ê²ƒìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
# ANOVA ë¶„ì„
dat_score_29 <- dat_filtered_29 %>%
  filter(!is.na(ques_29)) %>%
  mutate(
    í˜‘ë ¥ì›í™œì„±ì ìˆ˜ = case_when(
      ques_29 == 1 ~ 5,   # ë§¤ìš° ê·¸ë ‡ë‹¤
      ques_29 == 2 ~ 4,   # ê·¸ë ‡ë‹¤
      ques_29 == 3 ~ 3,   # ë³´í†µì´ë‹¤
      ques_29 == 4 ~ 2,   # ê·¸ë ‡ì§€ ì•Šë‹¤
      ques_29 == 5 ~ 1,   # ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤
      TRUE ~ NA_real_
    ),
    ì§ì±… = factor(ì§ì±…, levels = c("í•™êµì¥", "êµê°", "êµì‚¬ ë“±"))
  )

job_summary_29 <- dat_score_29 %>%
  group_by(ì§ì±…) %>%
  summarise(
    í‰ê·  = round(mean(í˜‘ë ¥ì›í™œì„±ì ìˆ˜, na.rm = TRUE), 2),
    í‘œì¤€í¸ì°¨ = round(sd(í˜‘ë ¥ì›í™œì„±ì ìˆ˜, na.rm = TRUE), 2),
    n = n(),
    .groups = "drop"
  ) %>%
  arrange(ì§ì±…)

print(job_summary_29)

anova_job_29 <- aov(í˜‘ë ¥ì›í™œì„±ì ìˆ˜ ~ ì§ì±…, data = dat_score_29)
summary(anova_job_29)

tukey_job_29 <- TukeyHSD(anova_job_29)
print(tukey_job_29)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# ë°•ìŠ¤í”Œë¡¯
tukey_letters_job_29 <- multcompView::multcompLetters4(anova_job_29, tukey_job_29)
letters_df_job_29 <- data.frame(
  ì§ì±… = names(tukey_letters_job_29$`ì§ì±…`$Letters),
  group = tukey_letters_job_29$`ì§ì±…`$Letters
)

job_summary_with_groups_29 <- job_summary_29 %>%
  left_join(letters_df_job_29, by = "ì§ì±…")

ggplot(dat_score_29, aes(x = factor(ì§ì±…, levels = c("í•™êµì¥", "êµê°", "êµì‚¬ ë“±")), y = í˜‘ë ¥ì›í™œì„±ì ìˆ˜, fill = ì§ì±…)) +
  geom_boxplot(alpha = 0.7, width = 0.6, outlier.shape = 21) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 10, fill = "yellow", stroke = 1) +
  geom_text(data = job_summary_with_groups_29, 
            aes(x = ì§ì±…, y = 8, label = paste0(group, "\n(M=", í‰ê· , ")")),
            inherit.aes = FALSE, fontface = "bold", size = 8, vjust = 0.3, lineheight=0.5) +
  labs(
    title = "ì§ì±…ë³„ í˜‘ë ¥ì›í™œì„± ì¸ì‹",
    x = "ì§ì±…", 
    y = "í˜‘ë ¥ì›í™œì„±\nì¸ì‹ë„"
  ) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
    axis.text.x = element_text(size = 20),
    axis.text.y = element_text(size = 20),
    axis.title.x = element_text(size = 20, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),
    legend.position = "none"
  ) +
  scale_y_continuous(expand = expansion(mult = c(0.025, 0.10)))
```

### ë¬¸í•­ 29-2. í•™êµê¸‰ë³„ í˜‘ë ¥ì›í™œì„± ë¶„ì„

í•™êµê¸‰ë³„ ì‘ë‹µìëŠ” ì´ 3,090ëª…ì´ë©°, ì´ˆë“±í•™êµ ì‘ë‹µìëŠ” 1,277ëª…(41.33%), ì¤‘í•™êµ ì‘ë‹µìëŠ” 1,100ëª…(35.60%), ê³ ë“±í•™êµ ì‘ë‹µìëŠ” 713ëª…(23.07%)ì´ ì‘ë‹µí•˜ì˜€ìŒ

ì´ˆë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 609ëª…(47.7%), ê·¸ë ‡ë‹¤ëŠ” 499ëª…(39.1%), ë³´í†µì´ë‹¤ëŠ” 142ëª…(11.1%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 19ëª…(1.5%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 8ëª…(0.6%)ì´ì—ˆìŒ

ì¤‘í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 429ëª…(39%), ê·¸ë ‡ë‹¤ëŠ” 499ëª…(45.4%), ë³´í†µì´ë‹¤ëŠ” 142ëª…(12.9%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 25ëª…(2.3%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 5ëª…(0.5%)ì´ì—ˆìŒ

ê³ ë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 177ëª…(24.8%), ê·¸ë ‡ë‹¤ëŠ” 342ëª…(48%), ë³´í†µì´ë‹¤ëŠ” 166ëª…(23.3%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 24ëª…(3.4%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 4ëª…(0.6%)ì´ì—ˆìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
# í•™êµê¸‰ë³„ ê¸°ìˆ í†µê³„ (í•©ê³„ í¬í•¨)
summary_school_table_29 <- dat_filtered_29 %>%
  group_by(í•™êµê¸‰, í˜‘ë ¥ì›í™œì„±) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

summary_school_with_total_29 <- summary_school_table_29 %>%
  group_by(í•™êµê¸‰) %>%
  summarise(n = sum(n), pct = sum(pct), í˜‘ë ¥ì›í™œì„± = "í•©ê³„") %>%
  bind_rows(summary_school_table_29) %>%
  arrange(
    factor(í•™êµê¸‰, levels = c("ì´ˆë“±í•™êµ","ì¤‘í•™êµ","ê³ ë“±í•™êµ")),
    í˜‘ë ¥ì›í™œì„± == "í•©ê³„",
    if_else(í˜‘ë ¥ì›í™œì„± != "í•©ê³„", -n, 0)
  )

summary_school_final_29 <- summary_school_with_total_29 %>%
  bind_rows(
    summary_school_with_total_29 %>%
      summarise(í•™êµê¸‰ = "ì „ì²´ í•©ê³„", n = sum(n[í˜‘ë ¥ì›í™œì„± == "í•©ê³„"]), pct = 100, í˜‘ë ¥ì›í™œì„± = "í•©ê³„")
  )

print(summary_school_final_29, n = Inf)

# ì¹´ì´ì œê³± ê²€ì •
tab_school_29 <- table(dat_filtered_29$í•™êµê¸‰, dat_filtered_29$í˜‘ë ¥ì›í™œì„±)
chisq_test_school_29 <- chisq.test(tab_school_29)
print(chisq_test_school_29)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# ëˆ„ì ë§‰ëŒ€ê·¸ë˜í”„
summary_school_plot_29 <- summary_school_table_29 %>%
  mutate(í˜‘ë ¥ì›í™œì„± = factor(í˜‘ë ¥ì›í™œì„±, 
                        levels = c("ë§¤ìš° ê·¸ë ‡ë‹¤", "ê·¸ë ‡ë‹¤", "ë³´í†µì´ë‹¤", 
                                 "ê·¸ë ‡ì§€ ì•Šë‹¤", "ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤")))

ggplot(summary_school_plot_29, aes(x = factor(í•™êµê¸‰, levels = c("ì´ˆë“±í•™êµ", "ì¤‘í•™êµ", "ê³ ë“±í•™êµ")), y = pct, fill = í˜‘ë ¥ì›í™œì„±)) +
  geom_bar(stat = "identity", width = 0.7) +
  labs(
    title = "í•™êµê¸‰ë³„ í˜‘ë ¥ì›í™œì„± ì¸ì‹",
    x = "í•™êµê¸‰",
    y = "ë¹„ìœ¨",
    fill = "í˜‘ë ¥ì›í™œì„±"
  ) +
  scale_y_continuous(limits = c(0, 100), expand = expansion(mult = c(0, 0.02))) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(size = 32, face = "bold", hjust = 0.5),
    axis.text.x = element_text(size = 18, margin = margin(t = 10)),
    axis.text.y = element_text(size = 18),
    axis.title.x = element_text(size = 20, angle = 0, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),
    legend.position = "right",
    legend.text = element_text(size = 14),
    legend.title = element_text(size = 16, face = "bold")
  )
```

í•™êµ ë‚´ì—ì„œ í•™ìƒ ì§€ì›ì„ ìœ„í•´ì„œ êµìœ¡êµ¬ì„±ì› ê°„ í˜‘ë ¥ì´ ì›í™œí•œì§€ì— ëŒ€í•œ í•™êµê¸‰ë³„ ì¸ì‹ë„ í‰ê· ì ìˆ˜ë¥¼ ë¹„êµí•œ ê²°ê³¼, ì´ˆë“±í•™êµ(4.32), ì¤‘í•™êµ(4.2), ê³ ë“±í•™êµ(3.93)ìœ¼ë¡œ ì´ˆë“±í•™êµ-ê³ ë“±í•™êµ, ì¤‘í•™êµ-ê³ ë“±í•™êµ, ì¤‘í•™êµ-ê³ ë“±í•™êµ ê°„ì—ëŠ” í˜‘ë ¥ì˜ ì›í™œì„±ì— ëŒ€í•œ ì¸ì‹ë„ì— ìœ ì˜ë¯¸í•œ ì°¨ì´ê°€ ìˆëŠ” ê²ƒìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ(ì´ˆë“±í•™êµ \> ì¤‘í•™êµ \> ê³ ë“±í•™êµ)

```{r}
#| echo: false
#| warning: false
#| message: false
# í•™êµê¸‰ë³„ ANOVA
school_summary_29 <- dat_score_29 %>%
  mutate(í•™êµê¸‰ = factor(í•™êµê¸‰, levels = c("ì´ˆë“±í•™êµ", "ì¤‘í•™êµ", "ê³ ë“±í•™êµ"))) %>%
  group_by(í•™êµê¸‰) %>%
  summarise(
    í‰ê·  = round(mean(í˜‘ë ¥ì›í™œì„±ì ìˆ˜, na.rm = TRUE), 2),
    í‘œì¤€í¸ì°¨ = round(sd(í˜‘ë ¥ì›í™œì„±ì ìˆ˜, na.rm = TRUE), 2),
    n = n(),
    .groups = "drop"
  ) %>%
  arrange(í•™êµê¸‰)

print(school_summary_29)

anova_school_29 <- aov(í˜‘ë ¥ì›í™œì„±ì ìˆ˜ ~ í•™êµê¸‰, data = dat_score_29)
summary(anova_school_29)

tukey_school_29 <- TukeyHSD(anova_school_29)
print(tukey_school_29)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# ë°•ìŠ¤í”Œë¡¯
tukey_letters_school_29 <- multcompView::multcompLetters4(anova_school_29, tukey_school_29)
letters_df_school_29 <- data.frame(
  í•™êµê¸‰ = names(tukey_letters_school_29$`í•™êµê¸‰`$Letters),
  group = tukey_letters_school_29$`í•™êµê¸‰`$Letters
)

school_summary_with_groups_29 <- school_summary_29 %>%
  left_join(letters_df_school_29, by = "í•™êµê¸‰")

ggplot(dat_score_29, aes(x = factor(í•™êµê¸‰, levels = c("ì´ˆë“±í•™êµ", "ì¤‘í•™êµ", "ê³ ë“±í•™êµ")), y = í˜‘ë ¥ì›í™œì„±ì ìˆ˜, fill = í•™êµê¸‰)) +
  geom_boxplot(alpha = 0.7, width = 0.6, outlier.shape = 21) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 10, fill = "yellow", stroke = 1) +
  geom_text(data = school_summary_with_groups_29, 
            aes(x = í•™êµê¸‰, y = 8, label = paste0(group, "\n(M=", í‰ê· , ")")),
            inherit.aes = FALSE, fontface = "bold", size = 8, vjust = 0.35, lineheight=0.5) +
  labs(
    title = "í•™êµê¸‰ë³„ í˜‘ë ¥ì›í™œì„± ì¸ì‹",
    x = "í•™êµê¸‰", 
    y = "í˜‘ë ¥ì›í™œì„±\nì¸ì‹ë„"
  ) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
    axis.text.x = element_text(size = 20),
    axis.text.y = element_text(size = 20),
    axis.title.x = element_text(size = 20, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),
    legend.position = "none"
  ) +
  scale_y_continuous(expand = expansion(mult = c(0.025, 0.10)))
```

### ë¬¸í•­ 29-3. ì„¤ë¦½ë³„ í˜‘ë ¥ì›í™œì„± ë¶„ì„

ì„¤ë¦½ë³„ ì‘ë‹µìëŠ” ì´ 3,090ëª…ì´ë©° ì´ ì¤‘ì—ì„œ ê³µë¦½í•™êµ ì‘ë‹µìëŠ” 2,317ëª…(74.5%), ì‚¬ë¦½í•™êµ ì‘ë‹µìëŠ” 761ëª…(25.5%)ì´ ì‘ë‹µí•˜ì˜€ìŒ

ê³µë¦½í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 991ëª…(42.8%), ê·¸ë ‡ë‹¤ëŠ” 965ëª…(41.6%), ë³´í†µì´ë‹¤ëŠ” 310ëª…(13.4%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 41ëª…(1.8%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 10ëª…(0.4%)ì´ì—ˆìŒ

ì‚¬ë¦½í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 224ëª…(29%), ê·¸ë ‡ë‹¤ëŠ” 375ëª…(27.8%), ë³´í†µì´ë‹¤ëŠ” 140ëª…(18.1%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 27ëª…(3.5%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 7ëª…(0.9%)ì´ì—ˆìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
# ì„¤ë¦½ë³„ ë°ì´í„° ì¤€ë¹„
dat_found_29 <- dat_filtered_29 %>%
  filter(ì„¤ë¦½ %in% c("ê³µë¦½", "ì‚¬ë¦½")) %>%
  mutate(ì„¤ë¦½ = factor(ì„¤ë¦½, levels = c("ê³µë¦½", "ì‚¬ë¦½")))

# ì„¤ë¦½ë³„ ê¸°ìˆ í†µê³„ (í•©ê³„ í¬í•¨)
summary_found_table_29 <- dat_found_29 %>%
  group_by(ì„¤ë¦½, í˜‘ë ¥ì›í™œì„±) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

summary_found_with_total_29 <- summary_found_table_29 %>%
  group_by(ì„¤ë¦½) %>%
  summarise(n = sum(n), pct = sum(pct), í˜‘ë ¥ì›í™œì„± = "í•©ê³„") %>%
  bind_rows(summary_found_table_29) %>%
  arrange(ì„¤ë¦½, í˜‘ë ¥ì›í™œì„± == "í•©ê³„", desc(n))

summary_found_final_29 <- summary_found_with_total_29 %>%
  bind_rows(
    summary_found_with_total_29 %>%
      summarise(ì„¤ë¦½ = "ì „ì²´ í•©ê³„", n = sum(n[í˜‘ë ¥ì›í™œì„± == "í•©ê³„"]), pct = 100, í˜‘ë ¥ì›í™œì„± = "í•©ê³„")
  )

print(summary_found_final_29, n = Inf)

# ì¹´ì´ì œê³± ê²€ì •
tab_found_29 <- table(dat_found_29$ì„¤ë¦½, dat_found_29$í˜‘ë ¥ì›í™œì„±)
print(tab_found_29)
chisq_test_found_29 <- chisq.test(tab_found_29)
print(chisq_test_found_29)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# ëˆ„ì ë§‰ëŒ€ê·¸ë˜í”„
summary_found_plot_29 <- summary_found_table_29 %>%
  mutate(í˜‘ë ¥ì›í™œì„± = factor(í˜‘ë ¥ì›í™œì„±, 
                        levels = c("ë§¤ìš° ê·¸ë ‡ë‹¤", "ê·¸ë ‡ë‹¤", "ë³´í†µì´ë‹¤", 
                                 "ê·¸ë ‡ì§€ ì•Šë‹¤", "ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤")))

ggplot(summary_found_plot_29, aes(x = ì„¤ë¦½, y = pct, fill = í˜‘ë ¥ì›í™œì„±)) +
  geom_bar(stat = "identity", width = 0.7) +
  labs(
    title = "ì„¤ë¦½ë³„ í˜‘ë ¥ì›í™œì„± ì¸ì‹",
    x = "ì„¤ë¦½",
    y = "ë¹„ìœ¨",
    fill = "í˜‘ë ¥ì›í™œì„±"
  ) +
  scale_y_continuous(limits = c(0, 100), expand = expansion(mult = c(0, 0.02))) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(size = 32, face = "bold", hjust = 0.5),
    axis.text.x = element_text(size = 20, margin = margin(t = 10)),
    axis.text.y = element_text(size = 20),
    axis.title.x = element_text(size = 20, angle = 0, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),
    legend.position = "right",
    legend.text = element_text(size = 18),
    legend.title = element_text(size = 20, face = "bold")
  )
```

í•™ìƒ ì§€ì›ì„ ìœ„í•´ì„œ êµìœ¡êµ¬ì„±ì› ê°„ í˜‘ë ¥ì´ ì›í™œí•œì§€ì— ëŒ€í•œ ì„¤ë¦½ë³„ ì¸ì‹ë„ í‰ê· ì ìˆ˜ë¥¼ ë¹„êµí•œ ê²°ê³¼, ê³µë¦½í•™êµ(4.25), ì‚¬ë¦½í•™êµ(4.01)ì—ì„œ í˜‘ë ¥ì˜ ì›í™œì„±ì— ëŒ€í•œ ì¸ì‹ë„ì— ìœ ì˜ë¯¸í•œ ì°¨ì´ê°€ ìˆëŠ” ê²ƒìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
# T-test ë¶„ì„
dat_score_found_29 <- dat_found_29 %>%
  mutate(
    í˜‘ë ¥ì›í™œì„±ì ìˆ˜ = case_when(
      ques_29 == 1 ~ 5,   # ë§¤ìš° ê·¸ë ‡ë‹¤
      ques_29 == 2 ~ 4,   # ê·¸ë ‡ë‹¤
      ques_29 == 3 ~ 3,   # ë³´í†µì´ë‹¤
      ques_29 == 4 ~ 2,   # ê·¸ë ‡ì§€ ì•Šë‹¤
      ques_29 == 5 ~ 1,   # ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤
      TRUE ~ NA_real_
    )
  )

summary_found_stats_29 <- dat_score_found_29 %>%
  group_by(ì„¤ë¦½) %>%
  summarise(
    í‰ê·  = round(mean(í˜‘ë ¥ì›í™œì„±ì ìˆ˜, na.rm = TRUE), 2),
    í‘œì¤€í¸ì°¨ = round(sd(í˜‘ë ¥ì›í™œì„±ì ìˆ˜, na.rm = TRUE), 2),
    n = n(),
    .groups = "drop"
  )

# T-test
t_test_result_29 <- t.test(í˜‘ë ¥ì›í™œì„±ì ìˆ˜ ~ ì„¤ë¦½, data = dat_score_found_29, var.equal = FALSE)
print(t_test_result_29)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# ë°•ìŠ¤í”Œë¡¯
if(t_test_result_29$p.value < 0.05) {
  establishment_groups_29 <- data.frame(
    ì„¤ë¦½ = c("ê³µë¦½", "ì‚¬ë¦½"),
    group = c("a", "b")
  )
} else {
  establishment_groups_29 <- data.frame(
    ì„¤ë¦½ = c("ê³µë¦½", "ì‚¬ë¦½"),
    group = c("a", "a")
  )
}

summary_found_with_groups_29 <- summary_found_stats_29 %>%
  left_join(establishment_groups_29, by = "ì„¤ë¦½")

ggplot(dat_score_found_29, aes(x = ì„¤ë¦½, y = í˜‘ë ¥ì›í™œì„±ì ìˆ˜, fill = ì„¤ë¦½)) +
  geom_boxplot(alpha = 0.7, width = 0.6, outlier.shape = 21) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 10, fill = "yellow", stroke = 1) +
  geom_text(data = summary_found_with_groups_29, 
            aes(x = ì„¤ë¦½, y = 8, label = paste0(group, "\n(M=", í‰ê· , ")")),
            inherit.aes = FALSE, fontface = "bold", size = 7, vjust = 0, lineheight=0.5) +
  labs(
    title = "ì„¤ë¦½ë³„ í˜‘ë ¥ì›í™œì„± ì¸ì‹",
    x = "ì„¤ë¦½", 
    y = "í˜‘ë ¥ì›í™œì„±"
  ) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
    axis.text.x = element_text(size = 20),
    axis.text.y = element_text(size = 20),
    axis.title.x = element_text(size = 20, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),
    legend.position = "none"
  ) +
  scale_y_continuous(expand = expansion(mult = c(0.05, 0.15)))
```

### ë¬¸í•­30. í•™êµ ë‚´ êµ¬ì„±ì› ê°„ í˜‘ë ¥ì„ ì €í•´í•˜ëŠ” ìš”ì¸ì€ ë¬´ì—‡ì…ë‹ˆê¹Œ? (ì¤‘ë³µì‘ë‹µ)

â‘  í˜‘ë ¥ì— ëŒ€í•œ ì¸ì‹ ë¶€ì¡± â‘¡ ì†Œí†µë¶€ì¡± â‘¢ ì—…ë¬´ê³¼ì¤‘ â‘£ ì—…ë¬´ ë‹´ë‹¹ì ìœ„ì£¼ ìš´ì˜ë°©ì‹ â‘¤ ê¸°íƒ€

í•™êµ ë‚´ êµ¬ì„±ì› ê°„ í˜‘ë ¥ì„ ì €í•´í•˜ëŠ” ìš”ì¸ì— ëŒ€í•œ ì„¤ë¬¸ì— ì´ ì‘ë‹µê±´ìˆ˜ëŠ” 4,301ê±´ì´ê³  ì´ˆë“±í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 1,701ê±´(39.5%) ì¤‘í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 1,495ê±´(34.8%)ì´ê³  ê³ ë“±í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 1,010ê±´(23.5%)ì´ê³ , íŠ¹ìˆ˜í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 63ê±´(1.5%)ì´ê³  ê°ì¢…í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 32ê±´(0.7%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¨

ì´ˆë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ì—…ë¬´ê³¼ì¤‘ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 869ê±´(51.1%), ì—…ë¬´ ë‹´ë‹¹ì ìœ„ì£¼ ìš´ì˜ ë°©ì‹ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 335ê±´(19.7%), í˜‘ë ¥ì— ëŒ€í•œ ì¸ì‹ ë¶€ì¡±ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 221ê±´(13%), ì†Œí†µë¶€ì¡±ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 166ê±´(9.8%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ì¤‘í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ì—…ë¬´ê³¼ì¤‘ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 843ê±´(56.4%), ì—…ë¬´ ë‹´ë‹¹ì ìœ„ì£¼ ìš´ì˜ ë°©ì‹ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 287ê±´(19.2%), í˜‘ë ¥ì— ëŒ€í•œ ì¸ì‹ ë¶€ì¡±ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 170ê±´(11.4%), ì†Œí†µë¶€ì¡±ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 136ê±´(9.1%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê³ ë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ì—…ë¬´ê³¼ì¤‘ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 526ê±´(52.1%), ì—…ë¬´ ë‹´ë‹¹ì ìœ„ì£¼ ìš´ì˜ ë°©ì‹ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 186ê±´(18.4%), í˜‘ë ¥ì— ëŒ€í•œ ì¸ì‹ ë¶€ì¡±ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 151ê±´(15%), ì†Œí†µë¶€ì¡±ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 107ê±´(10.6%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

íŠ¹ìˆ˜í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ì—…ë¬´ê³¼ì¤‘ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 31ê±´(49.2%), ì—…ë¬´ ë‹´ë‹¹ì ìœ„ì£¼ ìš´ì˜ ë°©ì‹ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 11ê±´(17.5%), í˜‘ë ¥ì— ëŒ€í•œ ì¸ì‹ ë¶€ì¡±ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 11ê±´(17.5%), ì†Œí†µë¶€ì¡±ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 5ê±´(7.9%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê°ì¢…í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ ì—…ë¬´ê³¼ì¤‘ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 15ê±´(46.9%), í˜‘ë ¥ì— ëŒ€í•œ ì¸ì‹ë¶€ì¡±ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 7ê±´(21.9%), ì†Œí†µë¶€ì¡±ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 5ê±´(15.6%), ì—…ë¬´ ë‹´ë‹¹ì ìœ„ì£¼ ìš´ì˜ë°©ì‹ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 4ê±´(12.5%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
dat_q30_long <- dat %>%
  filter(!is.na(ques_30)) %>%
  separate_rows(ques_30, sep = ",\\s*") %>%
  mutate(
    ques_30 = str_trim(as.character(ques_30)),
    ë¬¸í•­30 = recode(ques_30,
                   "1" = "í˜‘ë ¥ ì¸ì‹ ë¶€ì¡±",
                   "2" = "ì†Œí†µë¶€ì¡±",
                   "3" = "ì—…ë¬´ê³¼ì¤‘",
                   "4" = "ë‹´ë‹¹ì ìœ„ì£¼ ìš´ì˜ë°©ì‹",
                   "5" = "ê¸°íƒ€",
                   .default = "ê¸°íƒ€"),
    í•™êµê¸‰ = recode(as.character(ques_1),
                 "1" = "ì´ˆë“±í•™êµ",
                 "2" = "ì¤‘í•™êµ",
                 "3" = "ê³ ë“±í•™êµ",
                 "4" = "íŠ¹ìˆ˜í•™êµ",
                 "5" = "ê°ì¢…í•™êµ")
  )

# ì „ì²´ ê¸°ì¤€ìœ¼ë¡œ ë¬¸í•­30 ìˆœì„œ ê²°ì •
item_order <- dat_q30_long %>%
  count(ë¬¸í•­30, sort = TRUE) %>%
  pull(ë¬¸í•­30)

# ê¸°ìˆ í†µê³„
summary_q30 <- dat_q30_long %>%
  mutate(
    í•™êµê¸‰ = factor(í•™êµê¸‰, levels = c("ì´ˆë“±í•™êµ", "ì¤‘í•™êµ", "ê³ ë“±í•™êµ", "íŠ¹ìˆ˜í•™êµ", "ê°ì¢…í•™êµ")),
    ë¬¸í•­30 = factor(ë¬¸í•­30, levels = item_order)
  ) %>%
  group_by(í•™êµê¸‰, ë¬¸í•­30, .drop = FALSE) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup() %>%
  arrange(í•™êµê¸‰, ë¬¸í•­30)

summary_q30_total <- summary_q30 %>%
  group_by(í•™êµê¸‰) %>%
  summarise(n = sum(n), pct = 100, ë¬¸í•­30 = "í•©ê³„", .groups = "drop") %>%
  bind_rows(summary_q30) %>%
  arrange(factor(í•™êµê¸‰, 
                 levels=c("ì´ˆë“±í•™êµ","ì¤‘í•™êµ","ê³ ë“±í•™êµ","íŠ¹ìˆ˜í•™êµ","ê°ì¢…í•™êµ")),
          if_else(ë¬¸í•­30 == "í•©ê³„", 2, 1),
          desc(n))

print(summary_q30_total, n = Inf)
```

```{r}
#| echo: false
#| warning: false
#| message: false
ggplot(
  summary_q30,  # ì—¬ê¸°ì„œ reorder ì œê±°
  aes(x = ë¬¸í•­30, y = n, fill = ë¬¸í•­30)
) +
  geom_bar(stat = "identity", width = 0.7) +
  geom_text(aes(label = paste0(n,"ê±´(",pct,"%)"), 
                y = n + max(n) * 0.05),
            vjust = 0.1, hjust = 0.5, size = 5, lineheight = 0.4) +
  facet_wrap(~í•™êµê¸‰, ncol = 1, scales = "free_y") +
  labs(
    title = "í•™êµêµ¬ì„±ì› ê°„\n í˜‘ë ¥ ì €í•´ìš”ì¸",
    x = "í˜‘ë ¥ ì €í•´ìš”ì¸",
    y = "ì‘ë‹µìˆ˜"
  ) +
  # scale_x_discreteì˜ labelsë„ ìˆœì„œì— ë§ê²Œ ì¡°ì • í•„ìš”í•  ìˆ˜ ìˆìŒ
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5, lineheight = 0.6),
    legend.position = "none",
    axis.text.x = element_text(angle = 0, vjust = 0.8, lineheight = 0.4, size = 17),
    axis.text.y = element_text(size = 17),
    strip.text = element_text(face = "bold", size = 20),
    axis.title.x = element_text(size = 20, margin = margin(t = 18)),
    axis.title.y = element_text(angle = 0, vjust = 0.5, size = 20)
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.15))) +
  coord_cartesian(clip = "off")  
```

# 6. ì‹¤íƒœì¡°ì‚¬ (í•™ìƒë§ì¶¤í†µí•©ì§€ì›ì„ ìœ„í•œ êµìœ¡ì§€ì›ì²­ê³¼ í˜‘ì—… í˜„í™© ì¡°ì‚¬)

### ë¬¸í•­31. êµìœ¡ì§€ì›ì²­ìœ¼ë¡œë¶€í„° í•™ìƒë§ì¶¤í†µí•©ì§€ì›ì„ ìœ„í•´ ë„ì›€ì„ ë°›ì€ ì ì´ ìˆìŠµë‹ˆê¹Œ?

â‘  ê·¸ë ‡ë‹¤ â‘¡ ì•„ë‹ˆë‹¤

êµìœ¡ì§€ì›ì²­ìœ¼ë¡œë¶€í„° í•™ìƒë§ì¶¤í†µí•©ì§€ì›ì„ ìœ„í•´ ë„ì›€ì„ ë°›ì•˜ëŠ”ì§€ì— ëŒ€í•œ ì„¤ë¬¸ì— ì´ ì‘ë‹µìëŠ” 3,178ëª…ì´ê³  ì´ˆë“±í•™êµ ì‘ë‹µìëŠ” 1,282ëª…(40.3%) ì¤‘í•™êµ ì‘ë‹µìëŠ” 1,109ëª…(35%)ì´ê³  ê³ ë“±í•™êµ ì‘ë‹µìëŠ” 718ëª…(22.6%)ì´ê³ , íŠ¹ìˆ˜í•™êµ ì‘ë‹µìëŠ” 46ëª…(1.4%)ì´ê³  ê°ì¢…í•™êµ ì‘ë‹µìëŠ” 23ëª…(0.7%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¨

ì´ˆë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ êµìœ¡ì§€ì›ì²­ìœ¼ë¡œë¶€í„° ë„ì›€ì„ ë°›ì•˜ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 471ëª…(36.7%), ë„ì›€ì„ ë°›ì§€ ì•Šì•˜ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 811ëª…(63.3%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ì¤‘í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ êµìœ¡ì§€ì›ì²­ìœ¼ë¡œë¶€í„° ë„ì›€ì„ ë°›ì•˜ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 383ëª…(34.5%), ë„ì›€ì„ ë°›ì§€ ì•Šì•˜ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 726ëª…(65.5%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê³ ë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ êµìœ¡ì§€ì›ì²­ìœ¼ë¡œë¶€í„° ë„ì›€ì„ ë°›ì•˜ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 233ëª…(32.5%), ë„ì›€ì„ ë°›ì§€ ì•Šì•˜ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 485ëª…(67.5%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

íŠ¹ìˆ˜í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ êµìœ¡ì§€ì›ì²­ìœ¼ë¡œë¶€í„° ë„ì›€ì„ ë°›ì•˜ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 2ëª…(4.3%), ë„ì›€ì„ ë°›ì§€ ì•Šì•˜ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 44ëª…(95.7%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê°ì¢…í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ êµìœ¡ì§€ì›ì²­ìœ¼ë¡œë¶€í„° ë„ì›€ì„ ë°›ì•˜ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 4ëª…(17.4%), ë„ì›€ì„ ë°›ì§€ ì•Šì•˜ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 19ëª…(82.6%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
dat_q31 <- dat %>%
  filter(!is.na(ques_31)) %>%
  mutate(
    ë¬¸í•­31 = recode(as.character(ques_31),
                   "1" = "ê·¸ë ‡ë‹¤",
                   "2" = "ì•„ë‹ˆë‹¤",
                   .default = "ê¸°íƒ€"),
    ë¬¸í•­31 = factor(ë¬¸í•­31, levels = c("ê·¸ë ‡ë‹¤", "ì•„ë‹ˆë‹¤")),
    í•™êµê¸‰ = factor(í•™êµê¸‰, levels = c("ì´ˆë“±í•™êµ", "ì¤‘í•™êµ", "ê³ ë“±í•™êµ", "íŠ¹ìˆ˜í•™êµ", "ê°ì¢…í•™êµ"))  # ì´ ì¤„ ì¶”ê°€!
  )

# ê¸°ìˆ í†µê³„
summary_q31 <- dat_q31 %>%
  group_by(í•™êµê¸‰, ë¬¸í•­31) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

summary_q31_total <- summary_q31 %>%
  group_by(í•™êµê¸‰) %>%
  summarise(n = sum(n), pct = 100, ë¬¸í•­31 = "í•©ê³„", .groups = "drop") %>%
  bind_rows(summary_q31) %>%
  arrange(factor(í•™êµê¸‰, 
                 levels=c("ì´ˆë“±í•™êµ","ì¤‘í•™êµ","ê³ ë“±í•™êµ","íŠ¹ìˆ˜í•™êµ","ê°ì¢…í•™êµ")),
          if_else(ë¬¸í•­31 == "í•©ê³„", 2, 1),
          desc(n))

print(summary_q31_total, n = Inf)
```

```{r}
#| echo: false
#| warning: false
#| message: false
ggplot(summary_q31, aes(x = ë¬¸í•­31, y = n, fill = ë¬¸í•­31)) +
  geom_bar(stat="identity", width=0.7) +
  geom_text(aes(label = paste0(n,"ëª…\n(",pct,"%)"),
                y = n),
            hjust=0.5, vjust=-0.2, size=6.5, fontface="bold", lineheight=0.5) +
  facet_wrap(~í•™êµê¸‰, ncol = 2, nrow = 3) +
  labs(
    title = "êµìœ¡ì§€ì›ì²­ ë„ì›€ ì—¬ë¶€\n(í•™êµê¸‰ë³„)",
    x = "ë„ì›€ì—¬ë¶€",
    y = "ì‘ë‹µìˆ˜"
  ) +
  scale_x_discrete(labels = c("ê·¸ë ‡ë‹¤", "ì•„ë‹ˆë‹¤")) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face="bold", size=32, hjust=0.5, margin = margin(b = 18), lineheight = 0.5),
    legend.position = "none",
    axis.text.x = element_text(angle=0, hjust=0.5, size=18, lineheight=0.6),
    axis.text.y = element_text(size=18),
    axis.title.x = element_text(size=20, margin = margin(t = 18)),
    axis.title.y = element_text(angle = 0, vjust = 0.5, size=20),
    strip.text = element_text(face="bold", size=15, margin = margin(t = 6, b = 6)),
    panel.spacing = unit(1.5, "lines"),
    plot.margin = margin(20, 20, 20, 20)
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.25))) +
  coord_cartesian(clip = "off")
```

### ë¬¸í•­32. \[31ë²ˆ ë¬¸í•­ì— â‘ ë¡œ ë‹µë³€í•œ ê²½ìš°ë§Œ ì‘ë‹µ\] êµìœ¡ì§€ì›ì²­ìœ¼ë¡œë¶€í„° í•™ìƒë§ì¶¤í†µí•©ì§€ì›ì„ ìœ„í•´ ë„ì›€ì„ ë°›ì€ ì˜ì—­ì€ ì–´ëŠ ì˜ì—­ì´ì—ˆìŠµë‹ˆê¹Œ? (ì¤‘ë³µì‘ë‹µ)

â‘  í•™ìƒë§ì¶¤í†µí•©ì§€ì› ì»¨ì„¤íŒ… â‘¡ ì°¾ì•„ê°€ëŠ” ì—°ìˆ˜(ì •ì±…ì•ˆë‚´) â‘¢ í•™ìƒì„±ì¥(ì‚¬ë¡€) ì§€ì› ê´€ë ¨ â‘£ ê¸°íƒ€

êµìœ¡ì§€ì›ì²­ìœ¼ë¡œë¶€í„° í•™ìƒë§ì¶¤í†µí•©ì§€ì›ì„ ìœ„í•´ ë„ì›€ì„ ë°›ì€ ì˜ì—­ ì„¤ë¬¸ì— ì´ ì‘ë‹µê±´ìˆ˜ëŠ” 1,256ê±´ì´ê³  ì´ˆë“±í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 539ê±´(42.9%) ì¤‘í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 442ê±´(35.2%)ì´ê³  ê³ ë“±í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 268ê±´(21.3%)ì´ê³ , íŠ¹ìˆ˜í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 2ê±´(0.2%)ì´ê³  ê°ì¢…í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 5ê±´(0.4%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¨

ì´ˆë“±í•™êµ ì‘ë‹µ ì¤‘ì—ì„œ êµìœ¡ì§€ì›ì²­ìœ¼ë¡œë¶€í„° í•™ìƒë§ì¶¤í†µí•©ì§€ì› ì»¨ì„¤íŒ…ìœ¼ë¡œ ë„ì›€ì„ ë°›ì•˜ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 235ê±´(43.6%), í•™ìƒì„±ì¥(ì‚¬ë¡€) ì§€ì› ê´€ë ¨ìœ¼ë¡œ ë„ì›€ì„ ë°›ì•˜ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 196ê±´(36.4%), ì°¾ì•„ê°€ëŠ” ì—°ìˆ˜(ì •ì±…ì•ˆë‚´)ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 51ê±´(9.5%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ì¤‘í•™êµì˜ ê²½ìš° êµìœ¡ì§€ì›ì²­ìœ¼ë¡œë¶€í„° í•™ìƒë§ì¶¤í†µí•©ì§€ì› ì»¨ì„¤íŒ…ìœ¼ë¡œ ë„ì›€ì„ ë°›ì•˜ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 174ê±´(39.4%), í•™ìƒì„±ì¥(ì‚¬ë¡€) ì§€ì› ê´€ë ¨ìœ¼ë¡œ ë„ì›€ì„ ë°›ì•˜ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 164ê±´(37.1%), ì°¾ì•„ê°€ëŠ” ì—°ìˆ˜(ì •ì±…ì•ˆë‚´)ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 68ê±´(15.4%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê³ ë“±í•™êµì˜ ê²½ìš° êµìœ¡ì§€ì›ì²­ìœ¼ë¡œë¶€í„° í•™ìƒë§ì¶¤í†µí•©ì§€ì› ì»¨ì„¤íŒ…ìœ¼ë¡œ ë„ì›€ì„ ë°›ì•˜ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 132ê±´(49.3%), í•™ìƒì„±ì¥(ì‚¬ë¡€) ì§€ì› ê´€ë ¨ìœ¼ë¡œ ë„ì›€ì„ ë°›ì•˜ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 69ê±´(25.7%), ì°¾ì•„ê°€ëŠ” ì—°ìˆ˜(ì •ì±…ì•ˆë‚´)ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 40ê±´(14.9%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

íŠ¹ìˆ˜í•™êµì˜ ê²½ìš° êµìœ¡ì§€ì›ì²­ìœ¼ë¡œë¶€í„° í•™ìƒì„±ì¥(ì‚¬ë¡€) ì§€ì› ê´€ë ¨ìœ¼ë¡œ ë„ì›€ì„ ë°›ì•˜ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 2ê±´(100%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê°ì¢…í•™êµì˜ ê²½ìš° êµìœ¡ì§€ì›ì²­ìœ¼ë¡œë¶€í„° í•™ìƒë§ì¶¤í†µí•©ì§€ì› ì»¨ì„¤íŒ…ìœ¼ë¡œ ë„ì›€ì„ ë°›ì•˜ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 2ê±´(40%), ì°¾ì•„ê°€ëŠ” ì—°ìˆ˜(ì •ì±…ì•ˆë‚´)ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 1ê±´(20%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
dat_q32_long <- dat %>%
  filter(as.character(ques_31) == "1") %>%  # ë¬¸í•­31ì—ì„œ "ê·¸ë ‡ë‹¤"ì¸ ê²½ìš°ë§Œ
  separate_rows(ques_32, sep = ",\\s*") %>%
  mutate(
    ques_32 = str_trim(as.character(ques_32)),
    ë¬¸í•­32 = recode(ques_32,
                   "1" = "í•™ìƒë§ì¶¤í†µí•©ì§€ì› ì»¨ì„¤íŒ…",
                   "2" = "ì°¾ì•„ê°€ëŠ” ì—°ìˆ˜(ì •ì±…ì•ˆë‚´)",
                   "3" = "í•™ìƒì„±ì¥(ì‚¬ë¡€) ì§€ì› ê´€ë ¨",
                   "4" = "ê¸°íƒ€",
                   .default = "ê¸°íƒ€"),
    í•™êµê¸‰ = factor(í•™êµê¸‰, levels = c("ì´ˆë“±í•™êµ", "ì¤‘í•™êµ", "ê³ ë“±í•™êµ", "íŠ¹ìˆ˜í•™êµ", "ê°ì¢…í•™êµ"))
  )

# ê¸°ìˆ í†µê³„
summary_q32 <- dat_q32_long %>%
  group_by(í•™êµê¸‰, ë¬¸í•­32) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

summary_q32_total <- summary_q32 %>%
  group_by(í•™êµê¸‰) %>%
  summarise(n = sum(n), pct = 100, ë¬¸í•­32 = "í•©ê³„", .groups = "drop") %>%
  bind_rows(summary_q32) %>%
  arrange(factor(í•™êµê¸‰, 
                 levels=c("ì´ˆë“±í•™êµ","ì¤‘í•™êµ","ê³ ë“±í•™êµ","íŠ¹ìˆ˜í•™êµ","ê°ì¢…í•™êµ")),
          if_else(ë¬¸í•­32 == "í•©ê³„", 2, 1),
          desc(n))

print(summary_q32_total, n = Inf)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# ì‹œê°í™”
ggplot(
  summary_q32 %>%
    mutate(ë¬¸í•­32 = reorder(ë¬¸í•­32, -n)),
  aes(x = ë¬¸í•­32, y = n, fill = ë¬¸í•­32)
) +
  geom_bar(stat = "identity", width = 0.7) +
  geom_text(aes(label = paste0(n,"ê±´\n(",pct,"%)"), 
                y = n + max(n) * 0.05),
            vjust = -0.2, hjust = 0.5, size = 6.5, lineheight = 0.5) +
  facet_wrap(~í•™êµê¸‰, ncol = 1, scales = "free_y") +
  labs(
    title = "êµìœ¡ì§€ì›ì²­ì˜ ë„ì›€ì„ ë°›ì€ ì˜ì—­",
    x = "ë„ì›€ì„ ë°›ì€ ì˜ì—­",
    y = "ì‘ë‹µìˆ˜"
  ) +
  scale_x_discrete(labels = c("í•™ìƒë§ì¶¤\ní†µí•©ì§€ì›\nì»¨ì„¤íŒ…", "ì°¾ì•„ê°€ëŠ”\n ì—°ìˆ˜\n(ì •ì±…ì•ˆë‚´)", "í•™ìƒì„±ì¥(ì‚¬ë¡€)\nì§€ì› ê´€ë ¨", "ê¸°íƒ€")) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
    legend.position = "none",
    axis.text.x = element_text(angle = 0, vjust = 0.8, lineheight = 0.6, size = 17),
    axis.text.y = element_text(size = 17),
    strip.text = element_text(face = "bold", size = 20),
    axis.title.x = element_text(size = 20, margin = margin(t = 18)),
    axis.title.y = element_text(angle = 0, vjust = 0.5, size = 20)
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.15))) +
  coord_cartesian(clip = "off")
```

### ë¬¸í•­33. \[32ë²ˆ ë¬¸í•­ì— â‘ í•­ìœ¼ë¡œ ë‹µë³€í•œ ê²½ìš°ë§Œ ì‘ë‹µ\] í•™ìƒë§ì¶¤í†µí•©ì§€ì›ìœ¼ë¡œ ì»¨ì„¤íŒ…ì„ ë°›ì•˜ë‹¤ë©´ ì–´ëŠ ë¶„ì•¼ì˜ ì»¨ì„¤íŒ…ì„ ë°›ì•˜ë‚˜ìš”? (ì¤‘ë³µì‘ë‹µ)

â‘  í†µí•©ì§€ì›íŒ€ êµ¬ì„±ã†ìš´ì˜ â‘¡ í•™ìƒ ì‚¬ë¡€ì§€ì› ë°©ì•ˆ â‘¢ ì§€ì—­ìì› ì—°ê³„ ë°©ì•ˆ â‘£ ê¸°íƒ€

êµìœ¡ì§€ì›ì²­ìœ¼ë¡œë¶€í„° í•™ìƒë§ì¶¤í†µí•©ì§€ì›ì„ ìœ„í•´ ì»¨ì„¤íŒ…ì„ ë°›ì€ ì˜ì—­ ì„¤ë¬¸ì— ì´ ì‘ë‹µê±´ìˆ˜ëŠ” 553ê±´ì´ê³  ì´ˆë“±í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 239ê±´(43.2%) ì¤‘í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 172ê±´(31.1%)ì´ê³  ê³ ë“±í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 141ê±´(25.5%)ì´ê³ , ê°ì¢…í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 1ê±´(0.2%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¨

ì´ˆë“±í•™êµì˜ ê²½ìš° êµìœ¡ì§€ì›ì²­ë¡œë¶€í„° í•™ìƒ ì‚¬ë¡€ì§€ì› ë°©ì•ˆì— ëŒ€í•´ ì»¨ì„¤íŒ…ì„ ë°›ì•˜ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 115ê±´(48.1%), í†µí•©ì§€ì›íŒ€ êµ¬ì„±ã†ìš´ì˜ ë°©ì•ˆì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 72ê±´(30.1%), ì§€ì—­ìì› ì—°ê³„ ë°©ì•ˆì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 45ê±´(18.8%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ì¤‘í•™êµì˜ ê²½ìš° êµìœ¡ì§€ì›ì²­ë¡œë¶€í„° í•™ìƒ ì‚¬ë¡€ì§€ì› ë°©ì•ˆì— ëŒ€í•´ ì»¨ì„¤íŒ…ì„ ë°›ì•˜ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 75ê±´(43.6%), í†µí•©ì§€ì›íŒ€ êµ¬ì„±ã†ìš´ì˜ ë°©ì•ˆì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 60ê±´(34.9%), ì§€ì—­ìì› ì—°ê³„ ë°©ì•ˆì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 35ê±´(20.3%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê³ ë“±í•™êµì˜ ê²½ìš° êµìœ¡ì§€ì›ì²­ë¡œë¶€í„° í†µí•©ì§€ì›íŒ€ êµ¬ì„±ã†ìš´ì˜ë°©ì•ˆìœ¼ë¡œ ì»¨ì„¤íŒ…ì„ ë°›ì•˜ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 58ê±´(41.1%), í•™ìƒ ì‚¬ë¡€ì§€ì› ë°©ì•ˆì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 54ê±´(38.3%), ì§€ì—­ìì› ì—°ê³„ ë°©ì•ˆì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 29ê±´(20.6%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê°ì¢…í•™êµì˜ ê²½ìš° êµìœ¡ì§€ì›ì²­ë¡œë¶€í„° í†µí•©ì§€ì›íŒ€ êµ¬ì„±ã†ìš´ì˜ ë°©ì•ˆìœ¼ë¡œ ì»¨ì„¤íŒ…ì„ ë°›ì•˜ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 1ê±´(100%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
dat_q33_long <- dat %>%
  filter(!is.na(ques_32), !is.na(ques_33)) %>%
  filter(as.character(ques_32) == "1") %>%  # ë¬¸í•­32ì—ì„œ "1"ì¸ ê²½ìš°ë§Œ
  separate_rows(ques_33, sep = ",\\s*") %>%
  mutate(
    ques_33 = str_trim(as.character(ques_33)),
    ë¬¸í•­33 = recode(ques_33,
                   "1" = "í†µí•©ì§€ì›íŒ€ êµ¬ì„±Â·ìš´ì˜",
                   "2" = "í•™ìƒ ì‚¬ë¡€ì§€ì› ë°©ì•ˆ",
                   "3" = "ì§€ì—­ìì› ì—°ê³„ ë°©ì•ˆ",
                   "4" = "ê¸°íƒ€",
                   .default = "ê¸°íƒ€"),
    í•™êµê¸‰ = factor(í•™êµê¸‰, levels = c("ì´ˆë“±í•™êµ", "ì¤‘í•™êµ", "ê³ ë“±í•™êµ", "íŠ¹ìˆ˜í•™êµ", "ê°ì¢…í•™êµ"))
  )

# ê¸°ìˆ í†µê³„
summary_q33 <- dat_q33_long %>%
  group_by(í•™êµê¸‰, ë¬¸í•­33) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

summary_q33_total <- summary_q33 %>%
  group_by(í•™êµê¸‰) %>%
  summarise(n = sum(n), pct = 100, ë¬¸í•­33 = "í•©ê³„", .groups = "drop") %>%
  bind_rows(summary_q33) %>%
  arrange(factor(í•™êµê¸‰, 
                 levels=c("ì´ˆë“±í•™êµ","ì¤‘í•™êµ","ê³ ë“±í•™êµ","íŠ¹ìˆ˜í•™êµ","ê°ì¢…í•™êµ")),
          if_else(ë¬¸í•­33 == "í•©ê³„", 2, 1),
          desc(n))

print(summary_q33_total, n = Inf)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# ì‹œê°í™”
ggplot(
  summary_q33 %>%
    mutate(ë¬¸í•­33 = reorder(ë¬¸í•­33, -n)),
  aes(x = ë¬¸í•­33, y = n, fill = ë¬¸í•­33)
) +
  geom_bar(stat = "identity", width = 0.7) +
  geom_text(aes(label = paste0(n,"ê±´\n(",pct,"%)"), 
                y = n + max(n) * 0.05),
            vjust = -0.2, hjust = 0.5, size = 7, lineheight = 0.4) +
  facet_wrap(~í•™êµê¸‰, ncol = 1, scales = "free_y") +
  labs(
    title = "ì»¨ì„¤íŒ… ë°›ì€ ë¶„ì•¼",
    x = "ì»¨ì„¤íŒ… ë¶„ì•¼",
    y = "ì‘ë‹µìˆ˜"
  ) +
  scale_x_discrete(labels = c("í†µí•©ì§€ì›íŒ€\nêµ¬ì„±Â·ìš´ì˜", "í•™ìƒ ì‚¬ë¡€ì§€ì›\në°©ì•ˆ", "ì§€ì—­ìì›\nì—°ê³„ ë°©ì•ˆ", "ê¸°íƒ€")) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
    legend.position = "none",
    axis.text.x = element_text(angle = 0, vjust = 0.8, lineheight = 0.5, size = 18),
    axis.text.y = element_text(size = 20),
    strip.text = element_text(face = "bold", size = 20),
    axis.title.x = element_text(size = 20, margin = margin(t = 18)),
    axis.title.y = element_text(angle = 0, vjust = 0.5, size = 20)
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.15))) +
  coord_cartesian(clip = "off")
```

### ë¬¸í•­34. \[33ë²ˆ ë¬¸í•­ì— ë‹µë³€í•œ ê²½ìš°ë§Œ ì‘ë‹µ\] êµìœ¡ì§€ì›ì²­ì˜ ì»¨ì„¤íŒ…ì´ í•™êµì— ë„ì›€ì´ ë˜ì—ˆìŠµë‹ˆê¹Œ?

â‘  ë§¤ìš° ê·¸ë ‡ë‹¤ â‘¡ ê·¸ë ‡ë‹¤ â‘¢ ë³´í†µì´ë‹¤ â‘£ ê·¸ë ‡ì§€ ì•Šë‹¤ â‘¤ ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤

êµìœ¡ì§€ì›ì²­ì˜ ì»¨ì„¤íŒ…ì´ í•™êµì— ë„ì›€ì´ ë˜ì—ˆëŠ”ì§€ì— ëŒ€í•œ ë¬¸í•­ì˜ ì´ ì‘ë‹µìëŠ” 52ëª…ì´ë©° ë§¤ìš° ê·¸ë ‡ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µì€ 227ëª…(43.2%), ê·¸ë ‡ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µì€ 227ëª…(43.2%), ë³´í†µì´ë‹¤ë¼ê³  ë‹µë³€í•œ ì‘ë‹µì€ 55ëª…(10.5%), ê·¸ë ‡ì§€ ì•Šë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µì€ 10ëª…(1.9%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µì€ 7ëª…(1.3%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
ques34_freq <- dat %>%
  # ì¡°ê±´ë¶€ ì‘ë‹µ í•„í„°ë§: 32ë²ˆì—ì„œ 1ë²ˆ ì„ íƒ + 33ë²ˆ ì‘ë‹µ + 34ë²ˆ ì‘ë‹µ
  filter(!is.na(ques_32), 
         !is.na(ques_33), 
         !is.na(ques_34),
         str_detect(as.character(ques_32), "1"),  # 32ë²ˆì—ì„œ 1ë²ˆ(ì»¨ì„¤íŒ…) í¬í•¨
         ques_34 %in% as.character(1:5)) %>%
  count(ques_34) %>%
  mutate(
    ì‘ë‹µ = recode(ques_34,
                 "1" = "ë§¤ìš° ê·¸ë ‡ë‹¤",
                 "2" = "ê·¸ë ‡ë‹¤", 
                 "3" = "ë³´í†µì´ë‹¤",
                 "4" = "ê·¸ë ‡ì§€ ì•Šë‹¤",
                 "5" = "ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤"),
    pct = round(n / sum(n) * 100, 1)
  ) %>%
  arrange(desc(n)) %>%
  bind_rows(summarise(., ì‘ë‹µ = "í•©ê³„", n = sum(n), pct = sum(pct)))

print(ques34_freq %>% select(ì‘ë‹µ, n, pct), n = Inf)
```

```{r}
#| echo: false
#| warning: false
#| message: false
ggplot(ques34_freq %>% filter(ì‘ë‹µ != "í•©ê³„"), aes(x = reorder(ì‘ë‹µ, -n), y = n, fill = ì‘ë‹µ)) +
  geom_bar(stat = "identity", width = 0.5) +
  geom_text(aes(label = paste0(n, "ëª… (", pct, "%)")), 
            vjust = -0.5, size = 7) +
  labs(
    title = "êµìœ¡ì§€ì›ì²­ ì»¨ì„¤íŒ…ì˜ ë„ì›€ ì •ë„",
    x = "ë„ì›€ ì •ë„",
    y = "ì‘ë‹µìˆ˜"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(size = 32, face = "bold", hjust = 0.5),
    axis.text.x = element_text(angle=0, hjust=0.5, size=20, lineheight=0.5),
    axis.text.y = element_text(size=20),
    axis.title.x = element_text(size=20, margin = margin(t = 18)),
    axis.title.y = element_text(angle = 0, vjust = 0.5, size=20),
    strip.text = element_text(face="bold", size=23, margin = margin(t = 6, b = 6)),
    panel.spacing = unit(1.5, "lines"), plot.margin = margin(20, 20, 20, 20),
    legend.position = "none"
  ) +
  ylim(0, max(ques34_freq$n) * 1.15)
```

### ë¬¸í•­ 34-1. ì§ì±…ë³„ ì»¨ì„¤íŒ… ìœ ìš©ì„± ì¸ì‹ ë¶„ì„

ì§ì±…ë³„ ì‘ë‹µìëŠ” ì´ 524ëª…ì´ê³  ì´ ì¤‘ì—ì„œ í•™êµì¥ ì‘ë‹µê±´ìˆ˜ëŠ” 102ëª…(19.5%), êµê° ì‘ë‹µê±´ìˆ˜ëŠ” 116ëª…(22.1%), êµì‚¬ ë“± ì‘ë‹µê±´ìˆ˜ëŠ” 306ëª…(58.4%)ì´ì—ˆìŒ

í•™êµì¥ ì‘ë‹µ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 53ëª…(52%), ê·¸ë ‡ë‹¤ëŠ” 50ëª…(43.1%), ë³´í†µì´ë‹¤ëŠ” 5ëª…(4.9%)ì´ì—ˆìŒ.

êµê° ì‘ë‹µ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 53ëª…(45.7%), ê·¸ë ‡ë‹¤ëŠ” 50ëª…(43.1%), ë³´í†µì´ë‹¤ëŠ” 12ëª…(10.3%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 1ëª…(0.9%)ì´ì—ˆìŒ

êµì‚¬ ë“± ì‘ë‹µ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 121ëª…(39.5%), ê·¸ë ‡ë‹¤ëŠ” 131ëª…(42.8%), ë³´í†µì´ë‹¤ëŠ” 38ëª…(12.4%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 9ëª…(2.9%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 7ëª…(2.3%)ì´ì—ˆìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
## 1. ì§ì±…ë³„ ë¶„ì„

dat_filtered_34 <- dat %>%
  filter(ques_1 %in% c(1,2,3),
         !is.na(ques_33), 
         !is.na(ques_34),
         str_detect(as.character(ques_32), "1"),  # 32ë²ˆì—ì„œ 1ë²ˆ(ì»¨ì„¤íŒ…) í¬í•¨
         ques_34 %in% as.character(1:5)) %>%
  mutate(
    ì§ì±… = case_when(
      ques_7 == 1 ~ "í•™êµì¥",
      ques_7 == 2 ~ "êµê°", 
      TRUE ~ "êµì‚¬ ë“±"
    ),
    ì»¨ì„¤íŒ…ë„ì›€ì •ë„ = factor(as.character(ques_34),
                     levels = c("1","2","3","4","5"),
                     labels = c("ë§¤ìš° ê·¸ë ‡ë‹¤","ê·¸ë ‡ë‹¤","ë³´í†µì´ë‹¤","ê·¸ë ‡ì§€ ì•Šë‹¤","ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤"))
  )

# ì§ì±…ë³„ ê¸°ìˆ í†µê³„ (í•©ê³„ í¬í•¨)
summary_job_table_34 <- dat_filtered_34 %>%
  group_by(ì§ì±…, ì»¨ì„¤íŒ…ë„ì›€ì •ë„) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

summary_job_with_total_34 <- summary_job_table_34 %>%
  group_by(ì§ì±…) %>%
  summarise(n = sum(n), pct = sum(pct), ì»¨ì„¤íŒ…ë„ì›€ì •ë„ = "í•©ê³„") %>%
  bind_rows(summary_job_table_34) %>%
  arrange(
    factor(ì§ì±…, levels = c("í•™êµì¥","êµê°","êµì‚¬ ë“±")),
    ì»¨ì„¤íŒ…ë„ì›€ì •ë„ == "í•©ê³„",
    if_else(ì»¨ì„¤íŒ…ë„ì›€ì •ë„ != "í•©ê³„", -n, 0)
  )

summary_job_final_34 <- summary_job_with_total_34 %>%
  bind_rows(
    summary_job_with_total_34 %>%
      summarise(ì§ì±… = "ì „ì²´ í•©ê³„", n = sum(n[ì»¨ì„¤íŒ…ë„ì›€ì •ë„ == "í•©ê³„"]), pct = 100, ì»¨ì„¤íŒ…ë„ì›€ì •ë„ = "í•©ê³„")
  )

print(summary_job_final_34, n = Inf)

# ì¹´ì´ì œê³± ê²€ì •
tab1_34 <- table(dat_filtered_34$ì§ì±…, dat_filtered_34$ì»¨ì„¤íŒ…ë„ì›€ì •ë„)
chisq_test1_34 <- chisq.test(tab1_34)
print(chisq_test1_34)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# ëˆ„ì ë§‰ëŒ€ê·¸ë˜í”„
summary_job_plot_34 <- summary_job_table_34 %>%
  mutate(ì»¨ì„¤íŒ…ë„ì›€ì •ë„ = factor(ì»¨ì„¤íŒ…ë„ì›€ì •ë„, 
                          levels = c("ë§¤ìš° ê·¸ë ‡ë‹¤", "ê·¸ë ‡ë‹¤", "ë³´í†µì´ë‹¤", 
                                   "ê·¸ë ‡ì§€ ì•Šë‹¤", "ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤")))

ggplot(summary_job_plot_34, aes(x = factor(ì§ì±…, levels = c("í•™êµì¥", "êµê°", "êµì‚¬ ë“±")), 
                                    y = pct, fill = ì»¨ì„¤íŒ…ë„ì›€ì •ë„)) +
  geom_bar(stat = "identity", width = 0.7) +
  labs(
    title = "ì§ì±…ë³„ ì»¨ì„¤íŒ… ë„ì›€ì •ë„ ì¸ì‹",
    x = "ì§ì±…",
    y = "ë¹„ìœ¨",
    fill = "ì»¨ì„¤íŒ…ë„ì›€ì •ë„"
  ) +
  scale_y_continuous(limits = c(0, 100), expand = expansion(mult = c(0, 0.02))) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
    axis.text.x = element_text(size = 20, face = "bold"),
    axis.text.y = element_text(size = 18),
    axis.title.x = element_text(size = 25, angle = 0, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),
    legend.position = "right",
    legend.text = element_text(size = 14),
    legend.title = element_text(size = 16, face = "bold")
  )
```

êµìœ¡ì§€ì›ì²­ì˜ ì»¨ì„¤íŒ…ì´ í•™êµì— ë„ì›€ì´ ë˜ì—ˆëŠ”ì§€ì— ëŒ€í•´ ì§ì±…ë³„ í‰ê· ì ìˆ˜ë¥¼ ë¹„êµí•œ ê²°ê³¼, í•™êµì¥(4.47), êµê°(4.34), êµì‚¬ ë“±(4.14)ìœ¼ë¡œ í•™êµì¥-êµì‚¬ ë“± ê°„ì—ëŠ” ìœ ì˜ë¯¸í•œ ì°¨ì´ê°€ ìˆì—ˆìœ¼ë‚˜, í•™êµì¥-êµê°, êµê°-êµì‚¬ ë“± ê°„ì—ëŠ” ì»¨ì„¤íŒ…ì´ í•™êµì— ë„ì›€ì´ ë˜ì—ˆëŠ”ì§€ì— ëŒ€í•œ í‰ê· ì ìˆ˜ì— ìœ ì˜ë¯¸í•œ ì°¨ì´ê°€ ìˆì§€ëŠ” ì•Šì•˜ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
# ANOVA ë¶„ì„
dat_score_job_34 <- dat_filtered_34 %>%
  filter(!is.na(ques_34)) %>%
  mutate(
    ì»¨ì„¤íŒ…ë„ì›€ì •ë„ì ìˆ˜ = case_when(
      ques_34 == 1 ~ 5,   # ë§¤ìš° ê·¸ë ‡ë‹¤
      ques_34 == 2 ~ 4,   # ê·¸ë ‡ë‹¤
      ques_34 == 3 ~ 3,   # ë³´í†µì´ë‹¤
      ques_34 == 4 ~ 2,   # ê·¸ë ‡ì§€ ì•Šë‹¤
      ques_34 == 5 ~ 1,   # ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤
      TRUE ~ NA_real_
    ),
    ì§ì±… = factor(ì§ì±…, levels = c("í•™êµì¥", "êµê°", "êµì‚¬ ë“±"))
  )

job_stats_34 <- dat_score_job_34 %>%
  group_by(ì§ì±…) %>%
  summarise(
    í‰ê·  = round(mean(ì»¨ì„¤íŒ…ë„ì›€ì •ë„ì ìˆ˜, na.rm = TRUE), 2),
    í‘œì¤€í¸ì°¨ = round(sd(ì»¨ì„¤íŒ…ë„ì›€ì •ë„ì ìˆ˜, na.rm = TRUE), 2),
    n = n(),
    .groups = "drop"
  ) %>%
  arrange(ì§ì±…)

print(job_stats_34)

anova_job_34 <- aov(ì»¨ì„¤íŒ…ë„ì›€ì •ë„ì ìˆ˜ ~ ì§ì±…, data = dat_score_job_34)
summary(anova_job_34)

tukey_job_34 <- TukeyHSD(anova_job_34)
print(tukey_job_34)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# ë°•ìŠ¤í”Œë¡¯
tukey_letters_job_34 <- multcompView::multcompLetters4(anova_job_34, tukey_job_34)
letters_df_job_34 <- data.frame(
  ì§ì±… = names(tukey_letters_job_34$`ì§ì±…`$Letters),
  group = tukey_letters_job_34$`ì§ì±…`$Letters
)

job_stats_with_groups_34 <- job_stats_34 %>%
  left_join(letters_df_job_34, by = "ì§ì±…")

ggplot(dat_score_job_34, aes(x = factor(ì§ì±…, levels = c("í•™êµì¥", "êµê°", "êµì‚¬ ë“±")), y = ì»¨ì„¤íŒ…ë„ì›€ì •ë„ì ìˆ˜, fill = ì§ì±…)) +
  geom_boxplot(alpha = 0.7, width = 0.6, outlier.shape = 21) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 10, fill = "yellow", stroke = 1) +
  geom_text(data = job_stats_with_groups_34, 
            aes(x = ì§ì±…, y = 8, label = paste0(group, "\n(M=", í‰ê· , ")")),
            inherit.aes = FALSE, fontface = "bold", size = 8, vjust = 0, lineheight = 0.5) +
  labs(
    title = "ì§ì±…ë³„ ì»¨ì„¤íŒ… ìœ ìš©ì„± ì¸ì‹",
    x = "ì§ì±…", 
    y = "ì»¨ì„¤íŒ… ìœ ìš©ì„±"
  ) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
    axis.text.x = element_text(size = 20),
    axis.text.y = element_text(size = 20),
    axis.title.x = element_text(size = 20, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),
    legend.position = "none"
  ) +
  scale_y_continuous(expand = expansion(mult = c(0.05, 0.15)))
```

### ë¬¸í•­ 34-2. í•™êµê¸‰ë³„ ì»¨ì„¤íŒ… ìœ ìš©ì„± ì¸ì‹ ë¶„ì„

í•™êµê¸‰ë³„ ì‘ë‹µìëŠ” 524ëª…ì´ê³  ì´ˆë“±í•™êµ ì‘ë‹µìëŠ” 226ëª…(43.13%), ì¤‘í•™êµ ì‘ë‹µìëŠ” 170ëª…(32.44%), ê³ ë“±í•™êµ ì‘ë‹µìëŠ” 128ëª…(24.43%)ì´ ì‘ë‹µí•˜ì˜€ìŒ.

ì´ˆë“±í•™êµ ì‘ë‹µê±´ìˆ˜ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 101ëª…(44.7%), ê·¸ë ‡ë‹¤ëŠ” 96ëª…(42.5%), ë³´í†µì´ë‹¤ëŠ” 22ëª…(9.7%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 5ëª…(2.2%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 2ëª…(0.9%)ì´ì—ˆìŒ

ì¤‘í•™êµ ì‘ë‹µê±´ìˆ˜ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 72ëª…(42.4%), ê·¸ë ‡ë‹¤ëŠ” 74ëª…(43.5%), ë³´í†µì´ë‹¤ëŠ” 19ëª…(11.2%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 3ëª…(1.8%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 2ëª…(1.2%)ì´ì—ˆìŒ

ê³ ë“±í•™êµ ì‘ë‹µê±´ìˆ˜ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 54ëª…(42.2%), ê·¸ë ‡ë‹¤ëŠ” 55ëª…(43%), ë³´í†µì´ë‹¤ëŠ” 14ëª…(10.9%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 3ëª…(2.3%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 2ëª…(1.6%)ì´ì—ˆìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
## 3. í•™êµê¸‰ë³„ ë¶„ì„

# í•™êµê¸‰ë³„ ê¸°ìˆ í†µê³„ (í•©ê³„ í¬í•¨)
summary_school_table_34 <- dat_filtered_34 %>%
  group_by(í•™êµê¸‰, ì»¨ì„¤íŒ…ë„ì›€ì •ë„) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

summary_school_with_total_34 <- summary_school_table_34 %>%
  group_by(í•™êµê¸‰) %>%
  summarise(n = sum(n), pct = sum(pct), ì»¨ì„¤íŒ…ë„ì›€ì •ë„ = "í•©ê³„") %>%
  bind_rows(summary_school_table_34) %>%
  arrange(
    factor(í•™êµê¸‰, levels = c("ì´ˆë“±í•™êµ","ì¤‘í•™êµ","ê³ ë“±í•™êµ")),
    ì»¨ì„¤íŒ…ë„ì›€ì •ë„ == "í•©ê³„",
    if_else(ì»¨ì„¤íŒ…ë„ì›€ì •ë„ != "í•©ê³„", -n, 0)
  )

summary_school_final_34 <- summary_school_with_total_34 %>%
  bind_rows(
    summary_school_with_total_34 %>%
      summarise(í•™êµê¸‰ = "ì „ì²´ í•©ê³„", n = sum(n[ì»¨ì„¤íŒ…ë„ì›€ì •ë„ == "í•©ê³„"]), pct = 100, ì»¨ì„¤íŒ…ë„ì›€ì •ë„ = "í•©ê³„")
  )

print(summary_school_final_34, n = Inf)

# ì¹´ì´ì œê³± ê²€ì •
tab_school_34 <- table(dat_filtered_34$í•™êµê¸‰, dat_filtered_34$ì»¨ì„¤íŒ…ë„ì›€ì •ë„)
chisq_test_school_34 <- chisq.test(tab_school_34)
print(chisq_test_school_34)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# ëˆ„ì ë§‰ëŒ€ê·¸ë˜í”„
summary_school_plot_34 <- summary_school_table_34 %>%
  mutate(ì»¨ì„¤íŒ…ë„ì›€ì •ë„ = factor(ì»¨ì„¤íŒ…ë„ì›€ì •ë„, 
                          levels = c("ë§¤ìš° ê·¸ë ‡ë‹¤", "ê·¸ë ‡ë‹¤", "ë³´í†µì´ë‹¤", 
                                   "ê·¸ë ‡ì§€ ì•Šë‹¤", "ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤")))

ggplot(summary_school_plot_34, aes(x = factor(í•™êµê¸‰, levels = c("ì´ˆë“±í•™êµ", "ì¤‘í•™êµ", "ê³ ë“±í•™êµ")), y = pct, fill = ì»¨ì„¤íŒ…ë„ì›€ì •ë„)) +
  geom_bar(stat = "identity", width = 0.7) +
  labs(
    title = "í•™êµê¸‰ë³„ ì»¨ì„¤íŒ… ë„ì›€ì •ë„ ì¸ì‹",
    x = "í•™êµê¸‰",
    y = "ë¹„ìœ¨",
    fill = "ì»¨ì„¤íŒ…ë„ì›€ì •ë„"
  ) +
  scale_y_continuous(limits = c(0, 100), expand = expansion(mult = c(0, 0.02))) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(size = 32, face = "bold", hjust = 0.5),
    axis.text.x = element_text(size = 18, margin = margin(t = 10)),
    axis.text.y = element_text(size = 18),
    axis.title.x = element_text(size = 20, angle = 0, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),
    legend.position = "right",
    legend.text = element_text(size = 14),
    legend.title = element_text(size = 16, face = "bold")
  )
```

êµìœ¡ì§€ì›ì²­ì˜ ì»¨ì„¤íŒ…ì´ í•™êµì— ë„ì›€ì´ ë˜ì—ˆëŠ”ì§€ì— ëŒ€í•´ í•™êµê¸‰ë³„ í‰ê· ì ìˆ˜ë¥¼ ë¹„êµí•œ ê²°ê³¼, ì´ˆë“±í•™êµ(4.28), ì¤‘í•™êµ(4.24), ê³ ë“±í•™êµ(4.22)ì´ì—ˆìœ¼ë©°, í•™êµê¸‰ë³„ ìœ ì˜ë¯¸í•œ ì°¨ì´ê°€ ìˆì§€ëŠ” ì•Šì•˜ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
# í•™êµê¸‰ë³„ ANOVA
school_stats_34 <- dat_score_job_34 %>%
  mutate(í•™êµê¸‰ = factor(í•™êµê¸‰, levels = c("ì´ˆë“±í•™êµ", "ì¤‘í•™êµ", "ê³ ë“±í•™êµ"))) %>%
  group_by(í•™êµê¸‰) %>%
  summarise(
    í‰ê·  = round(mean(ì»¨ì„¤íŒ…ë„ì›€ì •ë„ì ìˆ˜, na.rm = TRUE), 2),
    í‘œì¤€í¸ì°¨ = round(sd(ì»¨ì„¤íŒ…ë„ì›€ì •ë„ì ìˆ˜, na.rm = TRUE), 2),
    n = n(),
    .groups = "drop"
  ) %>%
  arrange(í•™êµê¸‰)

print(school_stats_34)

anova_school_34 <- aov(ì»¨ì„¤íŒ…ë„ì›€ì •ë„ì ìˆ˜ ~ í•™êµê¸‰, data = dat_score_job_34)
summary(anova_school_34)

tukey_school_34 <- TukeyHSD(anova_school_34)
print(tukey_school_34)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# ë°•ìŠ¤í”Œë¡¯
tukey_letters_school_34 <- multcompView::multcompLetters4(anova_school_34, tukey_school_34)
letters_df_school_34 <- data.frame(
  í•™êµê¸‰ = names(tukey_letters_school_34$`í•™êµê¸‰`$Letters),
  group = tukey_letters_school_34$`í•™êµê¸‰`$Letters
)

school_stats_with_groups_34 <- school_stats_34 %>%
  left_join(letters_df_school_34, by = "í•™êµê¸‰")

ggplot(dat_score_job_34, aes(x = factor(í•™êµê¸‰, levels = c("ì´ˆë“±í•™êµ", "ì¤‘í•™êµ", "ê³ ë“±í•™êµ")), y = ì»¨ì„¤íŒ…ë„ì›€ì •ë„ì ìˆ˜, fill = í•™êµê¸‰)) +
  geom_boxplot(alpha = 0.7, width = 0.6, outlier.shape = 21) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 10, fill = "yellow", stroke = 1) +
  geom_text(data = school_stats_with_groups_34, 
            aes(x = í•™êµê¸‰, y = 8, label = paste0(group, "\n(M=", í‰ê· , ")")),
            inherit.aes = FALSE, fontface = "bold", size = 8, vjust = 0, lineheight = 0.5) +
  labs(
    title = "í•™êµê¸‰ë³„ ì»¨ì„¤íŒ… ìœ ìš©ì„±",
    x = "í•™êµê¸‰", 
    y = "ì»¨ì„¤íŒ… ìœ ìš©ì„±"
  ) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
    axis.text.x = element_text(size = 20),
    axis.text.y = element_text(size = 20),
    axis.title.x = element_text(size = 20, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),
    legend.position = "none"
  ) +
  scale_y_continuous(expand = expansion(mult = c(0.05, 0.15)))
```

### ë¬¸í•­ 34-3. ì„¤ë¦½ë³„ ì»¨ì„¤íŒ… ìœ ìš©ì„± ì¸ì‹ ë¶„ì„

ì„¤ë¦½ë³„ ì‘ë‹µìëŠ” 524ê±´ì´ê³  ê³µë¦½í•™êµ ì‘ë‹µìëŠ” 394ëª…(75.2%), ì‚¬ë¦½í•™êµ ì‘ë‹µìëŠ” 130ëª…(24.8%)ì´ ì‘ë‹µí•˜ì˜€ìŒ.

ê³µë¦½í•™êµ ì‘ë‹µê±´ìˆ˜ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 165ëª…(41.9%), ê·¸ë ‡ë‹¤ëŠ” 170ëª…(43.1%), ë³´í†µì´ë‹¤ëŠ” 45ëª…(11.4%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 8ëª…(2%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 6ëª…(1.5%)ì´ì—ˆìŒ

ì‚¬ë¦½í•™êµ ì‘ë‹µê±´ìˆ˜ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 62ëª…(47.7%), ê·¸ë ‡ë‹¤ëŠ” 55ëª…(42.3%), ë³´í†µì´ë‹¤ëŠ” 10ëª…(7.7%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 2ëª…(1.5%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 1ëª…(0.8%)ì´ì—ˆìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
# ì„¤ë¦½ë³„ ë°ì´í„° ì¤€ë¹„
dat_found_34 <- dat_filtered_34 %>%
  filter(ì„¤ë¦½ %in% c("ê³µë¦½", "ì‚¬ë¦½")) %>%
  mutate(ì„¤ë¦½ = factor(ì„¤ë¦½, levels = c("ê³µë¦½", "ì‚¬ë¦½")))

# ì„¤ë¦½ë³„ ê¸°ìˆ í†µê³„ (í•©ê³„ í¬í•¨)
summary_found_table_34 <- dat_found_34 %>%
  group_by(ì„¤ë¦½, ì»¨ì„¤íŒ…ë„ì›€ì •ë„) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

summary_found_with_total_34 <- summary_found_table_34 %>%
  group_by(ì„¤ë¦½) %>%
  summarise(n = sum(n), pct = sum(pct), ì»¨ì„¤íŒ…ë„ì›€ì •ë„ = "í•©ê³„") %>%
  bind_rows(summary_found_table_34) %>%
  arrange(ì„¤ë¦½, ì»¨ì„¤íŒ…ë„ì›€ì •ë„ == "í•©ê³„", if_else(ì»¨ì„¤íŒ…ë„ì›€ì •ë„ != "í•©ê³„", -n, 0))

summary_found_final_34 <- summary_found_with_total_34 %>%
  bind_rows(
    summary_found_with_total_34 %>%
      summarise(ì„¤ë¦½ = "ì „ì²´ í•©ê³„", n = sum(n[ì»¨ì„¤íŒ…ë„ì›€ì •ë„ == "í•©ê³„"]), pct = 100, ì»¨ì„¤íŒ…ë„ì›€ì •ë„ = "í•©ê³„")
  )

print(summary_found_final_34, n = Inf)

# ì¹´ì´ì œê³± ê²€ì •
tab_found_34 <- table(dat_found_34$ì„¤ë¦½, dat_found_34$ì»¨ì„¤íŒ…ë„ì›€ì •ë„)
print(tab_found_34)
chisq_test_found_34 <- chisq.test(tab_found_34)
print(chisq_test_found_34)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# ëˆ„ì ë§‰ëŒ€ê·¸ë˜í”„
summary_found_plot_34 <- summary_found_table_34 %>%
  mutate(ì»¨ì„¤íŒ…ë„ì›€ì •ë„ = factor(ì»¨ì„¤íŒ…ë„ì›€ì •ë„, 
                          levels = c("ë§¤ìš° ê·¸ë ‡ë‹¤", "ê·¸ë ‡ë‹¤", "ë³´í†µì´ë‹¤", 
                                   "ê·¸ë ‡ì§€ ì•Šë‹¤", "ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤")))

ggplot(summary_found_plot_34, aes(x = ì„¤ë¦½, y = pct, fill = ì»¨ì„¤íŒ…ë„ì›€ì •ë„)) +
  geom_bar(stat = "identity", width = 0.7) +
  labs(
    title = "ì„¤ë¦½ë³„ ì»¨ì„¤íŒ… ìœ ìš©ì„± ì¸ì‹",
    x = "ì„¤ë¦½",
    y = "ë¹„ìœ¨",
    fill = "ì»¨ì„¤íŒ… ìœ ìš©ì„±"
  ) +
  scale_y_continuous(limits = c(0, 100), expand = expansion(mult = c(0, 0.02))) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(size = 32, face = "bold", hjust = 0.5),
    axis.text.x = element_text(size = 18, margin = margin(t = 10)),
    axis.text.y = element_text(size = 18),
    axis.title.x = element_text(size = 20, angle = 0, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),
    legend.position = "right",
    legend.text = element_text(size = 14),
    legend.title = element_text(size = 16, face = "bold")
  )
```

êµìœ¡ì§€ì›ì²­ì˜ ì»¨ì„¤íŒ…ì´ í•™êµì— ë„ì›€ì´ ë˜ì—ˆëŠ”ì§€ì— ëŒ€í•´ ì„¤ë¦½ë³„ í‰ê· ì ìˆ˜ë¥¼ ë¹„êµí•œ ê²°ê³¼, ê³µë¦½í•™êµ(4.22), ì‚¬ë¦½í•™êµ(4.35)ì—ì„œ êµìœ¡ì§€ì›ì²­ ì»¨ì„¤íŒ…ì´ ë„ì›€ì´ ë˜ì—ˆëŠ”ì§€ì— ëŒ€í•´ ìœ ì˜ë¯¸í•œ ì°¨ì´ê°€ ìˆì§€ëŠ” ì•Šì•˜ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
# T-test ë¶„ì„
dat_score_found_34 <- dat_found_34 %>%
  mutate(
    ì»¨ì„¤íŒ…ë„ì›€ì •ë„ì ìˆ˜ = case_when(
      ques_34 == 1 ~ 5,   # ë§¤ìš° ê·¸ë ‡ë‹¤
      ques_34 == 2 ~ 4,   # ê·¸ë ‡ë‹¤
      ques_34 == 3 ~ 3,   # ë³´í†µì´ë‹¤
      ques_34 == 4 ~ 2,   # ê·¸ë ‡ì§€ ì•Šë‹¤
      ques_34 == 5 ~ 1,   # ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤
      TRUE ~ NA_real_
    )
  )

found_stats_34 <- dat_score_found_34 %>%
  group_by(ì„¤ë¦½) %>%
  summarise(
    í‰ê·  = round(mean(ì»¨ì„¤íŒ…ë„ì›€ì •ë„ì ìˆ˜, na.rm = TRUE), 2),
    í‘œì¤€í¸ì°¨ = round(sd(ì»¨ì„¤íŒ…ë„ì›€ì •ë„ì ìˆ˜, na.rm = TRUE), 2),
    n = n(),
    .groups = "drop"
  )

print(found_stats_34)

# T-test
t_test_result_34 <- t.test(ì»¨ì„¤íŒ…ë„ì›€ì •ë„ì ìˆ˜ ~ ì„¤ë¦½, data = dat_score_found_34, var.equal = FALSE)
print(t_test_result_34)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# ë°•ìŠ¤í”Œë¡¯
if(t_test_result_34$p.value < 0.05) {
  establishment_groups_34 <- data.frame(
    ì„¤ë¦½ = c("ê³µë¦½", "ì‚¬ë¦½"),
    group = c("a", "b")
  )
} else {
  establishment_groups_34 <- data.frame(
    ì„¤ë¦½ = c("ê³µë¦½", "ì‚¬ë¦½"),
    group = c("a", "a")
  )
}

found_stats_with_groups_34 <- found_stats_34 %>%
  left_join(establishment_groups_34, by = "ì„¤ë¦½")

ggplot(dat_score_found_34, aes(x = ì„¤ë¦½, y = ì»¨ì„¤íŒ…ë„ì›€ì •ë„ì ìˆ˜, fill = ì„¤ë¦½)) +
  geom_boxplot(alpha = 0.7, width = 0.6, outlier.shape = 21) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 10, fill = "yellow", stroke = 1) +
  geom_text(data = found_stats_with_groups_34, 
            aes(x = ì„¤ë¦½, y = 8, label = paste0(group, "\n(M=", í‰ê· , ")")),
            inherit.aes = FALSE, fontface = "bold", size = 8, vjust = 0, lineheight=0.5) +
  labs(
    title = "ì„¤ë¦½ë³„ ì»¨ì„¤íŒ… ìœ ìš©ì„± ì¸ì‹",
    x = "ì„¤ë¦½", 
    y = "ì»¨ì„¤íŒ… ìœ ìš©ì„±"
  ) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
    axis.text.x = element_text(size = 20),
    axis.text.y = element_text(size = 20),
    axis.title.x = element_text(size = 20, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),
    legend.position = "none"
  ) +
  scale_y_continuous(expand = expansion(mult = c(0.05, 0.15)))
```

### ë¬¸í•­35. \[33ë²ˆ ë¬¸í•­ì— â‘£ ë˜ëŠ” â‘¤í•­ìœ¼ë¡œ ë‹µë³€í•œ ê²½ìš°ë§Œ ì‘ë‹µ\] êµìœ¡ì§€ì›ì²­ì˜ ì»¨ì„¤íŒ…ì´ ë„ì›€ì´ ë˜ì§€ ì•Šì€ ì´ìœ ëŠ” ë¬´ì—‡ì…ë‹ˆê¹Œ? (ì£¼ê´€ì‹)

í•´ë‹¹ì—†ìŒ

### ë¬¸í•­36. ê·€ ê¸°ê´€ì—ì„œëŠ” í•™ìƒë§ì¶¤í†µí•©ì§€ì›ì„ ìœ„í•œ ì»¨ì„¤íŒ…ì´ í•„ìš”í•˜ë‹¤ê³  ìƒê°í•˜ì‹­ë‹ˆê¹Œ?

â‘  ê·¸ë ‡ë‹¤ â‘¡ ì•„ë‹ˆë‹¤

êµìœ¡ì§€ì›ì²­ì˜ ì»¨ì„¤íŒ… í•„ìš”ì„±ì— ëŒ€í•œ ì„¤ë¬¸ ì´ ì‘ë‹µìëŠ” 3,178ëª…ì´ê³  ì´ˆë“±í•™êµ ì‘ë‹µìëŠ” 1,282ëª…(40.3%) ì¤‘í•™êµ ì‘ë‹µìëŠ” 1,109ëª…(34.9%)ì´ê³  ê³ ë“±í•™êµ ì‘ë‹µìëŠ” 718ëª…(22.6%)ì´ê³ , ê°ì¢…í•™êµ ì‘ë‹µìëŠ” 46ëª…(1.4%), íŠ¹ìˆ˜í•™êµ ì‘ë‹µìëŠ” 23ëª…(0.7%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¨

ì´ˆë“±í•™êµì˜ ê²½ìš° êµìœ¡ì§€ì›ì²­ì˜ ì»¨ì„¤íŒ…ì´ í•„ìš”í•˜ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 531ëª…(41.1%), í•„ìš”í•˜ì§€ ì•Šë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µì§€ëŠ” 751ëª…(58.6%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ì¤‘í•™êµì˜ ê²½ìš° êµìœ¡ì§€ì›ì²­ì˜ ì»¨ì„¤íŒ…ì´ í•„ìš”í•˜ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 483ëª…(43.6%), í•„ìš”í•˜ì§€ ì•Šë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 626ëª…(56.4%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê³ ë“±í•™êµì˜ ê²½ìš° êµìœ¡ì§€ì›ì²­ì˜ ì»¨ì„¤íŒ…ì´ í•„ìš”í•˜ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 354ëª…(49.3%), í•„ìš”í•˜ì§€ ì•Šë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 364ëª…(50.7%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

íŠ¹ìˆ˜í•™êµì˜ ê²½ìš° êµìœ¡ì§€ì›ì²­ì˜ ì»¨ì„¤íŒ…ì´ í•„ìš”í•˜ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 22ëª…(47.8%), í•„ìš”í•˜ì§€ ì•Šë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 24ëª…(52.2%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê°ì¢…í•™êµì˜ ê²½ìš° êµìœ¡ì§€ì›ì²­ì˜ ì»¨ì„¤íŒ…ì´ í•„ìš”í•˜ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 10ëª…(43.5%), í•„ìš”í•˜ì§€ ì•Šë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µìëŠ” 13ëª…(56.5%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
dat_q36 <- dat %>%
  filter(!is.na(ques_36)) %>%
  mutate(
    ë¬¸í•­36 = recode(as.character(ques_36),
                   "1" = "ê·¸ë ‡ë‹¤",
                   "2" = "ì•„ë‹ˆë‹¤",
                   .default = "ê¸°íƒ€"),
    ë¬¸í•­36 = factor(ë¬¸í•­36, levels = c("ê·¸ë ‡ë‹¤", "ì•„ë‹ˆë‹¤")),
    í•™êµê¸‰ = factor(í•™êµê¸‰, levels = c("ì´ˆë“±í•™êµ", "ì¤‘í•™êµ", "ê³ ë“±í•™êµ", "íŠ¹ìˆ˜í•™êµ", "ê°ì¢…í•™êµ"))
  )

# ê¸°ìˆ í†µê³„
summary_q36 <- dat_q36 %>%
  group_by(í•™êµê¸‰, ë¬¸í•­36) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

summary_q36_total <- summary_q36 %>%
  group_by(í•™êµê¸‰) %>%
  summarise(n = sum(n), pct = 100, ë¬¸í•­36 = "í•©ê³„", .groups = "drop") %>%
  bind_rows(summary_q36) %>%
  arrange(factor(í•™êµê¸‰, 
                 levels=c("ì´ˆë“±í•™êµ","ì¤‘í•™êµ","ê³ ë“±í•™êµ","íŠ¹ìˆ˜í•™êµ","ê°ì¢…í•™êµ")),
          if_else(ë¬¸í•­36 == "í•©ê³„", 2, 1))

print(summary_q36_total, n = Inf)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# ì‹œê°í™”
ggplot(summary_q36, aes(x = ë¬¸í•­36, y = n, fill = ë¬¸í•­36)) +
  geom_bar(stat="identity", width=0.7) +
  geom_text(aes(label = paste0(n,"ëª…\n(",pct,"%)"),
                y = n),
            hjust=0.5, vjust=-0.2, size= 6, fontface="bold", lineheight=0.5) +
  facet_wrap(~í•™êµê¸‰, ncol = 2, nrow = 3) +
  labs(
    title = "ì»¨ì„¤íŒ… í•„ìš”ì„± ì¸ì‹",
    x = "ì»¨ì„¤íŒ… í•„ìš”ì„±",
    y = "ì‘ë‹µìˆ˜"
  ) +
  scale_x_discrete(labels = c("ê·¸ë ‡ë‹¤", "ì•„ë‹ˆë‹¤")) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face="bold", size=32, hjust=0.5, margin = margin(b = 18), lineheight = 0.9),
    legend.position = "none",
    axis.text.x = element_text(angle=0, hjust=0.5, size=18, lineheight=0.6),
    axis.text.y = element_text(size=18),
    axis.title.x = element_text(size=20, margin = margin(t = 18)),
    axis.title.y = element_text(angle = 0, vjust = 0.5, size=20),
    strip.text = element_text(face="bold", size=15, margin = margin(t = 6, b = 6)),
    panel.spacing = unit(1.5, "lines"),
    plot.margin = margin(20, 20, 20, 20)
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.25))) +
  coord_cartesian(clip = "off")
```

### ë¬¸í•­37. \[36ë²ˆ ë¬¸í•­ì— â‘ í•­ìœ¼ë¡œ ë‹µë³€í•œ ê²½ìš°ë§Œ ì‘ë‹µ\] í•™ìƒë§ì¶¤í†µí•©ì§€ì›ìœ¼ë¡œ ì»¨ì„¤íŒ…ì´ í•„ìš”í•˜ë‹¤ë©´ ì–´ëŠ ë¶„ì•¼ì˜ ì»¨ì„¤íŒ…ì„ ì‹ ì²­í•  í•„ìš”ê°€ ìˆë‹¤ê³  ìƒê°í•˜ì‹œë‚˜ìš”? (ì¤‘ë³µì‘ë‹µ)

â‘  í†µí•©ì§€ì›íŒ€ êµ¬ì„±ã†ìš´ì˜ â‘¡ í•™ìƒ ì‚¬ë¡€ì§€ì› ë°©ì•ˆ â‘¢ ì§€ì—­ìì› ì—°ê³„ ë°©ì•ˆ â‘£ ê¸°íƒ€

êµìœ¡ì§€ì›ì²­ìœ¼ë¡œë¶€í„° í•™ìƒë§ì¶¤í†µí•©ì§€ì›ì„ ìœ„í•´ ì»¨ì„¤íŒ…ì´ í•„ìš”í•œ ì˜ì—­ì— ëŒ€í•œ ì„¤ë¬¸ ì´ ì‘ë‹µê±´ìˆ˜ëŠ” 869ê±´ì´ê³  ì´ˆë“±í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 333ê±´(38.3%) ì¤‘í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 282ê±´(32.5%)ì´ê³  ê³ ë“±í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 229ê±´(26.4%)ì´ê³ , íŠ¹ìˆ˜í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 20ê±´(2.3%), ê°ì¢…í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 5ê±´(0.6%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¨

ì´ˆë“±í•™êµì˜ ê²½ìš° êµìœ¡ì§€ì›ì²­ë¡œë¶€í„° í•™ìƒ ì‚¬ë¡€ì§€ì› ë°©ì•ˆì— ëŒ€í•œ ì»¨ì„¤íŒ…ì´ í•„ìš”í•˜ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 149ê±´(44.7%), ì§€ì—­ìì› ì—°ê³„ ë°©ì•ˆì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 97ê±´(29.1%), í†µí•©ì§€ì›íŒ€ êµ¬ì„±ã†ìš´ì˜ ë°©ì•ˆì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 82ê±´(24.6%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ì¤‘í•™êµì˜ ê²½ìš° êµìœ¡ì§€ì›ì²­ë¡œë¶€í„° í•™ìƒ ì‚¬ë¡€ì§€ì› ë°©ì•ˆì— ëŒ€í•œ ì»¨ì„¤íŒ…ì´ í•„ìš”í•˜ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 122ê±´(43.3%), ì§€ì—­ìì› ì—°ê³„ ë°©ì•ˆì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 81ê±´(28.7%), í†µí•©ì§€ì›íŒ€ êµ¬ì„±ã†ìš´ì˜ ë°©ì•ˆì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 77ê±´(27.3%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê³ ë“±í•™êµì˜ ê²½ìš° êµìœ¡ì§€ì›ì²­ë¡œë¶€í„° í•™ìƒ ì‚¬ë¡€ì§€ì› ë°©ì•ˆì— ëŒ€í•œ ì»¨ì„¤íŒ…ì´ í•„ìš”í•˜ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 95ê±´(41.5%), í†µí•©ì§€ì›íŒ€ êµ¬ì„±ã†ìš´ì˜ ë°©ì•ˆì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 74ê±´(32.3%), í†µí•©ì§€ì›íŒ€ êµ¬ì„±ã†ìš´ì˜ ë°©ì•ˆì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 59ê±´(25.8%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

íŠ¹ìˆ˜í•™êµì˜ ê²½ìš° êµìœ¡ì§€ì›ì²­ë¡œë¶€í„° í•™ìƒ ì‚¬ë¡€ì§€ì› ë°©ì•ˆì— ëŒ€í•œ ì»¨ì„¤íŒ…ì´ í•„ìš”í•˜ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 8ê±´(40%), ì§€ì—­ìì› ì—°ê³„ ë°©ì•ˆì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 7ê±´(35%), í†µí•©ì§€ì›íŒ€ êµ¬ì„±ã†ìš´ì˜ ë°©ì•ˆì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 4ê±´(20%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê°ì¢…í•™êµì˜ ê²½ìš° êµìœ¡ì§€ì›ì²­ë¡œë¶€í„° í†µí•©ì§€ì›íŒ€ êµ¬ì„±ã†ìš´ì˜ ë°©ì•ˆìœ¼ë¡œ ì»¨ì„¤íŒ…ì´ í•„ìš”í•˜ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 3ê±´(60%), ì§€ì—­ìì› ì—°ê³„ ë°©ì•ˆì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 1ê±´(20%), í•™ìƒ ì‚¬ë¡€ì§€ì› ë°©ì•ˆì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 1ê±´(20%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
dat_q37_long <- dat_trimed %>%
  filter(!is.na(ques_36), !is.na(ques_37)) %>%
  filter(as.character(ques_36) == "1") %>%  # ë¬¸í•­36ì—ì„œ "ê·¸ë ‡ë‹¤"ì¸ ê²½ìš°ë§Œ
  separate_rows(ques_37, sep = ",\\s*") %>%
  mutate(
    ques_37 = str_trim(as.character(ques_37)),
    ë¬¸í•­37 = recode(ques_37,
                   "1" = "í†µí•©ì§€ì›íŒ€ êµ¬ì„±Â·ìš´ì˜",
                   "2" = "í•™ìƒ ì‚¬ë¡€ì§€ì› ë°©ì•ˆ",
                   "3" = "ì§€ì—­ìì› ì—°ê³„ ë°©ì•ˆ",
                   "4" = "ê¸°íƒ€",
                   .default = "ê¸°íƒ€")
  )

# ê¸°ìˆ í†µê³„
summary_q37 <- dat_q37_long %>%
  group_by(í•™êµê¸‰, ë¬¸í•­37) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

summary_q37_total <- summary_q37 %>%
  group_by(í•™êµê¸‰) %>%
  summarise(n = sum(n), pct = 100, ë¬¸í•­37 = "í•©ê³„", .groups = "drop") %>%
  bind_rows(summary_q37) %>%
  arrange(í•™êµê¸‰,
          if_else(ë¬¸í•­37 == "í•©ê³„", 2, 1),
          desc(n))

print(summary_q37_total, n = Inf)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# ì‹œê°í™”
ggplot(
  summary_q37 %>%
    mutate(ë¬¸í•­37 = reorder(ë¬¸í•­37, -n)),
  aes(x = ë¬¸í•­37, y = n, fill = ë¬¸í•­37)
) +
  geom_bar(stat = "identity", width = 0.7) +
  geom_text(aes(label = paste0(n,"ê±´\n(",pct,"%)"), 
                y = n + max(n) * 0.05),
            vjust = -0.2, hjust = 0.5, size = 6, lineheight = 0.4) +
  facet_wrap(~í•™êµê¸‰, ncol = 1, scales = "free_y") +
  labs(
    title = "ì»¨ì„¤íŒ…ì´ í•„ìš”í•œ ë¶„ì•¼",
    x = "ì»¨ì„¤íŒ… ë¶„ì•¼",
    y = "ì‘ë‹µìˆ˜"
  ) +
  scale_x_discrete(labels = c("í†µí•©ì§€ì›íŒ€\nêµ¬ì„±Â·ìš´ì˜", "í•™ìƒ ì‚¬ë¡€ì§€ì›\në°©ì•ˆ", "ì§€ì—­ìì›\nì—°ê³„ ë°©ì•ˆ", "ê¸°íƒ€")) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
    legend.position = "none",
    axis.text.x = element_text(angle = 0, vjust = 0.8, lineheight = 0.5, size = 20),
    axis.text.y = element_text(size = 20),
    strip.text = element_text(face = "bold", size = 20),
    axis.title.x = element_text(size = 20, margin = margin(t = 18)),
    axis.title.y = element_text(angle = 0, vjust = 0.5, size = 20)
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.15))) +
  coord_cartesian(clip = "off")
```

### ë¬¸í•­38. \[36ë²ˆ ë¬¸í•­ì— â‘¡í•­ìœ¼ë¡œ ë‹µë³€í•œ ê²½ìš°ë§Œ ì‘ë‹µ\] í•™ìƒë§ì¶¤í†µí•©ì§€ì› ê´€ë ¨í•˜ì—¬ ì»¨ì„¤íŒ…ì´ í•„ìš”í•˜ì§€ ì•Šë‹¤ê³  ìƒê°í•˜ì‹œëŠ” ì´ìœ ëŠ” ë¬´ì—‡ì…ë‹ˆê¹Œ?

â‘  í•™êµì˜ í•™ìƒë§ì¶¤í†µí•©ì§€ì›ì´ ì›í™œíˆ ìš´ì˜ë˜ê³  ìˆìŒ â‘¡ êµìœ¡(ì§€ì›)ì²­ì˜ ì»¨ì„¤íŒ…ì´ ë„ì›€ì´ ë˜ì§€ ì•Šì„ ê²ƒ ê°™ìŒ â‘¢ í•™ìƒë§ì¶¤í†µí•©ì§€ì›ì´ ì£¼ìš” ì‚¬ì—…ì´ ì•„ë‹ˆë¼ê³  ìƒê°ë¨ â‘£ í•™êµì˜ ë‹¤ë¥¸ ì—…ë¬´ë“¤ë¡œ ë„ˆë¬´ ë°”ë¹ ì„œ ì»¨ì„¤íŒ…ì„ ë°›ì„ ì‹œê°„ì´ ì—†ìŒ â‘¤ ê¸°íƒ€

ì´ˆë“±í•™êµì˜ ê²½ìš° í•™êµì˜ í•™ìƒë§ì¶¤í†µí•©ì§€ì›ì´ ì›í™œíˆ ìš´ì˜ë˜ê³  ìˆë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 166ê±´(56.7%), ë‹¤ë¥¸ ì—…ë¬´ë¡œ ë„ˆë¬´ ë°”ë¹ ì„œ ì‹œê°„ì´ ì—†ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 46ê±´(15.7%), êµìœ¡(ì§€ì›)ì²­ì˜ ì»¨ì„¤íŒ…ì´ ë„ì›€ì´ ë˜ì§€ ì•Šì€ ê²ƒ ê°™ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 29ê±´(9.9%), ì£¼ìš” ì‚¬ì—…ì´ ì•„ë‹ˆë¼ê³  ìƒê°í•œë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 18ê±´(6.1%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ì¤‘í•™êµì˜ ê²½ìš° í•™êµì˜ í•™ìƒë§ì¶¤í†µí•©ì§€ì›ì´ ì›í™œíˆ ìš´ì˜ë˜ê³  ìˆë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 97ê±´(45.5%), ë‹¤ë¥¸ ì—…ë¬´ë¡œ ë„ˆë¬´ ë°”ë¹ ì„œ ì‹œê°„ì´ ì—†ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 36ê±´(21.1%), êµìœ¡(ì§€ì›)ì²­ì˜ ì»¨ì„¤íŒ…ì´ ë„ì›€ì´ ë˜ì§€ ì•Šì€ ê²ƒ ê°™ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 11ê±´(6.4%), ì£¼ìš” ì‚¬ì—…ì´ ì•„ë‹ˆë¼ê³  ìƒê°í•œë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 6ê±´(3.5%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê³ ë“±í•™êµì˜ ê²½ìš° í•™êµì˜ í•™ìƒë§ì¶¤í†µí•©ì§€ì›ì´ ì›í™œíˆ ìš´ì˜ë˜ê³  ìˆë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 56ê±´(45.5%), ë‹¤ë¥¸ ì—…ë¬´ë¡œ ë„ˆë¬´ ë°”ë¹ ì„œ ì‹œê°„ì´ ì—†ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 31ê±´(25.2%), êµìœ¡(ì§€ì›)ì²­ì˜ ì»¨ì„¤íŒ…ì´ ë„ì›€ì´ ë˜ì§€ ì•Šì€ ê²ƒ ê°™ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 11ê±´(8.9%), ì£¼ìš” ì‚¬ì—…ì´ ì•„ë‹ˆë¼ê³  ìƒê°í•œë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 9ê±´(7.3%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

íŠ¹ìˆ˜í•™êµì˜ ê²½ìš° í•™êµì˜ í•™ìƒë§ì¶¤í†µí•©ì§€ì›ì´ ì›í™œíˆ ìš´ì˜ë˜ê³  ìˆë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 2ê±´(28.6%), êµìœ¡(ì§€ì›)ì²­ì˜ ì»¨ì„¤íŒ…ì´ ë„ì›€ì´ ë˜ì§€ ì•Šì€ ê²ƒ ê°™ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 1ê±´(14.3%), ì£¼ìš” ì‚¬ì—…ì´ ì•„ë‹ˆë¼ê³  ìƒê°í•œë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 1ê±´(14.3%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê°ì¢…í•™êµì˜ ê²½ìš° ë‹¤ë¥¸ ì—…ë¬´ë¡œ ë„ˆë¬´ ë°”ë¹ ì„œ ì‹œê°„ì´ ì—†ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 1ê±´(20%), ì£¼ìš” ì‚¬ì—…ì´ ì•„ë‹ˆë¼ê³  ìƒê°í•œë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 3ê±´(60%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
dat_q38 <- dat_trimed %>%
  filter(!is.na(ques_36), !is.na(ques_38)) %>%
  filter(as.character(ques_36) == "2") %>%  # ë¬¸í•­36ì—ì„œ "ì•„ë‹ˆë‹¤"ì¸ ê²½ìš°ë§Œ
  mutate(
    ë¬¸í•­38 = recode(as.character(ques_38),
                   "1" = "í•™êµì˜ í•™ìƒë§ì¶¤í†µí•©ì§€ì›ì´ ì›í™œíˆ ìš´ì˜",
                   "2" = "êµìœ¡ì²­ ì»¨ì„¤íŒ…ì´ ë„ì›€ë˜ì§€ ì•Šì„ ê²ƒ ê°™ìŒ",
                   "3" = "ì£¼ìš” ì‚¬ì—…ì´ ì•„ë‹ˆë¼ê³  ìƒê°ë¨",
                   "4" = "ë‹¤ë¥¸ ì—…ë¬´ë¡œ ë„ˆë¬´ ë°”ë¹ ì„œ ì‹œê°„ì´ ì—†ìŒ",
                   "5" = "ê¸°íƒ€",
                   .default = "ê¸°íƒ€")
  )

# ê¸°ìˆ í†µê³„
summary_q38 <- dat_q38 %>%
  group_by(í•™êµê¸‰, ë¬¸í•­38) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

summary_q38_total <- summary_q38 %>%
  group_by(í•™êµê¸‰) %>%
  summarise(n = sum(n), pct = 100, ë¬¸í•­38 = "í•©ê³„", .groups = "drop") %>%
  bind_rows(summary_q38) %>%
  arrange(í•™êµê¸‰,
          if_else(ë¬¸í•­38 == "í•©ê³„", 2, 1),
          desc(n))

print(summary_q38_total, n = Inf)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# ì‹œê°í™”
ggplot(
  summary_q38 %>%
    mutate(ë¬¸í•­38 = reorder(ë¬¸í•­38, -n)),
  aes(x = ë¬¸í•­38, y = n, fill = ë¬¸í•­38)
) +
  geom_bar(stat = "identity", width = 0.7) +
  geom_text(aes(label = paste0(n,"ê±´(",pct,"%)"), 
                y = n + max(n) * 0.05),
            vjust = 0.005, hjust = 0.5, size = 5, lineheight = 0.5) +
  facet_wrap(~í•™êµê¸‰, ncol = 1, scales = "free_y") +
  labs(
    title = "ì»¨ì„¤íŒ…ì´ ë¶ˆí•„ìš”í•œ ì´ìœ ",
    x = "ë¶ˆí•„ìš”í•œ ì´ìœ ",
    y = "ì‘ë‹µìˆ˜"
  ) +
  scale_x_discrete(labels = function(x) str_wrap(x, width = 12)) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
    legend.position = "none",
    axis.text.x = element_text(angle = 0, vjust = 0.8, lineheight = 0.4, size = 15),
    axis.text.y = element_text(size = 15),
    strip.text = element_text(face = "bold", size = 20),
    axis.title.x = element_text(size = 20, margin = margin(t = 18)),
    axis.title.y = element_text(angle = 0, vjust = 0.5, size = 20)
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.15))) +
  coord_cartesian(clip = "off")
```

### ë¬¸í•­39. \[32ë²ˆ ë¬¸í•­ì— â‘¢í•­ìœ¼ë¡œ ë‹µë³€í•œ ê²½ìš°ë§Œ ì‘ë‹µ\] êµìœ¡ì§€ì›ì²­ìœ¼ë¡œë¶€í„° í•™ìƒì„±ì¥ (ì‚¬ë¡€) ì§€ì›ì„ ë°›ì•˜ë‹¤ë©´ ì–´ëŠ ì˜ì—­ ì‚¬ë¡€ì— ëŒ€í•œ ì§€ì›ì„ ë°›ì•˜ë‚˜ìš”? (ì¤‘ë³µì‘ë‹µ)

â‘  ê²½ì œì  ì§€ì› â‘¡ ì‹¬ë¦¬ì •ì„œ ì§€ì› â‘¢ í•™ì—… ë° ì§„ë¡œì§€ì› â‘£ ì•ˆì „ì§€ì›(í•™êµí­ë ¥, ì•„ë™í•™ëŒ€, ì„±í¬ë¡±ã†ì„±í­ë ¥, ê²Œì„ì¤‘ë…, ì•½ë¬¼ì¤‘ë… ë“±) â‘¤ ê±´ê°•ì§€ì›(ìœ„ìƒê´€ë¦¬, ì˜ì–‘ê´€ë¦¬, ìš´ë™ê´€ë¦¬, ìŠ¤íŠ¸ë ˆìŠ¤ ê´€ë¦¬, ìˆ˜ë©´ê´€ë¦¬, ìŠ¤ë§ˆíŠ¸í° ì‚¬ìš© ì‹œê°„ ê´€ë¦¬ ë“±)

êµìœ¡ì§€ì›ì²­ìœ¼ë¡œë¶€í„° í•™ìƒì„±ì¥(ì‚¬ë¡€) ì§€ì›ì„ ë°›ì€ ì˜ì—­ì— ëŒ€í•œ ë¬¸í•­ì˜ ì´ ì‘ë‹µê±´ìˆ˜ëŠ” 171ê±´ì´ë©° ì´ˆë“±í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 79ê±´(46.2%), ì¤‘í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 73ê±´(42.7%), ê³ ë“±í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 18ê±´(10.5%), íŠ¹ìˆ˜í•™êµ ì‘ë‹µê±´ìˆ˜ëŠ” 1ê±´(0.6%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ì´ˆë“±í•™êµì˜ ê²½ìš° ì‹¬ë¦¬ì •ì„œ ì§€ì›ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 51ê±´(64.6%), í•™ì—… ë° ì§„ë¡œì§€ì›ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 17ê±´(21.5%), ê²½ì œì  ì§€ì›ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 8ê±´(10.1%), ì•ˆì „ì§€ì›ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 2ê±´(2.5%), ê±´ê°•ì§€ì›ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 1ê±´(1.3%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ì¤‘í•™êµì˜ ê²½ìš° ì‹¬ë¦¬ì •ì„œ ì§€ì›ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 31ê±´(42.5%), ê²½ì œì  ì§€ì›ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 18ê±´(24.7%), í•™ì—… ë° ì§„ë¡œì§€ì›ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 10ê±´(13.7%), ì•ˆì „ì§€ì›ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 8ê±´(11%), ê±´ê°•ì§€ì›ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 6ê±´(8.2%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê³ ë“±í•™êµì˜ ê²½ìš° ì‹¬ë¦¬ì •ì„œ ì§€ì›ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 12ê±´(66.7%), ê²½ì œì  ì§€ì›ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 3ê±´(16.7%), í•™ì—… ë° ì§„ë¡œì§€ì›ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 2ê±´(11.1%), ì•ˆì „ì§€ì›ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ëŠ” 1ê±´(5.6%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

íŠ¹ìˆ˜í•™êµì˜ ê²½ìš° ì‹¬ë¦¬ì •ì„œ ì§€ì›ì´ë¼ê³  ë‹µë³€í•œ ì‘ë‹µê±´ìˆ˜ê°€ 1ê±´(100%)ì´ì—ˆìŒ

```{r}
#| echo: false
#| warning: false
#| message: false
dat_q39_long <- dat_trimed %>%
  filter(!is.na(ques_32), !is.na(ques_39)) %>%
  filter(as.character(ques_32) == "3") %>%  # ë¬¸í•­32ì—ì„œ "3"ì¸ ê²½ìš°ë§Œ
  separate_rows(ques_39, sep = ",\\s*") %>%
  mutate(
    ques_39 = str_trim(as.character(ques_39)),
    ë¬¸í•­39 = recode(ques_39,
                   "1" = "ê²½ì œì  ì§€ì›",
                   "2" = "ì‹¬ë¦¬ì •ì„œ ì§€ì›",
                   "3" = "í•™ì—… ë° ì§„ë¡œì§€ì›",
                   "4" = "ì•ˆì „ì§€ì›",
                   "5" = "ê±´ê°•ì§€ì›",
                   .default = "ê¸°íƒ€")
  )

# ê¸°ìˆ í†µê³„
summary_q39 <- dat_q39_long %>%
  group_by(í•™êµê¸‰, ë¬¸í•­39) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

summary_q39_total <- summary_q39 %>%
  group_by(í•™êµê¸‰) %>%
  summarise(n = sum(n), pct = 100, ë¬¸í•­39 = "í•©ê³„", .groups = "drop") %>%
  bind_rows(summary_q39) %>%
  arrange(í•™êµê¸‰,
          if_else(ë¬¸í•­39 == "í•©ê³„", 2, 1),
          desc(n))

print(summary_q39_total, n = Inf)
```

```{r}
#| echo: false
#| warning: false
#| message: false
# ì‹œê°í™”
ggplot(
  summary_q39 %>%
    mutate(ë¬¸í•­39 = reorder(ë¬¸í•­39, -n)),
  aes(x = ë¬¸í•­39, y = n, fill = ë¬¸í•­39)
) +
  geom_bar(stat = "identity", width = 0.7) +
  geom_text(aes(label = paste0(n,"ê±´(",pct,"%)"), 
                y = n + max(n) * 0.05),
            vjust = 0.1, hjust = 0.5, size = 5, lineheight = 0.4) +
  facet_wrap(~í•™êµê¸‰, ncol = 1, scales = "free_y") +
  labs(
    title = "í•™ìƒì„±ì¥(ì‚¬ë¡€) ì§€ì›ì„ ë°›ì€ ì˜ì—­",
    x = "ì§€ì›ì˜ì—­",
    y = "ì‘ë‹µìˆ˜"
  ) +
  scale_x_discrete(labels = c("ê²½ì œì  ì§€ì›", "ì‹¬ë¦¬ì •ì„œ ì§€ì›", "í•™ì—… ë°\nì§„ë¡œì§€ì›", "ì•ˆì „ì§€ì›", "ê±´ê°•ì§€ì›")) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
    legend.position = "none",
    axis.text.x = element_text(angle = 0, vjust = 0.8, lineheight = 0.7, size = 18),
    axis.text.y = element_text(size = 18),
    strip.text = element_text(face = "bold", size = 20),
    axis.title.x = element_text(size = 20, margin = margin(t = 18)),
    axis.title.y = element_text(angle = 0, vjust = 0.5, size = 20)
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.15))) +
  coord_cartesian(clip = "off")
```

### ë¬¸í•­40. \[39ë²ˆ ë¬¸í•­ì— ë‹µë³€í•œ ê²½ìš°ë§Œ ì‘ë‹µ\] êµìœ¡ì§€ì›ì²­ìœ¼ë¡œë¶€í„° ë°›ì€ í•™ìƒì„±ì¥(ì‚¬ë¡€) ì§€ì›ì´ í•™êµì— ë„ì›€ì´ ë˜ì—ˆìŠµë‹ˆê¹Œ?

â‘  ë§¤ìš° ê·¸ë ‡ë‹¤ â‘¡ ê·¸ë ‡ë‹¤ â‘¢ ë³´í†µì´ë‹¤ â‘£ ê·¸ë ‡ì§€ ì•Šë‹¤ â‘¤ ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤

êµìœ¡ì§€ì›ì²­ìœ¼ë¡œë¶€í„° ë°›ì€ í•™ìƒì„±ì¥(ì‚¬ë¡€) ì§€ì›ì´ ë˜ì—ˆëŠ”ì§€ì— ëŒ€í•œ ë¬¸í•­ì— ì´ ì‘ë‹µìëŠ” 331ê±´ì´ë©° ë§¤ìš° ê·¸ë ‡ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µì€ 134ëª…(40.5%), ê·¸ë ‡ë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µì€ 166ëª…(50.2%), ë³´í†µì´ë‹¤ë¼ê³  ë‹µë³€í•œ ì‘ë‹µì€ 26ëª…(7.9%), ê·¸ë ‡ì§€ ì•Šë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µì€ 4ëª…(1.2%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ê³  ë‹µë³€í•œ ì‘ë‹µì€ 1ëª…(0.3%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

```{r}
#| echo: false
#| message: false
#| warning: false
ques40_freq <- dat %>%
  filter(!is.na(ques_32),
         !is.na(ques_39), 
         !is.na(ques_40),
         str_detect(as.character(ques_32), "3"),  # 32ë²ˆì—ì„œ 3ë²ˆ(ì‚¬ë¡€ì§€ì›) ì„ íƒ
         ques_40 %in% as.character(1:5)) %>%
  count(ques_40) %>%
  mutate(
    ì‘ë‹µ = recode(ques_40,
                 "1" = "ë§¤ìš° ê·¸ë ‡ë‹¤",
                 "2" = "ê·¸ë ‡ë‹¤", 
                 "3" = "ë³´í†µì´ë‹¤",
                 "4" = "ê·¸ë ‡ì§€ ì•Šë‹¤",
                 "5" = "ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤"),
    pct = round(n / sum(n) * 100, 1)
  ) %>%
  arrange(desc(n)) %>%
  bind_rows(summarise(., ì‘ë‹µ = "í•©ê³„", n = sum(n), pct = sum(pct)))

print(ques40_freq %>% select(ì‘ë‹µ, n, pct), n = Inf)
```

```{r}
#| echo: false
#| message: false
#| warning: false
ggplot(ques40_freq %>% filter(ì‘ë‹µ != "í•©ê³„"), aes(x = reorder(ì‘ë‹µ, -n), y = n, fill = ì‘ë‹µ)) +
  geom_bar(stat = "identity", width = 0.5) +
  geom_text(aes(label = paste0(n, "ëª… (", pct, "%)")), 
            vjust = -0.6, size = 7) +
  labs(
    title = "í•™ìƒì„±ì¥(ì‚¬ë¡€) ì§€ì›ì˜ ìœ ìš©ì„±",
    x = "ë„ì›€ ì •ë„",
    y = "ì‘ë‹µìˆ˜"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(size = 32, face = "bold", hjust = 0.5),
    axis.text.x = element_text(angle = 0, vjust = 0.8, lineheight = 0.4, size = 20),
    axis.text.y = element_text(size = 17),
    strip.text = element_text(face = "bold", size = 20),
    axis.title.x = element_text(size = 20, margin = margin(t = 18)),
    axis.title.y = element_text(angle = 0, vjust = 0.5, size = 20),
    legend.position = "none",
    panel.spacing = unit(1.5, "lines"), plot.margin = margin(20, 20, 20, 20)
  ) +
  ylim(0, max(ques40_freq$n) * 1.15)
```

### ë¬¸í•­ 40-1. ì§ì±…ë³„ í•™ìƒì„±ì¥(ì‚¬ë¡€) ì§€ì› ìœ ìš©ì„± ì¸ì‹ ë¶„ì„

ì§ì±…ë³„ ì‘ë‹µìëŠ” ì´ 32ëª…ê±´ì´ê³  ì´ ì¤‘ì—ì„œ í•™êµì¥ì€ 73ëª…(22.3%), êµê°ì€ 100ëª…(30.6%), êµì‚¬ ë“±ì€ 154ëª…(47.1%)ì´ì—ˆìŒ

í•™êµì¥ ì‘ë‹µ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 33ëª…(45.2%), ê·¸ë ‡ë‹¤ëŠ” 34ëª…(46.6%), ë³´í†µì´ë‹¤ëŠ” 6ëª…(8.2%)ì´ì—ˆìŒ.

êµê° ì‘ë‹µ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 39ëª…(39%), ê·¸ë ‡ë‹¤ëŠ” 53ëª…(53%), ë³´í†µì´ë‹¤ëŠ” 7ëª…(7%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 1ëª…(1%)ì´ì—ˆìŒ

êµì‚¬ ë“± ì‘ë‹µ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 60ëª…(39%), ê·¸ë ‡ë‹¤ëŠ” 78ëª…(50.6%), ë³´í†µì´ë‹¤ëŠ” 12ëª…(7.8%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 3ëª…(1.9%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 1ëª…(0.6%)ì´ì—ˆìŒ

```{r}
#| echo: false
#| message: false
#| warning: false
dat_filtered_40 <- dat %>%
  filter(!is.na(ques_32),
         !is.na(ques_39), 
         !is.na(ques_40),
         str_detect(as.character(ques_32), "3"),  # 32ë²ˆì—ì„œ 3ë²ˆ ì„ íƒ ì¡°ê±´ ì¶”ê°€
         ques_1 %in% c(1,2,3),      # í•™êµê¸‰ í•„í„°
         ques_2 %in% c(1,2),         # ì„¤ë¦½ìœ í˜• í•„í„°  
         !is.na(ques_7),             # ì§ì±… í•„í„°
         ques_40 %in% as.character(1:5)) %>%
  mutate(
    ì§ì±… = case_when(
      ques_7 == 1 ~ "í•™êµì¥",
      ques_7 == 2 ~ "êµê°", 
      TRUE ~ "êµì‚¬ ë“±"
    ),
    ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„ = factor(as.character(ques_40),
                       levels = c("1","2","3","4","5"),
                       labels = c("ë§¤ìš° ê·¸ë ‡ë‹¤","ê·¸ë ‡ë‹¤","ë³´í†µì´ë‹¤","ê·¸ë ‡ì§€ ì•Šë‹¤","ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤"))
  )

# ì§ì±…ë³„ ê¸°ìˆ í†µê³„ (í•©ê³„ í¬í•¨)
summary_job_table_40 <- dat_filtered_40 %>%
  group_by(ì§ì±…, ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

summary_job_with_total_40 <- summary_job_table_40 %>%
  group_by(ì§ì±…) %>%
  summarise(n = sum(n), pct = sum(pct), ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„ = "í•©ê³„") %>%
  bind_rows(summary_job_table_40) %>%
  arrange(
    factor(ì§ì±…, levels = c("í•™êµì¥","êµê°","êµì‚¬ ë“±")),
    ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„ == "í•©ê³„",
    if_else(ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„ != "í•©ê³„", -n, 0)
  )

summary_job_final_40 <- summary_job_with_total_40 %>%
  bind_rows(
    summary_job_with_total_40 %>%
      summarise(ì§ì±… = "ì „ì²´ í•©ê³„", n = sum(n[ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„ == "í•©ê³„"]), pct = 100, ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„ = "í•©ê³„")
  )

print(summary_job_final_40, n = Inf)

# ì¹´ì´ì œê³± ê²€ì •
tab_job_40 <- table(dat_filtered_40$ì§ì±…, dat_filtered_40$ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„)
chisq_test_job_40 <- chisq.test(tab_job_40)
print(chisq_test_job_40)
```

```{r}
#| echo: false
#| message: false
#| warning: false
# ëˆ„ì ë§‰ëŒ€ê·¸ë˜í”„
summary_job_plot_40 <- summary_job_table_40 %>%
  mutate(ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„ = factor(ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„, 
                            levels = c("ë§¤ìš° ê·¸ë ‡ë‹¤", "ê·¸ë ‡ë‹¤", "ë³´í†µì´ë‹¤", 
                                     "ê·¸ë ‡ì§€ ì•Šë‹¤", "ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤")))

ggplot(summary_job_plot_40, aes(x = factor(ì§ì±…, levels = c("í•™êµì¥", "êµê°", "êµì‚¬ ë“±")), 
                                    y = pct, fill = ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„)) +
  geom_bar(stat = "identity", width = 0.7) +
  labs(
    title = "ì§ì±…ë³„ ì‚¬ë¡€ì§€ì› ìœ ìš©ì„± ì¸ì‹",
    x = "ì§ì±…",
    y = "ë¹„ìœ¨",
    fill = "ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„"
  ) +
  scale_y_continuous(limits = c(0, 100), expand = expansion(mult = c(0, 0.02))) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
    axis.text.x = element_text(size = 20, face = "bold"),
    axis.text.y = element_text(size = 18),
    axis.title.x = element_text(size = 25, angle = 0, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),
    legend.position = "right",
    legend.text = element_text(size = 14),
    legend.title = element_text(size = 16, face = "bold")
  )

```

êµìœ¡ì§€ì›ì²­ìœ¼ë¡œë¶€í„° ë°›ì€ í•™ìƒì„±ì¥(ì‚¬ë¡€) ì§€ì› ìœ ìš©ì„±ì— ëŒ€í•œ ì§ì±…ë³„ í‰ê· ì ìˆ˜ë¥¼ ë¹„êµí•œ ê²°ê³¼, í•™êµì¥(4.37), êµê°(4.3), êµì‚¬ ë“±(4.25)ìœ¼ë¡œ ì§ì±…ë³„ë¡œ í‰ê· ì ìˆ˜ì— ìœ ì˜ë¯¸í•œ ì°¨ì´ê°€ ë‚˜íƒ€ë‚˜ì§€ëŠ” ì•Šì•˜ìŒ

```{r}
#| echo: false
#| message: false
#| warning: false
# ANOVA ë¶„ì„
dat_score_job_40 <- dat_filtered_40 %>%
  filter(!is.na(ques_40)) %>%
  mutate(
    ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„ì ìˆ˜ = case_when(
      ques_40 == 1 ~ 5,   # ë§¤ìš° ê·¸ë ‡ë‹¤
      ques_40 == 2 ~ 4,   # ê·¸ë ‡ë‹¤
      ques_40 == 3 ~ 3,   # ë³´í†µì´ë‹¤
      ques_40 == 4 ~ 2,   # ê·¸ë ‡ì§€ ì•Šë‹¤
      ques_40 == 5 ~ 1,   # ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤
      TRUE ~ NA_real_
    ),
    ì§ì±… = factor(ì§ì±…, levels = c("í•™êµì¥", "êµê°", "êµì‚¬ ë“±"))
  )

job_stats_40 <- dat_score_job_40 %>%
  group_by(ì§ì±…) %>%
  summarise(
    í‰ê·  = round(mean(ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„ì ìˆ˜, na.rm = TRUE), 2),
    í‘œì¤€í¸ì°¨ = round(sd(ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„ì ìˆ˜, na.rm = TRUE), 2),
    n = n(),
    .groups = "drop"
  ) %>%
  arrange(ì§ì±…)

print(job_stats_40)

anova_job_40 <- aov(ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„ì ìˆ˜ ~ ì§ì±…, data = dat_score_job_40)
summary(anova_job_40)

tukey_job_40 <- TukeyHSD(anova_job_40)
print(tukey_job_40)
```

```{r}
#| echo: false
#| message: false
#| warning: false
# ë°•ìŠ¤í”Œë¡¯
tukey_letters_job_40 <- multcompView::multcompLetters4(anova_job_40, tukey_job_40)
letters_df_job_40 <- data.frame(
  ì§ì±… = names(tukey_letters_job_40$`ì§ì±…`$Letters),
  group = tukey_letters_job_40$`ì§ì±…`$Letters
)

job_stats_with_groups_40 <- job_stats_40 %>%
  left_join(letters_df_job_40, by = "ì§ì±…")

ggplot(dat_score_job_40, aes(x = factor(ì§ì±…, levels = c("í•™êµì¥", "êµê°", "êµì‚¬ ë“±")), y = ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„ì ìˆ˜, fill = ì§ì±…)) +
  geom_boxplot(alpha = 0.7, width = 0.6, outlier.shape = 21) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 10, fill = "yellow", stroke = 1) +
  geom_text(data = job_stats_with_groups_40, 
            aes(x = ì§ì±…, y = 9, label = paste0(group, "\n(M=", í‰ê· , ")")),
            inherit.aes = FALSE, fontface = "bold", size = 8, vjust = 0) +
  labs(
    title = "ì§ì±…ë³„ ì‚¬ë¡€ì§€ì›\n ìœ ìš©ì„± ì¸ì‹",
    x = "ì§ì±…", 
    y = "ì‚¬ë¡€ì§€ì›ì˜\n ìœ ìš©ì„±"
  ) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
    axis.text.x = element_text(size = 20),
    axis.text.y = element_text(size = 20),
    axis.title.x = element_text(size = 20, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5, lineheight = 0.5),
    legend.position = "none"
  ) +
  scale_y_continuous(expand = expansion(mult = c(0.05, 0.15)))
```

### ë¬¸í•­ 40-2. í•™êµê¸‰ë³„ í•™ìƒì„±ì¥(ì‚¬ë¡€) ì§€ì› ìœ ìš©ì„± ì¸ì‹ ë¶„ì„

í•™êµê¸‰ë³„ ì‘ë‹µìëŠ” 327ëª…ì´ê³  ì´ˆë“±í•™êµ ì‘ë‹µìëŠ” 148ëª…(45.3%), ì¤‘í•™êµ ì‘ë‹µìëŠ” 127ëª…(38.8%), ê³ ë“±í•™êµ ì‘ë‹µìëŠ” 52ëª…(15.9%)ì´ ì‘ë‹µí•˜ì˜€ìŒ.

ì´ˆë“±í•™êµ ì‘ë‹µê±´ìˆ˜ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 61ëª…(41.2%), ê·¸ë ‡ë‹¤ëŠ” 48ëª…(37.8%), ë³´í†µì´ë‹¤ëŠ” 11ëª…(7.4%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 2ëª…(1.4%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¨

ì¤‘í•™êµ ì‘ë‹µê±´ìˆ˜ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 48ëª…(37.8%), ê·¸ë ‡ë‹¤ëŠ” 67ëª…(52.8%), ë³´í†µì´ë‹¤ëŠ” 10ëª…(7.9%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 2ëª…(1.6%)ìœ¼ë¡œ ë‚˜íƒ€ë‚¨

ê³ ë“±í•™êµ ì‘ë‹µê±´ìˆ˜ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 23ëª…(44.2%), ê·¸ë ‡ë‹¤ëŠ” 24ëª…(46.2%), ë³´í†µì´ë‹¤ëŠ” 4ëª…(7.7%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 1ëª…(1.9%)ì´ì—ˆìŒ

```{r}
#| echo: false
#| message: false
#| warning: false
# í•™êµê¸‰ë³„ ê¸°ìˆ í†µê³„ (í•©ê³„ í¬í•¨)
summary_school_table_40 <- dat_filtered_40 %>%
  group_by(í•™êµê¸‰, ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

summary_school_with_total_40 <- summary_school_table_40 %>%
  group_by(í•™êµê¸‰) %>%
  summarise(n = sum(n), pct = sum(pct), ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„ = "í•©ê³„") %>%
  bind_rows(summary_school_table_40) %>%
  arrange(
    factor(í•™êµê¸‰, levels = c("ì´ˆë“±í•™êµ","ì¤‘í•™êµ","ê³ ë“±í•™êµ")),
    ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„ == "í•©ê³„",
    if_else(ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„ != "í•©ê³„", -n, 0)
  )

summary_school_final_40 <- summary_school_with_total_40 %>%
  bind_rows(
    summary_school_with_total_40 %>%
      summarise(í•™êµê¸‰ = "ì „ì²´ í•©ê³„", n = sum(n[ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„ == "í•©ê³„"]), pct = 100, ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„ = "í•©ê³„")
  )

print(summary_school_final_40, n = Inf)

# ì¹´ì´ì œê³± ê²€ì •
tab_school_40 <- table(dat_filtered_40$í•™êµê¸‰, dat_filtered_40$ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„)
chisq_test_school_40 <- chisq.test(tab_school_40)
print(chisq_test_school_40)
```

```{r}
#| echo: false
#| message: false
#| warning: false
# ëˆ„ì ë§‰ëŒ€ê·¸ë˜í”„
summary_school_plot_40 <- summary_school_table_40 %>%
  mutate(ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„ = factor(ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„, 
                            levels = c("ë§¤ìš° ê·¸ë ‡ë‹¤", "ê·¸ë ‡ë‹¤", "ë³´í†µì´ë‹¤", 
                                     "ê·¸ë ‡ì§€ ì•Šë‹¤", "ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤")))

ggplot(summary_school_plot_40, aes(x = factor(í•™êµê¸‰, levels = c("ì´ˆë“±í•™êµ", "ì¤‘í•™êµ", "ê³ ë“±í•™êµ")), y = pct, fill = ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„)) +
  geom_bar(stat = "identity", width = 0.7) +
  labs(
    title = "í•™êµê¸‰ë³„ ì‚¬ë¡€ì§€ì› ìœ ìš©ì„± ì¸ì‹",
    x = "í•™êµê¸‰",
    y = "ë¹„ìœ¨",
    fill = "ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„"
  ) +
  scale_y_continuous(limits = c(0, 100), expand = expansion(mult = c(0, 0.02))) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(size = 32, face = "bold", hjust = 0.5),
    axis.text.x = element_text(size = 18, margin = margin(t = 10)),
    axis.text.y = element_text(size = 18),
    axis.title.x = element_text(size = 20, angle = 0, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),
    legend.position = "right",
    legend.text = element_text(size = 14),
    legend.title = element_text(size = 16, face = "bold")
  )
```

êµìœ¡ì§€ì›ì²­ìœ¼ë¡œë¶€í„° ë°›ì€ í•™ìƒì„±ì¥(ì‚¬ë¡€) ì§€ì› ìœ ìš©ì„±ì— ëŒ€í•œ í•™êµê¸‰ë³„ í‰ê·  ì ìˆ˜ë¥¼ ë¹„êµí•œ ê²°ê³¼, ì´ˆë“±í•™êµ(4.31), ì¤‘í•™êµ(4.27), ê³ ë“±í•™êµ(4.31) í•™êµê¸‰ë³„ë¡œ í‰ê· ì ìˆ˜ì— ìœ ì˜ë¯¸í•œ ì°¨ì´ê°€ ë‚˜íƒ€ë‚˜ì§€ëŠ” ì•Šì•˜ìŒ

```{r}
#| echo: false
#| message: false
#| warning: false
# í•™êµê¸‰ë³„ ANOVA
school_stats_40 <- dat_score_job_40 %>%
  mutate(í•™êµê¸‰ = factor(í•™êµê¸‰, levels = c("ì´ˆë“±í•™êµ", "ì¤‘í•™êµ", "ê³ ë“±í•™êµ"))) %>%
  group_by(í•™êµê¸‰) %>%
  summarise(
    í‰ê·  = round(mean(ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„ì ìˆ˜, na.rm = TRUE), 2),
    í‘œì¤€í¸ì°¨ = round(sd(ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„ì ìˆ˜, na.rm = TRUE), 2),
    n = n(),
    .groups = "drop"
  ) %>%
  arrange(í•™êµê¸‰)

print(school_stats_40)

anova_school_40 <- aov(ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„ì ìˆ˜ ~ í•™êµê¸‰, data = dat_score_job_40)
summary(anova_school_40)

tukey_school_40 <- TukeyHSD(anova_school_40)
print(tukey_school_40)
```

```{r}
#| echo: false
#| message: false
#| warning: false
# ë°•ìŠ¤í”Œë¡¯
tukey_letters_school_40 <- multcompView::multcompLetters4(anova_school_40, tukey_school_40)
letters_df_school_40 <- data.frame(
  í•™êµê¸‰ = names(tukey_letters_school_40$`í•™êµê¸‰`$Letters),
  group = tukey_letters_school_40$`í•™êµê¸‰`$Letters
)

school_stats_with_groups_40 <- school_stats_40 %>%
  left_join(letters_df_school_40, by = "í•™êµê¸‰")

ggplot(dat_score_job_40, aes(x = factor(í•™êµê¸‰, levels = c("ì´ˆë“±í•™êµ", "ì¤‘í•™êµ", "ê³ ë“±í•™êµ")), y = ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„ì ìˆ˜, fill = í•™êµê¸‰)) +
  geom_boxplot(alpha = 0.7, width = 0.6, outlier.shape = 21) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 10, fill = "yellow", stroke = 1) +
  geom_text(data = school_stats_with_groups_40, 
            aes(x = í•™êµê¸‰, y = 10, label = paste0(group, "\n(M=", í‰ê· , ")")),
            inherit.aes = FALSE, fontface = "bold", size = 8, vjust = 0, lineheight=0.5) +
  labs(
    title = "í•™êµê¸‰ë³„ ì‚¬ë¡€ì§€ì›\n ìœ ìš©ì„± ì¸ì‹",
    x = "í•™êµê¸‰", 
    y = "ì‚¬ë¡€ì§€ì›\nìœ ìš©ì„±"
  ) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
    axis.text.x = element_text(size = 20),
    axis.text.y = element_text(size = 20),
    axis.title.x = element_text(size = 20, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5, lineheight = 0.5),
    legend.position = "none"
  ) +
  scale_y_continuous(expand = expansion(mult = c(0.05, 0.15)))
```

### ë¬¸í•­ 40-3. ì„¤ë¦½ë³„ í•™ìƒì„±ì¥(ì‚¬ë¡€) ì§€ì› ìœ ìš©ì„± ì¸ì‹ ë¶„ì„

ì„¤ë¦½ë³„ ì‘ë‹µìëŠ” 327ê±´ì´ê³  ê³µë¦½í•™êµ ì‘ë‹µìëŠ” 262ëª…(80.1%), ì‚¬ë¦½í•™êµ ì‘ë‹µìëŠ” 65ëª…(19.9%)ì´ ì‘ë‹µí•˜ì˜€ìŒ.

ê³µë¦½í•™êµ ì‘ë‹µê±´ìˆ˜ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 103ëª…(39.3%), ê·¸ë ‡ë‹¤ëŠ” 133ëª…(50.8%), ë³´í†µì´ë‹¤ëŠ” 22ëª…(8.4%), ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 4ëª…(1.5%)ì´ì—ˆìŒ

ì‚¬ë¦½í•™êµ ì‘ë‹µê±´ìˆ˜ ì¤‘ì—ì„œ ë§¤ìš° ê·¸ë ‡ë‹¤ëŠ” 29ëª…(44.6%), ê·¸ë ‡ë‹¤ëŠ” 32ëª…(49.2%), ë³´í†µì´ë‹¤ëŠ” 3ëª…(4.6%), ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” 1ëª…(1.5%)ì´ì—ˆìŒ

```{r}
#| echo: false
#| message: false
#| warning: false
## 4. ì„¤ë¦½ë³„ ë¶„ì„

# ì„¤ë¦½ë³„ ë°ì´í„° ì¤€ë¹„
dat_found_40 <- dat_filtered_40 %>%
  filter(ì„¤ë¦½ %in% c("ê³µë¦½", "ì‚¬ë¦½")) %>%
  mutate(ì„¤ë¦½ = factor(ì„¤ë¦½, levels = c("ê³µë¦½", "ì‚¬ë¦½")))

# ì„¤ë¦½ë³„ ê¸°ìˆ í†µê³„ (í•©ê³„ í¬í•¨)
summary_found_table_40 <- dat_found_40 %>%
  group_by(ì„¤ë¦½, ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(pct = round(n / sum(n) * 100, 1)) %>%
  ungroup()

summary_found_with_total_40 <- summary_found_table_40 %>%
  group_by(ì„¤ë¦½) %>%
  summarise(n = sum(n), pct = sum(pct), ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„ = "í•©ê³„") %>%
  bind_rows(summary_found_table_40) %>%
  arrange(ì„¤ë¦½, ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„ == "í•©ê³„", if_else(ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„ != "í•©ê³„", -n, 0))

summary_found_final_40 <- summary_found_with_total_40 %>%
  bind_rows(
    summary_found_with_total_40 %>%
      summarise(ì„¤ë¦½ = "ì „ì²´ í•©ê³„", n = sum(n[ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„ == "í•©ê³„"]), pct = 100, ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„ = "í•©ê³„")
  )

print(summary_found_final_40, n = Inf)

# ì¹´ì´ì œê³± ê²€ì •
tab_found_40 <- table(dat_found_40$ì„¤ë¦½, dat_found_40$ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„)
chisq_test_found_40 <- chisq.test(tab_found_40)
print(chisq_test_found_40)
```

```{r}
#| echo: false
#| message: false
#| warning: false
# ëˆ„ì ë§‰ëŒ€ê·¸ë˜í”„
summary_found_plot_40 <- summary_found_table_40 %>%
  mutate(ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„ = factor(ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„, 
                            levels = c("ë§¤ìš° ê·¸ë ‡ë‹¤", "ê·¸ë ‡ë‹¤", "ë³´í†µì´ë‹¤", 
                                     "ê·¸ë ‡ì§€ ì•Šë‹¤", "ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤")))

ggplot(summary_found_plot_40, aes(x = ì„¤ë¦½, y = pct, fill = ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„)) +
  geom_bar(stat = "identity", width = 0.7) +
  labs(
    title = "ì„¤ë¦½ë³„ ì‚¬ë¡€ì§€ì› ë„ì›€ì •ë„ ì¸ì‹",
    x = "ì„¤ë¦½",
    y = "ë¹„ìœ¨",
    fill = "ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„"
  ) +
  scale_y_continuous(limits = c(0, 100), expand = expansion(mult = c(0, 0.02))) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(size = 32, face = "bold", hjust = 0.5),
    axis.text.x = element_text(size = 18, margin = margin(t = 10)),
    axis.text.y = element_text(size = 18),
    axis.title.x = element_text(size = 20, angle = 0, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),
    legend.position = "right",
    legend.text = element_text(size = 18),
    legend.title = element_text(size = 20, face = "bold")
  )
```

êµìœ¡ì§€ì›ì²­ìœ¼ë¡œë¶€í„° ë°›ì€ í•™ìƒì„±ì¥(ì‚¬ë¡€) ì§€ì› ìœ ìš©ì„±ì— ëŒ€í•œ í•™êµê¸‰ë³„ í‰ê·  ì ìˆ˜ë¥¼ ë¹„êµí•œ ê²°ê³¼, ê³µë¦½í•™êµ(4.28), ì‚¬ë¦½í•™êµ(4.35) ê°„ í‰ê· ì ìˆ˜ì— ìœ ì˜ë¯¸í•œ ì°¨ì´ê°€ ë‚˜íƒ€ë‚˜ì§€ëŠ” ì•Šì•˜ìŒ

```{r}
#| echo: false
#| message: false
#| warning: false
# T-test ë¶„ì„
dat_score_found_40 <- dat_found_40 %>%
  mutate(
    ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„ì ìˆ˜ = case_when(
      ques_40 == 1 ~ 5,   # ë§¤ìš° ê·¸ë ‡ë‹¤
      ques_40 == 2 ~ 4,   # ê·¸ë ‡ë‹¤
      ques_40 == 3 ~ 3,   # ë³´í†µì´ë‹¤
      ques_40 == 4 ~ 2,   # ê·¸ë ‡ì§€ ì•Šë‹¤
      ques_40 == 5 ~ 1,   # ë§¤ìš° ê·¸ë ‡ì§€ ì•Šë‹¤
      TRUE ~ NA_real_
    )
  )

found_stats_40 <- dat_score_found_40 %>%
  group_by(ì„¤ë¦½) %>%
  summarise(
    í‰ê·  = round(mean(ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„ì ìˆ˜, na.rm = TRUE), 2),
    í‘œì¤€í¸ì°¨ = round(sd(ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„ì ìˆ˜, na.rm = TRUE), 2),
    n = n(),
    .groups = "drop"
  )

print(found_stats_40)

# T-test
t_test_result_40 <- t.test(ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„ì ìˆ˜ ~ ì„¤ë¦½, data = dat_score_found_40, var.equal = FALSE)
print(t_test_result_40)
```

```{r}
#| echo: false
#| message: false
#| warning: false
# ë°•ìŠ¤í”Œë¡¯
if(t_test_result_40$p.value < 0.05) {
  establishment_groups_40 <- data.frame(
    ì„¤ë¦½ = c("ê³µë¦½", "ì‚¬ë¦½"),
    group = c("a", "b")
  )
} else {
  establishment_groups_40 <- data.frame(
    ì„¤ë¦½ = c("ê³µë¦½", "ì‚¬ë¦½"),
    group = c("a", "a")
  )
}

found_stats_with_groups_40 <- found_stats_40 %>%
  left_join(establishment_groups_40, by = "ì„¤ë¦½")

ggplot(dat_score_found_40, aes(x = ì„¤ë¦½, y = ì‚¬ë¡€ì§€ì›ë„ì›€ì •ë„ì ìˆ˜, fill = ì„¤ë¦½)) +
  geom_boxplot(alpha = 0.7, width = 0.6, outlier.shape = 21) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 10, fill = "yellow", stroke = 1) +
  geom_text(data = found_stats_with_groups_40, 
            aes(x = ì„¤ë¦½, y = 10, label = paste0(group, "\n(M=", í‰ê· , ")")),
            inherit.aes = FALSE, fontface = "bold", size = 10, vjust = 0, lineheight=0.5) +
  labs(
    title = "ì„¤ë¦½ë³„ ì‚¬ë¡€ì§€ì›\n ìœ ìš©ì„± ì¸ì‹",
    x = "ì„¤ë¦½", 
    y = "ì‚¬ë¡€ì§€ì›\n ìœ ìš©ì„±"
  ) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(face = "bold", size = 32, hjust = 0.5),
    axis.text.x = element_text(size = 20),
    axis.text.y = element_text(size = 20,lineheight=0.5),
    axis.title.x = element_text(size = 20, margin = margin(t = 15)),
    axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5, lineheight=0.5),
    legend.position = "none"
  ) +
  scale_y_continuous(expand = expansion(mult = c(0.05, 0.15)))
```

### ë¬¸í•­41. í•™ìƒë§ì¶¤í†µí•©ì§€ì› ì²´ê³„ìš´ì˜ì„ í†µí•œ ê¸ì •ì ì¸ íš¨ê³¼ ë˜ëŠ” ìš°ìˆ˜ì‚¬ë¡€ì— ëŒ€í•´ì„œ ì‘ì„±í•˜ì—¬ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤. (ì£¼ê´€ì‹)

í•™ìƒë§ì¶¤í†µí•©ì§€ì› ì²´ê³„ìš´ì˜ì„ í†µí•´ ê¸ì •ì ì¸ íš¨ê³¼ ë˜ëŠ” ìš°ìˆ˜ì‚¬ë¡€ì™€ ëŒ€í•œ ë¬¸í•­ì—ì„œ ì¡°ê¸°ë°œê²¬ê³¼ ê´€ë ¨í•œ ë‹µë³€ì€ 463ê±´(43.9%), í†µí•©ì§€ì› ì²´ê³„ë§ˆë ¨ì´ë¼ëŠ” ë‹µë³€ì€ 368ê±´(.4.9%), ì‹¬ë¦¬ì •ì„œ ì§€ì›ì´ë¼ëŠ” ë‹µë³€ì€ 110ê±´(10.4%), ê±´ê°•ë³µì§€ ì§€ì›ì´ë¼ëŠ” ë‹µë³€ì€ 66ê±´(6.3%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¨

```{r}
#| echo: false
#| message: false
#| warning: false
# íŒ¨í‚¤ì§€
suppressPackageStartupMessages({
  library(dplyr)
  library(stringr)
  library(tidyr)
  library(ggplot2)
})

# ----- 0) ì‚¬ìš©ì ì„¤ì • -----

# (A) ì „ì²´ ì‘ë‹µì—ì„œ 'í†µì§¸ë¡œ ì œì™¸'í•  í‘œí˜„ (ë¬´ì‘ë‹µë¥˜)
ban_full <- c("í•´ë‹¹ì—†ìŒ","ì—†ìŒ","ë¬´ì‘ë‹µ","ëª¨ë¦„","ì˜ëª¨ë¥´ê² ","ì˜ ëª¨ë¥´ê² ", "\\.{1,}")  # ... ê°™ì€ ì  ëª‡ê°œë„ ì œê±°

# (B) í…ìŠ¤íŠ¸ ì•ˆì—ì„œ 'ì¹˜í™˜/ì‚­ì œ'í•  ê´€ìš©êµ¬(ì‚¬ì—…ëª…/í˜•ì‹ë¬¸êµ¬ ë“±) - ë¶„ì„ ì „ í…ìŠ¤íŠ¸ì—ì„œ ì œê±°
drop_phrases <- c(
  "í•™ìƒë§ì¶¤í†µí•©ì§€ì›", "ë„ì›€[ì´ê°€] í•„ìš”í•œ", "ì§€ì›ì´ í•„ìš”", "í•„ìš”í•˜ë‹¤ê³  ìƒê°",
  "ë„ì›€ì´ í•„ìš”", "í•„ìš”í•¨", "í•„ìš”í•¨ë‹ˆë‹¤", "í•„ìš”í•©ë‹ˆë‹¤", "ìˆìŠµë‹ˆë‹¤", "ì—†ìŠµë‹ˆë‹¤","í•´ë‹¹ ë¬´","ë¯¸ìš´ì˜"
)

# (C) í† í°(ë‹¨ì–´) ë‹¨ìœ„ì—ì„œ ì œê±°í•  ë¶ˆìš©ì–´(ë¹ˆë„í‘œì—ì„œ ì œì™¸)
stop_tokens <- c(
  # ë§¤ìš° ì¼ë°˜ì ì¸ ë¶ˆìš©ì–´
  "í•™ìƒ","í•™ìƒì—ê²Œ", "í•™ìƒì˜", "í•™ìƒë“¤ì˜", "í•™ìƒë“¤ì´","í•™ìƒì—ê²Œ","í•™ìƒë“¤ì—ê²Œ","ì§€ì›ì´", "ì§€ì›í• ", "ì§€ì›ì„ì„", "í•„ìš”","ë„ì›€","ì‚¬ì—…","í•™êµ","êµìœ¡","ê´€ë ¨","í™œë™","ìš´ì˜","í•„ìš”ì„±",
  "í•¨","í•¨ë‹ˆë‹¤","í•©ë‹ˆë‹¤","ë¨","ëœë‹¤","ê²ƒ","ìˆ˜","ë“±","ë°","í†µí•´","í†µí•œ","ëŒ€í•œ","ëŒ€í•´","ìœ„í•œ","ìœ„í•´",
  "ê°œì„ ","í™•ëŒ€","ê°•í™”","ì§„í–‰","í•„ìš”í•˜","í•„ìš”í•˜ë‹¤ê³ ","ìƒê°","ìƒê°í•¨","ìˆì„", "ì§€ì›ì´", "ë‹¤ì–‘í•œ",
  # ì‚¬ìš©ì ìš”ì²­ìœ¼ë¡œ ê¼­ ë¹¼ë‹¬ë¼ í•˜ì‹  í‘œí˜„ë“¤
  "í•™ìƒë§ì¶¤í†µí•©ì§€ì›","ë„ì›€ì´","í•„ìš”í•œ","ì§€ì›í•„ìš”","í•„ìš”í•˜ë‹¤ê³ ","í•„ìš”í•©ë‹ˆë‹¤", "ì—†ìŠµë‹ˆë‹¤", "ê²ƒì´", "ì•„ì§", "ìˆì–´ì„œ", "ìˆìŠµë‹ˆë‹¤"
)

# (D) 41ë²ˆìš© ì¹´í…Œê³ ë¦¬ ì‚¬ì „(ì›í•˜ì‹œë©´ í‚¤ì›Œë“œ ê³„ì† ì¶”ê°€)
dict41 <- list(
  "ì¡°ê¸°ë°œê²¬"            = c("ê°œì…","ìœ„ê¸°","ì§€ì›","ë³´í˜¸","ì¤‘ì¬", "ì´í•´","ê³µìœ ","í•™ìƒì§€ì›","ì ê²€","íŒŒì•…ìœ¼ë¡œ","íŒŒì•…","ë³µí•©ì ì¸","ê´€ë¦¬",
                        "ê´€ì°°", "ì •ë³´ê³µìœ ","ëª¨ìƒ‰","í•™ìƒì— ëŒ€í•œ","ì–´ë ¤ì›€","ë³µí•©","í˜¼ì","ê³µìœ ë¥¼","ê³µìœ ë¡œ","ì •ë³´ê³µìœ ë¡œ","ìœ„ê¸°í•™ìƒ",
                        "ì§€ì›ì´ í•„ìš”í•œ", "ë„ì›€ì´ í•„ìš”í•œ", "í•„ìš”í•œ í•™ìƒì—ê²Œ", "í•„ìš”í•œ í•™ìƒ", "ê²ªëŠ” í•™ìƒë“¤ì„"),
  "í•™ìŠµì§„ë¡œ ì§€ì›"       = c("í•™ìŠµ","ìˆ˜ì—…","ì§„ë¡œ","í•™ì—…","ì§€ë„","ë©˜í† ë§"),
  "ì‹¬ë¦¬ì •ì„œ ì§€ì›"       = c("ì •ì„œ","ì •ì„œì ", "ì‹¬ë¦¬","í–‰ë™","ì¹˜ìœ ","ìƒë‹´","ë¶ˆì•ˆ","ìš°ìš¸","ì‹¬ë¦¬ì ",
                      "ì ì‘ë ¥", "ìì‹ ê°","ì ì‘", "ì •ì„œí–‰ë™", "ìƒë‹´ì§€ì›","í•™êµì ì‘ë ¥","ìœ„ì„¼í„°"),
  "ì•ˆì „ìƒí™œ ì§€ì›"       = c("ì•ˆì „","í­ë ¥","í•™êµí­ë ¥","ì•„ë™í•™ëŒ€","ì„±í­ë ¥","ì¤‘ë…","ìí•´","ìœ„í—˜"),
  "ê±´ê°•ë³µì§€ ì§€ì›"       = c("ê±´ê°•","ìœ„ìƒ","ì˜ì–‘","ìš´ë™","ìŠ¤íŠ¸ë ˆìŠ¤","ìˆ˜ë©´","ë³µì§€","ì˜ë£Œ","ì‹ì‚¬", "ê²½ì œì ","ìˆ˜ê¸‰","ê¸°ì´ˆìˆ˜ê¸‰","ê²½ì œì ì§€ì›"),
  "í†µí•©ì§€ì› ì²´ê³„ë§ˆë ¨"   = c("í˜‘ë ¥","ì†Œí†µ", "ì—°ê³„","ë‹¤ê°ë„", "ì§€ì—­","ìœ ê´€ê¸°ê´€","ì„¼í„°","ì˜ë¢°","ë„¤íŠ¸ì›Œí¬","ì—°ê³„ë¥¼",
                    "ìì› ëŠ¥ë ¥", "ì—°ê³„í•˜ì—¬", "ì—°ìˆ˜","íš¨ìœ¨ì„±","íš¨ê³¼","ì˜ ìš´ì˜","ì§€ì—­ì—°ê³„", "ì²´ê³„", "ì²´ê³„ì ì¸",
                    "íš¨ìœ¨ì ","í†µí•©","ì‹œìŠ¤í…œ","êµ¬ì¶•","í˜‘ë ¥í•˜ì—¬","í˜‘ë ¥ìœ¼ë¡œ","ì»¨ì„¤íŒ…", "í†µí•©ì§€ì›", "ì²´ì œ","ì»¨íŠ¸ë¡¤íƒ€ì›Œ","ì»¨íŠ¸ë¡¤íƒ€ì›Œê°€",
                    "ì¸ì‹ê°œì„ ", "ì—°ê³„í•œ", "í˜‘ì—…","ì¼ê´„ì ì¸","í•¨ê»˜","ë§ì¶¤í˜•", "ìƒí™©ì— ë§ëŠ”", "ìœ ê¸°ì ","íš¨ìœ¨ì ì¸",
                    "ì˜ ìš´ì˜ë˜ê³ ", "ë‹¤ê°ì ì¸", "ë‹¤ê°ì ","êµ¬ì„±ì›ê°„ í˜‘ë ¥","í˜‘ë ¥ì„","êµìœ¡ë³µì§€ì„¼í„°","ì¶•ì†Œ",
                    "ì§€ì›ì´ ê°€ëŠ¥", "ì§€ì›ì´ ê°€ëŠ¥í•¨", "ê³µê°ëŒ€ í˜•ì„±", "í•™ìƒì—ê²Œ í•„ìš”í•œ", "í•™ìƒì— ëŒ€í•´",
                    "ì´ë£¨ì–´ì§€ê³  ìˆìŒ", "í•™ìƒì—ê²Œ í•„ìš”í•œ", "ë§ì¶¤ ì§€ì›ì´", "ìš´ì˜í•˜ê³  ìˆìŒ", "ì§€ì›ì„ í†µí•´", "í•™ìƒì—ê²Œ ì‹¤ì§ˆì ì¸"))


# â”€â”€ 1) í—¬í¼ í•¨ìˆ˜ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
esc <- function(x) stringr::str_replace_all(x, "([\\^$.|()?*+\\[\\]{}\\\\])","\\\\\\1")
key_to_regex <- function(keys){
  paste0("(?<![ê°€-í£A-Za-z0-9])(", paste(esc(keys), collapse="|"), ")(?![ê°€-í£A-Za-z0-9])")
}

# ë¬¸ì¥ì „ì²˜ë¦¬
clean_sentences <- function(x, ban_full, drop_phrases){
  x <- as.character(x); x <- x[!is.na(x)]
  x <- stringr::str_squish(x)
  if (length(x) == 0) return(character(0))
  # í†µì§¸ë¡œ ì œì™¸
  pat_ban <- paste0("(", paste(ban_full, collapse="|"), ")")
  x <- x[!stringr::str_detect(x, stringr::regex(pat_ban))]
  if (length(x) == 0) return(character(0))
  # ìƒíˆ¬êµ¬ ì œê±°
  if (length(drop_phrases) > 0) {
    pat_drop <- key_to_regex(drop_phrases)
    x <- stringr::str_replace_all(x, stringr::regex(pat_drop), " ")
  }
  # íŠ¹ìˆ˜ë¬¸ì ì œê±° + ê³µë°± ì •ë¦¬ + ë„ˆë¬´ ì§§ì€ ê²ƒ ì œê±°
  x <- stringr::str_replace_all(x, "[^ê°€-í£A-Za-z0-9\\s]", " ")
  x <- stringr::str_squish(x)
  x <- x[nchar(x) >= 2 & nzchar(x)]
  x
}

# 2ê¸€ì ì´ìƒ í•œê¸€ í† í°í™”(ê°„ì´) â€” ë™ì‚¬ì–´ë¯¸ ëŒ€ë¶€ë¶„ ìì—°íˆ ì†Œê±°ë¨
tokenize_ko2 <- function(sentences){
  if (length(sentences) == 0) return(tibble::tibble(doc=integer(), token=character()))
  tibble::tibble(doc = seq_along(sentences), text = sentences) |>
    dplyr::mutate(tokens = stringr::str_extract_all(text, "[ê°€-í£]{2,}")) |>
    tidyr::unnest(tokens) |>
    dplyr::transmute(doc, token = tokens) |>
    dplyr::filter(!is.na(token), nzchar(token))
}

# í† í° ë¹ˆë„í‘œ
count_tokens <- function(tokens_tbl, stop = NULL){
  out <- tokens_tbl
  if (!is.null(stop) && length(stop) > 0){
    pat_stop <- key_to_regex(stop)
    out <- dplyr::filter(out, !stringr::str_detect(token, stringr::regex(pat_stop)))
  }
  dplyr::count(out, token, name="n", sort=TRUE)
}

count_keys <- function(s, keys){
  pat <- key_to_regex(keys)
  as.integer(isTRUE(stringr::str_detect(s, stringr::regex(pat))))
}

# ë©€í‹°ë¼ë²¨ ì§‘ê³„
count_by_categories <- function(sentences, dict){
  if (length(sentences) == 0) return(tibble::tibble(category=character(), n=integer(), pct=numeric()))
  names_dict <- names(dict)
  row_df <- purrr::map_dfr(sentences, function(s){
    vals <- purrr::map_int(dict, ~ count_keys(s, .x))
    tibble::as_tibble_row(vals) |> rlang::set_names(names_dict)
  })
  counts <- colSums(as.matrix(row_df), na.rm = TRUE)
  tibble::tibble(category = names(counts), n = as.integer(counts)) |>
    dplyr::arrange(dplyr::desc(n)) |>
    dplyr::mutate(pct = round(n / sum(n) * 100, 1))
}

# Top1 ë°°ì •
classify_top1 <- function(sentences, dict){
  if (length(sentences) == 0) return(tibble::tibble(category=character(), n=integer(), pct=numeric()))
  top1 <- purrr::map_chr(sentences, function(s){
    scores <- purrr::map_int(dict, ~ count_keys(s, .x))
    if (all(scores == 0L)) "ê¸°íƒ€" else names(dict)[which.max(scores)]
  })
  tibble::tibble(category = top1) |>
    dplyr::count(category, name="n", sort=TRUE) |>
    dplyr::mutate(pct = round(n / sum(n) * 100, 1))
}

## ---- (1) í…ìŠ¤íŠ¸ í´ë¦° â†’ ë©€í‹°ë¼ë²¨ ë¹ˆë„ (ê¸°íƒ€ ì œì™¸) ----

QCOL  <- "ques_41"       # <- 42ë²ˆ ëŒë¦´ ë• "ques_42" ë¡œë§Œ ë°”ê¾¸ë©´ ë¨
QNAME <- "ë¬¸í•­ 41"

#   * ì´ ìœ íš¨ì‘ë‹µ ìˆ˜ì™€ 'ì‚¬ì „ ë¯¸ì í•©(=ê¸°íƒ€ í›„ë³´)' ìˆ˜ë„ ê°™ì´ ì¶œë ¥
txt_raw   <- dat[[QCOL]]
txt_clean <- clean_sentences(txt_raw, ban_full, drop_phrases)        # â† ê¸°ì¡´ í—¬í¼ ì‚¬ìš©
N_valid   <- length(txt_clean)


# ë©€í‹°ë¼ë²¨(í•œ ë¬¸ì¥ì´ ì—¬ëŸ¬ ì¹´í…Œê³ ë¦¬ ê¸°ì—¬) ì§‘ê³„
freq_multi <- count_by_categories(txt_clean, dict41)                  # â† ê¸°ì¡´ í—¬í¼ ì‚¬ìš©

# 'ì‚¬ì „ ë¯¸ì í•©(=ê¸°íƒ€ í›„ë³´)' ë¬¸ì¥ ìˆ˜ ê³„ì‚°
# (ê° ë¬¸ì¥ì—ì„œ dict41 ì–´ë–¤ í‚¤ì›Œë“œë„ ì•ˆ ë§ìœ¼ë©´ 'ê¸°íƒ€')
matched_any <- vapply(txt_clean, function(s){
  any(vapply(dict41, function(keys){
    count_keys(s, keys) > 0L
  }, logical(1)))
}, logical(1))
n_misc <- sum(!matched_any)

# âœ… ì´ ê°¯ìˆ˜ ì •ë³´ ì¶œë ¥
cat("\n=== ë¬¸í•­ 41 í…ìŠ¤íŠ¸ ë¶„ì„ ê²°ê³¼ ===\n")
cat("ì›ë³¸ ì‘ë‹µ ìˆ˜:", length(txt_raw[!is.na(txt_raw)]), "ê°œ\n")
cat("ìœ íš¨ ì‘ë‹µ ìˆ˜:", N_valid, "ê°œ\n")
cat("ì´ ë¶„ë¥˜í•­ëª© ë§¤ì¹­ ìˆ˜:", sum(freq_multi$n), "ê°œ\n")

# 41ë²ˆ ë¬¸í•­ ì˜ì—­ë³„ ì‘ë‹µ í•©ê³„ ì¶”ê°€ (42ë²ˆ ìŠ¤íƒ€ì¼)
freq_multi_with_total <- freq_multi %>%
  bind_rows(
    tibble(
      category = "í•©ê³„",
      n = sum(freq_multi$n),
      pct = 100.0
    )
  )

# í•©ê³„ í¬í•¨ ê²°ê³¼ ì¶œë ¥
print(freq_multi_with_total)
```

```{r}
#| echo: false
#| message: false
#| warning: false

# 41ë²ˆ ë¬¸í•­ ë§‰ëŒ€ê·¸ë˜í”„ ìˆ˜ì • (ë°ì´í„° ë ˆì´ë¸” ì¹¨ë²” ë°©ì§€)
p_multi <- freq_multi %>%
  filter(n > 0) %>%
  mutate(category = factor(category, levels = rev(category))) %>%
  ggplot(aes(x = category, y = n)) +
  geom_col(width = 0.37, fill = "#2E8B57", alpha = 0.9) +
  geom_text(aes(label = paste0(n, " (", pct, "%)")), 
            hjust = 0.5, vjust = -0.5, size = 6, fontface = "bold") +  # hjust=0.5 (ì¤‘ì•™), vjust=-0.3 (ë§‰ëŒ€ ìœ„)
  coord_flip() +
  labs(title = sprintf("%s. ê¸ì •ì ì¸ íš¨ê³¼\n ë˜ëŠ” ì‚¬ë¡€ë¶„ì•¼", QNAME),
       x = "ìš°ìˆ˜ì‚¬ë¡€ ë¶„ì•¼", y = "ì‘ë‹µìˆ˜") +
  scale_y_continuous(expand = expansion(mult = c(0, 0.25))) +
  theme_minimal(base_size = 13) +
  theme(plot.title = element_text(face="bold", size=32, hjust=0.5, lineheight = 0.5),
        axis.text.x = element_text(size = 18, margin = margin(t = 10)),
        axis.text.y = element_text(size = 18),
        axis.title.x = element_text(size = 20, angle = 0, margin = margin(t = 15)),
        axis.title.y = element_text(size = 20, angle = 0, vjust = 0.5),
        plot.margin = margin(20, 30, 20, 20)
  ) +
  coord_cartesian(clip = "off")

print(p_multi)
```

```{r}
#| echo: false
#| message: false
#| warning: false
tokens_all <- tokenize_ko2(txt_clean)                                # â† ê¸°ì¡´ í—¬í¼ ì‚¬ìš©
freq_tok   <- count_tokens(tokens_all, stop = stop_tokens)           # â† ê¸°ì¡´ í—¬í¼ ì‚¬ìš©

top20_tbl <- freq_tok %>%
  slice_max(n, n = 20) %>%
  mutate(token = factor(token, levels = rev(token)))

if (requireNamespace("wordcloud", quietly = TRUE) &&
    requireNamespace("RColorBrewer", quietly = TRUE)) {
  if (.Platform$OS.type == "windows") {
    suppressWarnings(try(windowsFonts(malgun = windowsFont("Malgun Gothic")), silent = TRUE))
    par(family = "malgun")
  }
  
  # âœ… ì—¬ë°± ì¡°ì • - ìœ„ìª½ ì—¬ë°±ì„ ëŠ˜ë ¤ì„œ íƒ€ì´í‹€ ê³µê°„ í™•ë³´
  par(mar = c(3, 3, 8, 3))  # bottom, left, top, right ì—¬ë°±
  
  with(freq_tok, wordcloud::wordcloud(
    words = token, freq = n,
    min.freq = max(2, floor(0.005 * nrow(freq_tok))),
    max.words = 150, random.order = FALSE, rot.per = 0.1,
    colors = RColorBrewer::brewer.pal(8, "Dark2"),
    scale = c(20, 3)  # âœ… ê¸€ì”¨ í¬ê¸° ëŒ€í­ ì¦ê°€
  ))
  
        
} else {
  message("wordcloud / RColorBrewer íŒ¨í‚¤ì§€ê°€ ì—†ì–´ ì›Œë“œí´ë¼ìš°ë“œëŠ” ê±´ë„ˆëœë‹ˆë‹¤.")
}
```

### ë¬¸í•­42. í•™ìƒë§ì¶¤í†µí•©ì§€ì› ì²´ê³„ê°€ ë°œì „í•  ìˆ˜ ìˆë„ë¡ ì œì–¸í•˜ì‹œê±°ë‚˜ ì˜ê²¬ì„ ì‘ì„±í•˜ì—¬ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤. (ì£¼ê´€ì‹)

í•™ìƒë§ì¶¤í†µí•©ì§€ì› ì²´ê³„ê°€ ë°œì „í•  ìˆ˜ ìˆë„ë¡ ì œì–¸ ë˜ëŠ” ì˜ê²¬ê³¼ ê´€ë ¨í•´ì„œ ì¸ë ¥ã†ì˜ˆì‚°ã†í–‰ì •ì— ê´€í•œ ìš”ì²­ì€ 123ê±´(25.5%), ì¸ì‹ã†í™ë³´ã†ì—°ìˆ˜ì— ê´€í•œ ìš”ì²­ì€ 123ê±´(25.5%), ì¡°ê¸°ë°œê²¬ã†ì‚¬ë¡€ê´€ë¦¬ì— ê´€í•œ ìš”ì²­ì€ 88ê±´(18.3%), ì§€ì—­ì—°ê³„ã†ê¸°ê´€í˜‘ë ¥ì— ê´€í•œ ìš”ì²­ì€ 66ê±´(13.7%), ì²´ê³„ã†ì§€ì¹¨ã†ì œë„ì— ê´€í•œ ìš”ì²­ì€ 40ê±´(8.3%) ë“±ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

```{r}
#| echo: false
#| message: false
#| warning: false
# ---- (0) ë¶„ì„ ëŒ€ìƒ ë¬¸í•­ ì„ íƒ ----
QCOL  <- "ques_42"       # <- 42ë²ˆ ëŒë¦´ ë• "ques_42" ë¡œë§Œ ë°”ê¾¸ë©´ ë¨
QNAME <- "ë¬¸í•­ 42"

if (!exists("ban_full")) ban_full <- c(
  "í•´ë‹¹ì—†ìŒ","ì—†ìŒ","ë¬´ì‘ë‹µ","ëª¨ë¦„","ì˜ëª¨ë¥´ê² ","ì˜ ëª¨ë¥´ê² ","ë¯¸ì‘ë‹µ","ë¬´", "ìˆë„ë¡", "ë˜ëŠ”",
  "\\.{1,}"                 # "..." ê°™ì€ ì ë§Œ ìˆëŠ” ì‘ë‹µ ì œê±°
)

if (!exists("drop_phrases")) drop_phrases <- c(
  # 42ë²ˆ í…ìŠ¤íŠ¸ì—ì„œ ë¶„ì„ ì˜ë¯¸ê°€ ì•½í•œ ìƒíˆ¬êµ¬/í˜•ì‹ ë¬¸êµ¬ (ì›í•˜ë©´ ì¶”ê°€/ìˆ˜ì •)
  "í•™ìƒë§ì¶¤í†µí•©ì§€ì›","ë„ì›€[ì´ê°€] í•„ìš”í•œ","ì§€ì›ì´ í•„ìš”","í•„ìš”í•˜ë‹¤ê³  ìƒê°",
  "í•„ìš”í•¨","í•„ìš”í•©ë‹ˆë‹¤","ìˆìŠµë‹ˆë‹¤","ì—†ìŠµë‹ˆë‹¤", "ìˆë„ë¡", "ì§€ì†ì ì¸"
)

if (!exists("stop_tokens")) stop_tokens <- c(
  # ë§¤ìš° ì¼ë°˜ì ì¸ ë¶ˆìš©ì–´(í•„ìš” ì‹œ ê°€ê°)
  "í•™ìƒ","í•™ìƒë“¤","í•™ìƒì˜","í•™êµ","êµìœ¡","ì§€ì›","ì‚¬ì—…","í•„ìš”","ë„ì›€",
  "ê´€ë ¨","ìš´ì˜","ê°œì„ ","ê°•í™”","í™•ëŒ€","ì§„í–‰","ê²ƒ","ìˆ˜","ë“±","ë°","ìœ„í•´",
  "í†µí•´","ëŒ€í•œ","ëŒ€í•´","ìˆë‹¤","í•˜ë‹¤","ë¨","ëœë‹¤","í–ˆìŠµë‹ˆë‹¤","í–ˆìŠµë‹ˆë‹¤ë§Œ",
  # ìš”ì²­: ì‚¬ì—…ëª…/í˜•ì‹ë¬¸êµ¬ë¥˜
  "í•™ìƒë§ì¶¤í†µí•©ì§€ì›","ë„ì›€ì´","í•„ìš”í•œ","í•„ìš”í•©ë‹ˆë‹¤","ì—†ìŠµë‹ˆë‹¤","ìˆìŠµë‹ˆë‹¤"
)

# 42ë²ˆìš© ì¹´í…Œê³ ë¦¬ ì‚¬ì „(ë©€í‹°ë¼ë²¨ìš©) â€” í•„ìš” ì‹œ ì–´íœ˜ ì¶”ê°€/ìˆ˜ì •
dict42 <- list(
  "ì¡°ê¸°ë°œê²¬Â·ì‚¬ë¡€ê´€ë¦¬"  = c("ì¡°ê¸°","ë°œêµ´","íŒŒì•…","ì‹ë³„","ì‚¬ë¡€","ê´€ë¦¬","ê°œì…","ì¤‘ì¬","ì—°ê³„","ì˜ë¢°"),
  "í•™ìŠµÂ·ì§„ë¡œì§€ì›"      = c("í•™ìŠµ","í•™ì—…","ìˆ˜ì—…","ë³´ì¶©","ë©˜í† ë§","ì§„ë¡œ","ì§„í•™","ìƒë‹´"),
  "ì‹¬ë¦¬ì •ì„œÂ·í–‰ë™ì§€ì›"  = c("ì •ì„œ","ì‹¬ë¦¬","í–‰ë™","ë¶ˆì•ˆ","ìš°ìš¸","ìƒë‹´","ì¹˜ìœ ","íšŒë³µ","ì ì‘"),
  "ê±´ê°•Â·ë³µì§€ì§€ì›"      = c("ê±´ê°•","ìœ„ìƒ","ì˜ì–‘","ìš´ë™","ìˆ˜ë©´","ìŠ¤íŠ¸ë ˆìŠ¤","ë³µì§€","ì˜ë£Œ","ê²½ì œì "),
  "ì§€ì—­ì—°ê³„Â·ê¸°ê´€í˜‘ë ¥"  = c("ì§€ì—­","ê¸°ê´€","ì„¼í„°","ë³µì§€ê´€","ê²½ì°°","ë³‘ì›","ì—°ê³„","í˜‘ë ¥","ë„¤íŠ¸ì›Œí¬"),
  "ì²´ê³„Â·ì§€ì¹¨Â·ì œë„"     = c("ì²´ê³„","ì‹œìŠ¤í…œ","ì§€ì¹¨","ê°€ì´ë“œ","ê·œì •","ì œë„","ì»¨íŠ¸ë¡¤íƒ€ì›Œ","í”„ë¡œì„¸ìŠ¤"),
  "ì¸ë ¥Â·ì˜ˆì‚°Â·í–‰ì •"     = c("ì¸ë ¥","ì „ë‹´","ì˜ˆì‚°","ì¬ì •","í–‰ì •","ì„œë¥˜","ê³µë¬¸","ì‹œê°„","ê³¼ì¤‘","ë¶€ë‹´"),
  "ì¸ì‹Â·í™ë³´Â·ì—°ìˆ˜"     = c("ì¸ì‹","í™ë³´","ì—°ìˆ˜","êµìœ¡","ìº í˜ì¸","ì•ˆë‚´","ì„¤ëª…íšŒ","ì›Œí¬ìˆ")
)

# ----- 1) í—¬í¼ í•¨ìˆ˜ -----
esc <- function(x) str_replace_all(x, "([\\^$.|()?*+\\[\\]{}\\\\])","\\\\\\1")
key_to_regex <- function(keys){
  paste0("(?<![ê°€-í£A-Za-z0-9])(", paste(esc(keys), collapse="|"), ")(?![ê°€-í£A-Za-z0-9])")
}

clean_sentences <- function(x, ban_full, drop_phrases){
  x <- as.character(x)
  x <- x[!is.na(x)]
  x <- str_squish(x)
  if (length(x) == 0) return(character(0))
  # í†µì§¸ë¡œ ì œì™¸(ë¬´ì‘ë‹µë¥˜)
  pat_ban <- paste0("(", paste(ban_full, collapse="|"), ")")
  x <- x[!str_detect(x, regex(pat_ban))]
  if (length(x) == 0) return(character(0))
  # ìƒíˆ¬êµ¬ ì œê±°
  if (length(drop_phrases) > 0) {
    pat_drop <- key_to_regex(drop_phrases)
    x <- str_replace_all(x, regex(pat_drop), " ")
  }
  # íŠ¹ìˆ˜ë¬¸ì ì œê±° + ê³µë°± ì •ë¦¬ + ì•„ì£¼ ì§§ì€ ì‘ë‹µ ì œê±°
  x <- str_replace_all(x, "[^ê°€-í£A-Za-z0-9\\s]", " ")
  x <- str_squish(x)
  x <- x[nchar(x) >= 2 & nzchar(x)]
  x
}

tokenize_ko2 <- function(sentences){
  if (length(sentences) == 0) return(tibble(doc=integer(), token=character()))
  tibble(doc = seq_along(sentences), text = sentences) %>%
    mutate(tokens = str_extract_all(text, "[ê°€-í£]{2,}")) %>%
    unnest(tokens) %>%
    transmute(doc, token = tokens) %>%
    filter(!is.na(token), nzchar(token))
}

count_tokens <- function(tokens_tbl, stop = NULL){
  out <- tokens_tbl
  if (!is.null(stop) && length(stop) > 0){
    pat_stop <- key_to_regex(stop)
    out <- filter(out, !str_detect(token, regex(pat_stop)))
  }
  count(out, token, name="n", sort=TRUE)
}

count_keys <- function(s, keys){
  pat <- key_to_regex(keys)
  as.integer(isTRUE(str_detect(s, regex(pat))))
}

# ë©€í‹°ë¼ë²¨ ì§‘ê³„
count_by_categories <- function(sentences, dict){
  if (length(sentences) == 0) return(tibble(category=character(), n=integer(), pct=numeric()))
  names_dict <- names(dict)
  row_df <- map_dfr(sentences, function(s){
    vals <- map_int(dict, ~ count_keys(s, .x))
    tibble::as_tibble_row(vals) |> rlang::set_names(names_dict)
  })
  counts <- colSums(as.matrix(row_df), na.rm = TRUE)
  tibble(category = names(counts), n = as.integer(counts)) |>
    arrange(desc(n)) |>
    mutate(pct = round(n / sum(n) * 100, 1))
}

# Top1 ë‹¨ì¼ ë¶„ë¥˜
classify_top1 <- function(sentences, dict){
  if (length(sentences) == 0) return(tibble(category=character(), n=integer(), pct=numeric()))
  top1 <- map_chr(sentences, function(s){
    scores <- map_int(dict, ~ count_keys(s, .x))
    if (all(scores == 0L)) "ê¸°íƒ€" else names(dict)[which.max(scores)]
  })
  tibble(category = top1) |>
    count(category, name="n", sort=TRUE) |>
    mutate(pct = round(n / sum(n) * 100, 1))
}

# ----- 2) ë³¸ë¶„ì„(ques_42) -----
q42_raw   <- dat$ques_42
q42_clean <- clean_sentences(q42_raw, ban_full, drop_phrases)

# ê¸°ìˆ í†µê³„ ì¶œë ¥ ì¶”ê°€
N_raw_42 <- length(q42_raw[!is.na(q42_raw)])  # ì›ë³¸ ì‘ë‹µ ìˆ˜
N_valid_42 <- length(q42_clean)               # ì „ì²˜ë¦¬ í›„ ìœ íš¨ ì‘ë‹µ ìˆ˜


# 2-1) ë©€í‹°ë¼ë²¨ ë¹ˆë„(ê¸°íƒ€ ì œì™¸ í‘œì‹œ + ì´í•© í™•ì¸)
freq42_multi <- count_by_categories(q42_clean, dict42)
total_labeled <- sum(freq42_multi$n)  # ë©€í‹°ë¼ë²¨ ì´ ì¹´ìš´íŠ¸(ë¬¸ì¥ 1ê°œê°€ ë³µìˆ˜ ì¹´í…Œê³ ë¦¬ì— ê¸°ì—¬)

# 'ê¸°íƒ€' ë¬¸ì¥ ìˆ˜ ê³„ì‚° (ì‚¬ì „ ë¯¸ì í•©)
classified_top1 <- classify_top1(q42_clean, dict42)
n_misc_42 <- classified_top1 %>% filter(category == "ê¸°íƒ€") %>% pull(n)
if(length(n_misc_42) == 0) n_misc_42 <- 0

# ê°„ë‹¨í•œ ê¸°ìˆ í†µê³„ ì¶œë ¥
cat("\n=== ë¬¸í•­ 42 í…ìŠ¤íŠ¸ ë¶„ì„ ê²°ê³¼ ===\n")
cat("ì›ë³¸ ì‘ë‹µ ìˆ˜:", N_raw_42, "ê°œ\n")
cat("ìœ íš¨ ì‘ë‹µ ìˆ˜:", N_valid_42, "ê°œ\n")
cat("ì´ ë¶„ë¥˜í•­ëª© ë§¤ì¹­ ìˆ˜:", sum(freq42_multi$n), "ê°œ\n\n")

# í•©ê³„ í–‰ ì¶”ê°€ëœ ë©€í‹°ë¼ë²¨ ê²°ê³¼
freq42_multi_with_total <- freq42_multi %>%
  bind_rows(
    tibble(
      category = "í•©ê³„",
      n = sum(freq42_multi$n),
      pct = 100.0
    )
  )

# (ë³´ê³ ìš©) ê¸°íƒ€ ì œì™¸í•œ ë§‰ëŒ€
freq42_multi_no_etc <- freq42_multi %>% filter(category != "ê¸°íƒ€")
print(freq42_multi_with_total)
```

```{r}
#| echo: false
#| message: false
#| warning: false
# 42ë²ˆ ë¬¸í•­ ì„¸ë¡œ ë§‰ëŒ€ê·¸ë˜í”„ (ë°ì´í„° ë ˆì´ë¸” ê°œì„ )
p_multi_42 <- freq42_multi_no_etc %>%
  filter(n > 0) %>%
  mutate(category = factor(category, levels = category[order(n)])) %>%
  ggplot(aes(x = category, y = n)) +
  geom_col(width = 0.6, fill = "#2E8B57", alpha = 0.9) +
  geom_text(aes(label = paste0(n, " (", pct, "%)")), 
            vjust = -0.5, size = 5.5, fontface = "bold") +  # ê¸€ì”¨ í¬ê¸° 5â†’8ë¡œ ì¦ê°€
  labs(title = sprintf("%s. í•™ìƒë§ì¶¤í†µí•©ì§€ì› ì²´ê³„\në°œì „ì„ ìœ„í•œ ì œì–¸", QNAME),
       x = "ê°œì„ Â·ë°œì „ ë¶„ì•¼", y = "ì‘ë‹µìˆ˜") +
  scale_y_continuous(expand = expansion(mult = c(0, 0.15))) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face="bold", size=28, hjust=0.5, lineheight = 0.5),
    axis.text.x = element_text(size = 17, angle = 45, hjust = 1, margin = margin(t = 10)),
    axis.text.y = element_text(size = 16),
    axis.title.x = element_text(size = 22, margin = margin(t = 15)),
    axis.title.y = element_text(size = 22, angle = 0, vjust = 0.5, margin = margin(r = 15)), # angle=0ìœ¼ë¡œ ê°€ë¡œ ì„¤ì •
    plot.margin = margin(20, 20, 20, 20)
  ) +
  coord_cartesian(clip = "off")

print(p_multi_42)
```

```{r}
#| echo: false
#| message: false
#| warning: false
# ---- (3) ê¸°ì¡´ ë§‰ëŒ€ê·¸ë˜í”„ ë°ì´í„°ë¡œ ì›Œë“œí´ë¼ìš°ë“œ ----
if (requireNamespace("wordcloud", quietly = TRUE) &&
    requireNamespace("RColorBrewer", quietly = TRUE)) {
  if (.Platform$OS.type == "windows") {
    suppressWarnings(try(windowsFonts(malgun = windowsFont("Malgun Gothic")), silent = TRUE))
    par(family = "malgun")
  }
  
  # ì—¬ë°± ìµœì†Œí™”
  par(mar = c(0.5, 0.5, 0.5, 0.5))
  
  # âœ… ê¸°ì¡´ ë§‰ëŒ€ê·¸ë˜í”„ì™€ ë™ì¼í•œ ë°ì´í„° ì‚¬ìš©
  with(freq42_multi_no_etc, wordcloud::wordcloud(
    words = category, freq = n,
    min.freq = 1,  # ëª¨ë“  ì¹´í…Œê³ ë¦¬ í‘œì‹œ
    max.words = 20, random.order = FALSE, rot.per = 0.2,
    colors = RColorBrewer::brewer.pal(8, "Dark2"),
    scale = c(8, 2)  # í¬ê¸°ë¥¼ ì¡°ê¸ˆ ì¤„ì—¬ì„œ ê¸´ ì¹´í…Œê³ ë¦¬ëª…ë„ ë“¤ì–´ê°€ê²Œ
  ))
  
} else {
  message("wordcloud / RColorBrewer íŒ¨í‚¤ì§€ê°€ ì—†ì–´ ì›Œë“œí´ë¼ìš°ë“œëŠ” ê±´ë„ˆëœë‹ˆë‹¤.")
}
```

# 7. í•™êµ ìœ í˜• ë¶„ë¥˜

ì„¤ë¬¸ ë¬¸í•­ ì¤‘ì—ì„œ í•™ìƒë§ì¶¤í†µí•©ì§€ì› ì •ì±…ì— ëŒ€í•œ ì¸ì‹ë„, í™ë³´ í•„ìš”ì„±, êµìœ¡êµ¬ì„±ì› ê°„ í˜‘ë ¥ì˜ ì¤‘ìš”ì„±, ì›í™œì„±ì— ëŒ€í•œ í‰ê°€, í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ ìš´ì˜íšŸìˆ˜, í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ì´ ì§€ì›í•œ í•™ìƒìˆ˜ ë¬¸í•­ì„ í™œìš©í•˜ì—¬ êµ°ì§‘ë¶„ì„ì„ ì‹¤ì‹œí•˜ê³  í•™êµ íŠ¹ì„±ì„ ë¶„ë¥˜í•˜ì˜€ìŒ. ì‘ë‹µìëŠ” í•™êµë³„ ì¤‘ë³µì‘ë‹µìë¥¼ ì œì™¸í•œ 1,155ëª…ì„ ëŒ€ìƒìœ¼ë¡œ ë¶„ì„ì„ ì‹¤ì‹œí•˜ì˜€ìŒ.

```{r}
#| echo: false
#| message: false
#| warning: false


library(dplyr)
library(cluster)
library(factoextra)
library(ggplot2)

# í•™êµë³„ ëŒ€í‘œ ì‘ë‹µì ì„ ì • ë° ì ìˆ˜ ì²´ê³„ ìˆ˜ì •
dat_cluster <- dat %>%
  filter(!is.na(ques_12)) %>%
  mutate(
    ìš°ì„ ìˆœìœ„ = case_when(
      ques_7 == "2" ~ 1,  # êµê°
      ques_7 == "1" ~ 2,  # êµì¥  
      ques_7 == "3" ~ 3,  # êµì‚¬
      ques_7 == "4" ~ 4,  # ìƒë‹´êµì‚¬
      ques_7 == "8" ~ 5,  # ì§€ì—­ì‚¬íšŒêµìœ¡ì „ë¬¸ê°€
      ques_7 == "9" ~ 6,  # ìƒë‹´ì‚¬
      ques_7 == "5" ~ 7,  # ë³´ê±´êµì‚¬
      TRUE ~ 8
    )
  ) %>%
  group_by(í•™êµì•„ì´ë””) %>%  
  arrange(ìš°ì„ ìˆœìœ„) %>%
  slice(1) %>%
  ungroup() %>%
  filter(!is.na(ques_19), !is.na(ques_20),
         !is.na(ques_9), !is.na(ques_11),
         !is.na(ques_28), !is.na(ques_29)) %>%
  mutate(
    í•™êµê¸‰ = recode(as.character(ques_1),
                 "1" = "ì´ˆë“±í•™êµ",
                 "2" = "ì¤‘í•™êµ", 
                 "3" = "ê³ ë“±í•™êµ",
                 "4" = "íŠ¹ìˆ˜í•™êµ",
                 "5" = "ê°ì¢…í•™êµ"),
    # ì ìˆ˜ ì²´ê³„ ìˆ˜ì •: 1ë²ˆ=5ì , 2ë²ˆ=4ì , 3ë²ˆ=3ì , 4ë²ˆ=2ì , 5ë²ˆ=1ì 
    ì •ì±…ì¸ì§€ë„ = 6 - as.numeric(ques_9),
    í™ë³´ì¶©ë¶„ì„± = 6 - as.numeric(ques_11),
    í˜‘ë ¥ì¤‘ìš”ì„± = 6 - as.numeric(ques_28),
    í˜‘ë ¥ì‹¤í–‰ë„ = 6 - as.numeric(ques_29),
    # íŒ€ìš´ì˜íšŸìˆ˜ ì‹¤ì œ ê°’ìœ¼ë¡œ ë³€í™˜ (19ë²ˆ ë¬¸í•­)
    íŒ€ìš´ì˜íšŸìˆ˜ = case_when(
      ques_19 == "1" ~ 1,    # 1íšŒ
      ques_19 == "2" ~ 2,    # 2íšŒ
      ques_19 == "3" ~ 3,    # 3íšŒ
      ques_19 == "4" ~ 4,    # 4íšŒ
      ques_19 == "5" ~ 5,    # 5íšŒ ì´ìƒ â†’ 5ë¡œ ì„¤ì •
      ques_19 == "6" ~ 0,    # ë¯¸ì‹¤ì‹œ â†’ 0ìœ¼ë¡œ ì„¤ì •
      TRUE ~ NA_real_
    ),
    # ì§€ì›í•™ìƒìˆ˜ ì‹¤ì œ ê°’ìœ¼ë¡œ ë³€í™˜ (20ë²ˆ ë¬¸í•­)
    ì§€ì›í•™ìƒìˆ˜ = case_when(
      ques_20 == "1" ~ 1,    # 1ëª…
      ques_20 == "2" ~ 2,    # 2ëª…
      ques_20 == "3" ~ 3,    # 3ëª…
      ques_20 == "4" ~ 4,    # 4ëª…
      ques_20 == "5" ~ 5,    # 5ëª… ì´ìƒ â†’ 5ë¡œ ì„¤ì •
      ques_20 == "6" ~ 0,    # ì—†ìŒ â†’ 0ìœ¼ë¡œ ì„¤ì •
      TRUE ~ NA_real_
    ),
    ì§ì±… = case_when(
      ques_7 == "1" ~ "êµì¥",
      ques_7 == "2" ~ "êµê°",
      TRUE ~ "êµì‚¬ë“±"
    )
  )

cat("êµ°ì§‘ë¶„ì„ ëŒ€ìƒ í•™êµ ìˆ˜:", nrow(dat_cluster), "ê°œêµ\n")
```

í•™êµ ê·¸ë£¹ì€ ìµœì êµ°ì§‘ìˆ˜ ë¶„ë¥˜ê²°ê³¼ì— ë”°ë¼ ë‹¤ìŒê³¼ ê°™ì´ 3ê°œ ê·¸ë£¹ìœ¼ë¡œ ë¶„ë¥˜í•˜ì˜€ìŒ

1 ê·¸ë£¹: ì •ì±…ì¸ì‹ë„ ë° ì·¨ì§€ì— ëŒ€í•œ ì´í•´ë„ê°€ ìƒëŒ€ì ìœ¼ë¡œ ë‚®ê³ , í†µí•©ì§€ì›íŒ€ ìš´ì˜ë„ ì›í™œí•˜ì§€ ì•Šì€ í•™êµ

2 ê·¸ë£¹: ì •ì±…ì¸ì‹ë„ ë° ì·¨ì§€ì— ëŒ€í•œ ì´í•´ë„ëŠ” ë†’ìœ¼ë‚˜, í†µí•©ì§€ì›íŒ€ ìš´ì˜ì€ ì›í™œí•˜ì§€ ì•Šì€ í•™êµ

3 ê·¸ë£¹: ì •ì±…ì¸ì§€ë„ ë° ì·¨ì§€ì— ëŒ€í•œ ì´ëŒ€ë„ë„ ë†’ê³ , í†µí•©ì§€ì›íŒ€ ìš´ì˜ë„ í™œì„±í™” ëœ í•™êµ

```{r}
#| echo: false
#| message: false
#| warning: false

# êµ°ì§‘ë¶„ì„ìš© ë³€ìˆ˜ ì¶”ì¶œ ë° í‘œì¤€í™”
cluster_vars <- dat_cluster %>% 
  select(ì •ì±…ì¸ì§€ë„, í™ë³´ì¶©ë¶„ì„±, í˜‘ë ¥ì¤‘ìš”ì„±, í˜‘ë ¥ì‹¤í–‰ë„, íŒ€ìš´ì˜íšŸìˆ˜, ì§€ì›í•™ìƒìˆ˜)

cluster_scaled <- scale(cluster_vars)

# ìµœì  êµ°ì§‘ ìˆ˜ ê²°ì • (Elbow Method)
fviz_nbclust(cluster_scaled, kmeans, method = "wss") +
  labs(title = "ìµœì  êµ°ì§‘ ìˆ˜ ê²°ì • (Elbow Method)")
```

í•™êµë³„ ìœ í˜•ì€ 3ê°œ ìœ í˜•ìœ¼ë¡œ ë¶„ë¥˜í•˜ì˜€ìœ¼ë©°, 1ê·¸ë£¹ì€ ì •ì±…ì¸ì§€ë„, ì •ì±… í™ë³´ì˜ ì¶©ë¶„ì„±ì— ëŒ€í•œ ì¸ì‹, í˜‘ë ¥ì¤‘ìš”ì„±ì— ëŒ€í•œ ì¸ì‹, í˜‘ë ¥ ì‹¤í–‰ì´ ì›í™œí•œì§€ì— ëŒ€í•´ì„œ ê°€ì¥ í‰ê· ì ìˆ˜ê°€ ë‚®ì€ ê·¸ë£¹ì— í•´ë‹¹í•¨. 2ê·¸ë£¹ì€ í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ì˜ ìš´ì˜íšŸìˆ˜ê°€ ì§€ì›í•™ìƒìˆ˜ê°€ ê°€ì¥ ì ì€ ê·¸ë£¹ì´ë©°, 3ê·¸ë£¹ì€ í•™ìƒë§ì¶¤í†µí•©ì§€ì›íŒ€ ìš´ì˜íšŸìˆ˜ì™€ ì§€ì›í•™ìƒìˆ˜ê°€ 3ê·¸ë£¹ ì¤‘ì—ì„œ ê°€ì¥ ë†’ê³ , ê·¸ ì™¸ ë¬¸í•­ì—ì„œë„ í‰ê· ì ìˆ˜ê°€ ìš°ìˆ˜í•œ ê·¸ë£¹ì´ì—ˆìŒ.

```{r}
#| echo: false
#| message: false
#| warning: false
# K-means êµ°ì§‘ë¶„ì„ ë° ê²°ê³¼ ì¶œë ¥ (í†µí•© ì½”ë“œ)
set.seed(123)
k3_result <- kmeans(cluster_scaled, centers = 3, nstart = 25)

# êµ°ì§‘ ê²°ê³¼ ì¶”ê°€
dat_cluster_final <- dat_cluster %>%
  mutate(êµ°ì§‘ = as.factor(k3_result$cluster))

# êµ°ì§‘ë³„ ê¸°ìˆ í†µê³„ ê³„ì‚° ë° ì„¸ë¡œ í˜•íƒœë¡œ ë³€í™˜
cluster_summary_long <- dat_cluster_final %>%
  group_by(êµ°ì§‘) %>%
  summarise(
    í•™êµìˆ˜ = n(),
    ì •ì±…ì¸ì§€ë„_í‰ê·  = round(mean(ì •ì±…ì¸ì§€ë„), 2),
    í™ë³´ì¶©ë¶„ì„±_í‰ê·  = round(mean(í™ë³´ì¶©ë¶„ì„±), 2),
    í˜‘ë ¥ì¤‘ìš”ì„±_í‰ê·  = round(mean(í˜‘ë ¥ì¤‘ìš”ì„±), 2),
    í˜‘ë ¥ì‹¤í–‰ë„_í‰ê·  = round(mean(í˜‘ë ¥ì‹¤í–‰ë„), 2),
    íŒ€ìš´ì˜íšŸìˆ˜_í‰ê·  = round(mean(íŒ€ìš´ì˜íšŸìˆ˜), 2),
    ì§€ì›í•™ìƒìˆ˜_í‰ê·  = round(mean(ì§€ì›í•™ìƒìˆ˜), 2),
    .groups = "drop"
  ) %>%
  pivot_longer(cols = -êµ°ì§‘, names_to = "ë³€ìˆ˜", values_to = "ê°’") %>%
  pivot_wider(names_from = êµ°ì§‘, values_from = ê°’) %>%
  mutate(
    ë³€ìˆ˜ = recode(ë³€ìˆ˜,
                 "í•™êµìˆ˜" = "í•™êµìˆ˜",
                 "ì •ì±…ì¸ì§€ë„_í‰ê· " = "ì •ì±…ì¸ì§€ë„ í‰ê· ",
                 "í™ë³´ì¶©ë¶„ì„±_í‰ê· " = "í™ë³´ì¶©ë¶„ì„± í‰ê· ", 
                 "í˜‘ë ¥ì¤‘ìš”ì„±_í‰ê· " = "í˜‘ë ¥ì¤‘ìš”ì„± í‰ê· ",
                 "í˜‘ë ¥ì‹¤í–‰ë„_í‰ê· " = "í˜‘ë ¥ì‹¤í–‰ë„ í‰ê· ",
                 "íŒ€ìš´ì˜íšŸìˆ˜_í‰ê· " = "íŒ€ìš´ì˜íšŸìˆ˜ í‰ê· ",
                 "ì§€ì›í•™ìƒìˆ˜_í‰ê· " = "ì§€ì›í•™ìƒìˆ˜ í‰ê· ")
  )

print("êµ°ì§‘ë³„ íŠ¹ì„± ìš”ì•½:")
print(cluster_summary_long, n = Inf)
```

```{r}
#| echo: false
#| message: false
#| warning: false

# PCA ê¸°ë°˜ êµ°ì§‘ ì‹œê°í™”
fviz_cluster(k3_result, data = cluster_scaled,
             palette = c("#2E8B57", "#FF6B6B", "#4ECDC4"),
             geom = "point",
             ellipse.type = "convex",
             ggtheme = theme_bw()) +
  labs(title = "í•™êµ íŠ¹ì„±ë³„ êµ°ì§‘ë¶„ì„ ê²°ê³¼")
```

ì´ˆë“±í•™êµì˜ ê²½ìš°, 1ê·¸ë£¹ì€ 93êµ(18%), 2ê·¸ë£¹ì€ 230êµ(44.4%), 3ê·¸ë£¹ì€ 195êµ(37.6%)ë¡œ ë‚˜íƒ€ë‚¬ìŒ. ì •ì±…ì¸ì‹ë„ë‚˜ ì·¨ì§€ì— ëŒ€í•œ ì´í•´ë„ëŠ” ë†’ìœ¼ë‚˜ ìƒëŒ€ì ìœ¼ë¡œ í†µí•©ì§€ì›íŒ€ ìš´ì˜ì´ ì›í™œí•˜ì§€ ì•Šì€ í•™êµ ë¹„ì¤‘ì´ ë†’ì€ ê²ƒìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ì¤‘í•™êµì˜ ê²½ìš°, 1ê·¸ë£¹ì€ 65êµ(18.7%), 2ê·¸ë£¹ì€ 130êµ(37.5%), 3ê·¸ë£¹ì€ 152êµ(43.8%)ìœ¼ë¡œ, ì •ì±…ì¸ì‹ë„ë‚˜ ì·¨ì§€ì— ëŒ€í•œ ì´í•´ë„ê°€ ë†’ê³ , í†µí•©ì§€ì›íŒ€ ìš´ì˜ë„ ì›í™œí•œ í•™êµì˜ ë¹„ì¤‘ì´ ê°€ì¥ ë†’ì€ ê²ƒìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

ê³ ë“±í•™êµì˜ ê²½ìš°, 1ê·¸ë£¹ì€ 114êµ(43.2%), 2ê·¸ë£¹ì€ 79êµ(29.9%), 3ê·¸ë£¹ì€ 71êµ(26.9%)ìœ¼ë¡œ, ì •ì±…ì´í•´ë„ë‚˜ ì·¨ì§€ì— ëŒ€í•œ ì´í•´ë„ê°€ ë‚®ê³  í†µí•©ì§€ì›íŒ€ ìš´ì˜ë„ ì›í™œí•˜ì§€ ì•Šì€ í•™êµì˜ ë¹„ì¤‘ì´ ê°€ì¥ ë†’ì€ ê²ƒìœ¼ë¡œ ë‚˜íƒ€ë‚¨

íŠ¹ìˆ˜í•™êµì˜ ê²½ìš°, 1ê·¸ë£¹ì€ 10êµ(58.8%), 2ê·¸ë£¹ì€ 5êµ(29.4%), 3ê·¸ë£¹ì€ 2êµ(11.8%)ë¡œ ì •ì±…ì´í•´ë„ë‚˜ ì·¨ì§€ì— ëŒ€í•œ ì´í•´ë„ê°€ ë‚®ê³  í†µí•©ì§€ì›íŒ€ ìš´ì˜ë„ ì›í™œí•˜ì§€ ì•Šì€ í•™êµì˜ ë¹„ì¤‘ì´ ê°€ì¥ ë†’ì€ ê²ƒìœ¼ë¡œ ë‚˜íƒ€ë‚¨

ê°ì¢…í•™êµì˜ ê²½ìš°, 1ê·¸ë£¹ì€ 2êµ(22.2%), 2ê·¸ë£¹ì€ 6êµ(66.7%), 3ê·¸ë£¹ì€ 1êµ(11.1%)ìœ¼ë¡œ ì •ì±…ì¸ì‹ë„ë‚˜ ì·¨ì§€ì— ëŒ€í•œ ì´í•´ë„ëŠ” ë†’ìœ¼ë‚˜ ìƒëŒ€ì ìœ¼ë¡œ í†µí•©ì§€ì›íŒ€ ìš´ì˜ì´ ì›í™œí•˜ì§€ ì•Šì€ í•™êµ ë¹„ì¤‘ì´ ë†’ì€ ê²ƒìœ¼ë¡œ ë‚˜íƒ€ë‚¬ìŒ

```{r}
#| echo: false
#| message: false
#| warning: false

# í•™êµê¸‰ë³„ êµ°ì§‘ ë¶„í¬ ë°ì´í„° ì¤€ë¹„ (ìˆœì„œ ì§€ì •)
school_cluster <- dat_cluster_final %>%
  count(í•™êµê¸‰, êµ°ì§‘) %>%
  group_by(í•™êµê¸‰) %>%
  mutate(ë¹„ìœ¨ = round(n/sum(n)*100, 1)) %>%
  ungroup() %>%
  mutate(í•™êµê¸‰ = factor(í•™êµê¸‰, 
                     levels = c("ì´ˆë“±í•™êµ", "ì¤‘í•™êµ", "ê³ ë“±í•™êµ", "íŠ¹ìˆ˜í•™êµ", "ê°ì¢…í•™êµ"))) %>%
  arrange(í•™êµê¸‰, êµ°ì§‘)

# í•™êµê¸‰ë³„ í•©ê³„ ì¶”ê°€ëœ ìš”ì•½í‘œ ìƒì„±
school_summary_with_total <- school_cluster %>% 
  select(í•™êµê¸‰, êµ°ì§‘, n, ë¹„ìœ¨) %>%
  # ê° í•™êµê¸‰ë³„ í•©ê³„ ê³„ì‚°
  group_by(í•™êµê¸‰) %>%
  bind_rows(
    school_cluster %>%
      group_by(í•™êµê¸‰) %>%
      summarise(n = sum(n), .groups = "drop") %>%
      mutate(êµ°ì§‘ = "í•©ê³„", ë¹„ìœ¨ = 100.0) %>%
      select(í•™êµê¸‰, êµ°ì§‘, n, ë¹„ìœ¨)
  ) %>%
  ungroup() %>%
  arrange(
    factor(í•™êµê¸‰, levels = c("ì´ˆë“±í•™êµ", "ì¤‘í•™êµ", "ê³ ë“±í•™êµ", "íŠ¹ìˆ˜í•™êµ", "ê°ì¢…í•™êµ")),
    êµ°ì§‘ == "í•©ê³„",  # í•©ê³„ê°€ ë§ˆì§€ë§‰ì— ì˜¤ë„ë¡
    êµ°ì§‘
  ) %>%
  # ì „ì²´ í•©ê³„ë„ ì¶”ê°€
  bind_rows(
    school_cluster %>%
      summarise(n = sum(n)) %>%
      mutate(í•™êµê¸‰ = "ì „ì²´ í•©ê³„", êµ°ì§‘ = "í•©ê³„", ë¹„ìœ¨ = 100.0) %>%
      select(í•™êµê¸‰, êµ°ì§‘, n, ë¹„ìœ¨)
  )

print("í•™êµê¸‰ë³„ êµ°ì§‘ ë¶„í¬ ìš”ì•½ (í•©ê³„ í¬í•¨):")
print(school_summary_with_total, n = Inf)

# facet_wrapì„ ì‚¬ìš©í•œ ì‹œê°í™”
ggplot(school_cluster, aes(x = êµ°ì§‘, y = n, fill = êµ°ì§‘)) +
  geom_col(width = 0.6) +
  geom_text(aes(label = paste0(n, "ê°œêµ (", ë¹„ìœ¨, "%)")), 
            vjust = -0.3, hjust = 0.5,
            size = 4.5, fontface = "bold", color = "black") +
  facet_wrap(~ í•™êµê¸‰, scales = "free_y", ncol = 3) +
  labs(title = "í•™êµê¸‰ë³„ êµ°ì§‘ ë¶„í¬",
       x = "êµ°ì§‘", 
       y = "í•™êµ ìˆ˜",
       fill = "í•™êµ ìœ í˜•") +
  scale_fill_manual(values = c("#2E8B57", "#FF6B6B", "#4ECDC4"),
                    labels = c("1êµ°ì§‘", "2êµ°ì§‘", "3êµ°ì§‘")) +
  scale_x_discrete(labels = c("1êµ°ì§‘", "2êµ°ì§‘", "3êµ°ì§‘")) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.15))) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(size = 32, face = "bold", hjust = 0.5),
    axis.title.y = element_text(size = 16, angle = 0, vjust = 0.5),
    axis.text.x = element_text(size = 18),
    axis.text.y = element_text(size = 18),
    strip.text = element_text(size = 12, face = "bold"),
    legend.position = "bottom"
  )
```







